<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tutorials/Intermediate/URDF/Adding-Physical-and-Collision-Properties-to-a-URDF-Model</title>
</head>
<body>
  <div class="section" id="adding-physical-and-collision-properties">
<span id="urdfproperties"></span><h1>添加物理和碰撞属性<a class="headerlink" href="#adding-physical-and-collision-properties" title="永久链接至标题"></a></h1>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>目标：<a href="#id3"><span class="problematic" id="id4">**</span></a>学习如何为链接添加碰撞和惯性属性，以及如何为关节添加关节动力学。</p>
<p><strong>教程级别：</strong> 中级</p>
<p><strong>时间:</strong> 10分钟</p>
<div class="contents local topic" id="contents">
<p class="topic-title">内容</p>
<ul class="simple">
<li><p><a class="reference internal" href="#collision" id="id1">碰撞</a></p></li>
<li><p><a class="reference internal" href="#physical-properties" id="id2">物理属性</a></p>
<ul>
<li><p><a class="reference internal" href="#inertia" id="id3">惯性</a></p></li>
<li><p><a class="reference internal" href="#contact-coefficients" id="id4">接触系数</a></p></li>
<li><p><a class="reference internal" href="#joint-dynamics" id="id5">关节动力学</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#other-tags" id="id6">其他标签</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id7">下一步</a></p></li>
</ul>
</div>
<p>在本教程中，我们将介绍如何为URDF模型添加一些基本的物理属性，并指定其碰撞属性。</p>
<div class="section" id="collision">
<h2><a class="toc-backref" href="#id1">碰撞</a><a class="headerlink" href="#collision" title="永久链接至标题"></a></h2>
<p>到目前为止，我们只为链接指定了一个子元素“visual”，它定义了机器人的外观。然而，为了使碰撞检测工作或者模拟机器人，我们还需要定义一个“collision”元素。<a class="reference external" href="https://raw.githubusercontent.com/ros/urdf_tutorial/master/urdf/07-physics.urdf">这是带有碰撞和物理属性的新URDF文件</a>。</p>
<p>这是我们新基本链接的代码。</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;link</span> <span class="na">name=</span><span class="s">&quot;base_link&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;visual&gt;</span>
      <span class="nt">&lt;geometry&gt;</span>
        <span class="nt">&lt;cylinder</span> <span class="na">length=</span><span class="s">&quot;0.6&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/geometry&gt;</span>
      <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;blue&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;color</span> <span class="na">rgba=</span><span class="s">&quot;0 0 .8 1&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/material&gt;</span>
    <span class="nt">&lt;/visual&gt;</span>
    <span class="nt">&lt;collision&gt;</span>
      <span class="nt">&lt;geometry&gt;</span>
        <span class="nt">&lt;cylinder</span> <span class="na">length=</span><span class="s">&quot;0.6&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/geometry&gt;</span>
    <span class="nt">&lt;/collision&gt;</span>
  <span class="nt">&lt;/link&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>碰撞元素是链接对象的直接子元素，与视觉标签处于同一级别。</p></li>
<li><p>碰撞元素的形状定义方式与视觉元素相同，都是使用geometry标签。在这里，geometry标签的格式与视觉元素完全相同。</p></li>
<li><p>您还可以像在视觉元素中一样，在碰撞标签的子元素中指定一个起点。</p></li>
</ul>
<p>在许多情况下，您希望碰撞几何体和原点与视觉几何体和原点完全相同。然而，有两种情况下您不会这样做：</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>更快的处理速度</strong>。检测两个网格的碰撞要比检测两个简单几何体复杂得多。因此，您可能希望将网格替换为碰撞元素中的简单几何体。</p></li>
<li><p><strong>安全区域</strong>。您可能希望限制靠近敏感设备的移动。例如，如果我们不希望任何物体与R2D2的头碰撞，我们可以将碰撞几何体定义为一个包围他头部的圆柱体，以防止任何物体靠近他的头部。</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="physical-properties">
<h2><a class="toc-backref" href="#id2">物理属性</a><a class="headerlink" href="#physical-properties" title="永久链接至标题"></a></h2>
<p>为了使您的模型能够正确模拟，您需要定义机器人的几个物理属性，即像Gazebo这样的物理引擎需要的属性。</p>
<div class="section" id="inertia">
<h3><a class="toc-backref" href="#id3">惯性</a><a class="headerlink" href="#inertia" title="永久链接至标题"></a></h3>
<p>每个被模拟的链接元素都需要一个惯性标签。这是一个简单的标签。</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;link</span> <span class="na">name=</span><span class="s">&quot;base_link&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;visual&gt;</span>
    <span class="nt">&lt;geometry&gt;</span>
      <span class="nt">&lt;cylinder</span> <span class="na">length=</span><span class="s">&quot;0.6&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/geometry&gt;</span>
    <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;blue&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;color</span> <span class="na">rgba=</span><span class="s">&quot;0 0 .8 1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/material&gt;</span>
  <span class="nt">&lt;/visual&gt;</span>
  <span class="nt">&lt;collision&gt;</span>
    <span class="nt">&lt;geometry&gt;</span>
      <span class="nt">&lt;cylinder</span> <span class="na">length=</span><span class="s">&quot;0.6&quot;</span> <span class="na">radius=</span><span class="s">&quot;0.2&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/geometry&gt;</span>
  <span class="nt">&lt;/collision&gt;</span>
  <span class="nt">&lt;inertial&gt;</span>
    <span class="nt">&lt;mass</span> <span class="na">value=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;inertia</span> <span class="na">ixx=</span><span class="s">&quot;1e-3&quot;</span> <span class="na">ixy=</span><span class="s">&quot;0.0&quot;</span> <span class="na">ixz=</span><span class="s">&quot;0.0&quot;</span> <span class="na">iyy=</span><span class="s">&quot;1e-3&quot;</span> <span class="na">iyz=</span><span class="s">&quot;0.0&quot;</span> <span class="na">izz=</span><span class="s">&quot;1e-3&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/inertial&gt;</span>
<span class="nt">&lt;/link&gt;</span>
</pre></div>
</div>
<ul>
<li><p>该元素也是链接对象的子元素。</p></li>
<li><p>质量以千克为单位定义。</p></li>
<li><p>3x3旋转惯性矩阵由惯性元素指定。由于它是对称的，只需要用6个元素来表示。</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>ixx</strong></p></td>
<td><p><strong>ixy</strong></p></td>
<td><p><strong>ixz</strong></p></td>
</tr>
<tr class="row-even"><td><p>ixy</p></td>
<td><p><strong>iyy</strong></p></td>
<td><p><strong>iyz</strong></p></td>
</tr>
<tr class="row-odd"><td><p>ixz</p></td>
<td><p>iyz</p></td>
<td><p><strong>izz</strong></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</li>
<li><p>这些信息可以由诸如MeshLab之类的建模程序提供。可以使用维基百科的`惯性矩张量列表&lt;<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_moments_of_inertia#List_of_3D_inertia_tensors">https://en.wikipedia.org/wiki/List_of_moments_of_inertia#List_of_3D_inertia_tensors</a>&gt;`_来计算几何原始体（圆柱体、长方体、球体）的惯性（在上面的示例中使用）。</p></li>
<li><p>惯性张量取决于物体的质量和质量分布。一个很好的第一近似是假设物体的质量在体积上均匀分布，并基于物体的形状计算惯性张量，如上所述。</p></li>
<li><p>如果不确定应该填写什么，一个常见的中等大小连接的合理默认值是ixx/iyy/izz=1e-3或更小（它对应于一边长为0.1米、质量为0.6千克的长方体）。恒等矩阵是一个特别糟糕的选择，因为它通常太大（它对应于一边长为0.1米、质量为600千克的长方体）。</p></li>
<li><p>您还可以指定一个原点标签，以指定重心和惯性参考系（相对于链接的参考系）。</p></li>
<li><p>在使用实时控制器时，惯性元素为零（或几乎为零）可能导致机器人模型突然崩溃，并且所有链接将与世界原点重合。</p></li>
</ul>
</div>
<div class="section" id="contact-coefficients">
<h3><a class="toc-backref" href="#id4">接触系数</a><a class="headerlink" href="#contact-coefficients" title="永久链接至标题"></a></h3>
<p>您还可以定义链接在彼此接触时的行为。这可以通过碰撞标签的子元素contact_coefficients来实现。有三个属性需要指定：</p>
<blockquote>
<div><ul class="simple">
<li><p>mu - <a class="reference external" href="https://simple.wikipedia.org/wiki/Coefficient_of_friction">摩擦系数</a></p></li>
<li><p>kp - <a class="reference external" href="https://en.wikipedia.org/wiki/Stiffness">刚度系数</a></p></li>
<li><p>kd - <a class="reference external" href="https://en.wikipedia.org/wiki/Damping_ratio#Damping_ratio_definition">阻尼系数</a></p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="joint-dynamics">
<h3><a class="toc-backref" href="#id5">关节动力学</a><a class="headerlink" href="#joint-dynamics" title="永久链接至标题"></a></h3>
<p>关节的运动由关节的动力学标签定义。这里有两个属性：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">摩擦</span></code> - 物理静摩擦力。对于平移关节，单位为牛顿；对于旋转关节，单位为牛顿·米。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">阻尼</span></code> - 物理阻尼值。对于平移关节，单位为牛顿秒/米；对于旋转关节，单位为牛顿·米秒/弧度。</p></li>
</ul>
</div></blockquote>
<p>如果未指定，则这些系数默认为零。</p>
</div>
</div>
<div class="section" id="other-tags">
<h2><a class="toc-backref" href="#id6">其他标签</a><a class="headerlink" href="#other-tags" title="永久链接至标题"></a></h2>
<p>在纯URDF领域（即不包括Gazebo特定标签的情况下），还有两个剩余的标签可用于定义关节：校准和安全控制器。请查看`规范 &lt;<a class="reference external" href="https://wiki.ros.org/urdf/XML/joint">https://wiki.ros.org/urdf/XML/joint</a>&gt;`_，因为它们在本教程中没有包含。</p>
</div>
<div class="section" id="next-steps">
<h2><a class="toc-backref" href="#id7">下一步</a><a class="headerlink" href="#next-steps" title="永久链接至标题"></a></h2>
<p>通过 <a class="reference internal" href="Using-Xacro-to-Clean-Up-a-URDF-File.html"><span class="doc">使用xacro</span></a> 减少您需要编写的代码和繁琐的数学计算量。</p>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>