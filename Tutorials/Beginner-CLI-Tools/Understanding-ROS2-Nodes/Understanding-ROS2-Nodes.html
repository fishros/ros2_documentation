<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Nodes/Understanding-ROS2-Nodes</title>
</head>
<body>
  <div class="section" id="understanding-nodes">
<span id="ros2nodes"></span><h1>理解节点<a class="headerlink" href="#understanding-nodes" title="永久链接至标题"></a></h1>
<p><strong>目标:</strong> 了解ROS 2中节点的功能以及与之交互的工具。</p>
<p><strong>教程级别:</strong> 初学者</p>
<p><strong>时间:</strong> 10分钟</p>
<div class="contents local topic" id="contents">
<p class="topic-title">内容</p>
<ul class="simple">
<li><p><a class="reference internal" href="#background" id="id1">背景</a></p>
<ul>
<li><p><a class="reference internal" href="#the-ros-2-graph" id="id2">1 ROS 2图</a></p></li>
<li><p><a class="reference internal" href="#nodes-in-ros-2" id="id3">ROS 2中的两个节点</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#prerequisites" id="id4">先决条件</a></p></li>
<li><p><a class="reference internal" href="#tasks" id="id5">任务</a></p>
<ul>
<li><p><a class="reference internal" href="#ros2-run" id="id6">1 ros2 run</a></p></li>
<li><p><a class="reference internal" href="#ros2-node-list" id="id7">2 <code class="xref any docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">list</span></code></a></p></li>
<li><p><a class="reference internal" href="#ros2-node-info" id="id8">3. ros2节点信息</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id9">总结</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id10">下一步</a></p></li>
<li><p><a class="reference internal" href="#related-content" id="id11">相关内容</a></p></li>
</ul>
</div>
<div class="section" id="background">
<h2><a class="toc-backref" href="#id1">背景</a><a class="headerlink" href="#background" title="永久链接至标题"></a></h2>
<div class="section" id="the-ros-2-graph">
<h3><a class="toc-backref" href="#id2">1 ROS 2图</a><a class="headerlink" href="#the-ros-2-graph" title="永久链接至标题"></a></h3>
<p>在接下来的几个教程中，您将了解一系列组成所谓“ROS (2)图”的核心ROS 2概念。</p>
<p>ROS图是一个由ROS 2元素组成的网络，这些元素同时处理数据。如果您将它们全部映射并可视化，它将包含所有可执行文件和它们之间的连接。</p>
</div>
<div class="section" id="nodes-in-ros-2">
<h3><a class="toc-backref" href="#id3">ROS 2中的两个节点</a><a class="headerlink" href="#nodes-in-ros-2" title="永久链接至标题"></a></h3>
<p>ROS中的每个节点应该负责一个单一的模块化功能，例如控制轮子马达或发布来自激光测距仪的传感器数据。每个节点可以通过主题（topics）、服务（services）、动作（actions）或参数（parameters）与其他节点进行数据的发送和接收。</p>
<img alt="../../../_images/Nodes-TopicandService.gif" src="../../../_images/Nodes-TopicandService.gif" />
<p>一个完整的机器人系统由许多协同工作的节点组成。在ROS 2中，单个可执行文件（C++程序、Python程序等）可以包含一个或多个节点。</p>
</div>
</div>
<div class="section" id="prerequisites">
<h2><a class="toc-backref" href="#id4">先决条件</a><a class="headerlink" href="#prerequisites" title="永久链接至标题"></a></h2>
<p>在 <a class="reference internal" href="../Introducing-Turtlesim/Introducing-Turtlesim.html"><span class="doc">上一篇教程</span></a> 中，你可以了解如何安装这里使用的 <code class="docutils literal notranslate"><span class="pre">turtlesim</span></code> 包。</p>
<p>像往常一样，在 <a class="reference internal" href="../Configuring-ROS2-Environment.html"><span class="doc">每个新开的终端中</span></a> 都不要忘记加载 ROS 2 。</p>
</div>
<div class="section" id="tasks">
<h2><a class="toc-backref" href="#id5">任务</a><a class="headerlink" href="#tasks" title="永久链接至标题"></a></h2>
<div class="section" id="ros2-run">
<h3><a class="toc-backref" href="#id6">1 ros2 run</a><a class="headerlink" href="#ros2-run" title="永久链接至标题"></a></h3>
<p>命令``ros2 run``会从一个软件包中启动一个可执行文件。</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run &lt;package_name&gt; &lt;executable_name&gt;</span>
</pre></div>
</div>
<p>要运行turtlesim，请打开一个新的终端，并输入以下命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run turtlesim turtlesim_node</span>
</pre></div>
</div>
<p>turtlesim窗口将会打开，就像你在:doc:<a href="#id1"><span class="problematic" id="id2">`</span></a>上一个教程&lt;../Introducing-Turtlesim/Introducing-Turtlesim&gt;`中看到的那样。</p>
<p>这里，包名是 <a class="reference internal" href="../Introducing-Turtlesim/Introducing-Turtlesim.html#turtlesim"><span class="std std-ref">使用``turtlesim``、ros2``和``rqt</span></a>，可执行文件名是 <code class="xref any docutils literal notranslate"><span class="pre">turtlesim_node</span></code>。</p>
<p>然而，我们还不知道节点名称。您可以使用 <code class="xref any docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">list</span></code> 命令查找节点名称。</p>
</div>
<div class="section" id="ros2-node-list">
<h3><a class="toc-backref" href="#id7">2 <code class="xref any docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">list</span></code></a><a class="headerlink" href="#ros2-node-list" title="永久链接至标题"></a></h3>
<p><code class="xref any docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">list</span></code> 命令将显示所有正在运行的节点的名称。当您想与节点进行交互或者系统运行多个节点时需要跟踪它们时，这特别有用。</p>
<p>在另一个终端中打开新的终端，同时 turtlesim 仍在运行，请输入以下命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 node list</span>
</pre></div>
</div>
<p>终端将返回节点名称：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/turtlesim</span>
</pre></div>
</div>
<p>再打开一个新的终端，并使用以下命令启动 teleop 节点：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run turtlesim turtle_teleop_key</span>
</pre></div>
</div>
<p>在这里，我们再次引用了“turtlesim”软件包，但这次我们的目标是名为“turtle_teleop_key”的可执行文件。</p>
<p>返回到之前运行``ros2 node list``的终端，再次运行该命令。你将会看到两个活动节点的名称：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/turtlesim</span>
<span class="go">/teleop_turtle</span>
</pre></div>
</div>
<div class="section" id="remapping">
<h4>2.1 重映射<a class="headerlink" href="#remapping" title="永久链接至标题"></a></h4>
<p><a class="reference external" href="https://design.ros2.org/articles/ros_command_line_arguments.html#name-remapping-rules">重映射</a> 允许你重新分配默认节点属性，如节点名称、话题名称、服务名称等，以自定义的值。在上一个教程中，你在``turtle_teleop_key``上使用了重映射来改变``cmd_vel``话题和目标节点为**turtle2**。</p>
<p>现在，让我们重新分配``/turtlesim``节点的名称。在一个新的终端中运行以下命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run turtlesim turtlesim_node --ros-args --remap __node:=my_turtle</span>
</pre></div>
</div>
<p>由于您再次调用``ros2 run``启动了turtlesim，将会打开另一个turtlesim窗口。但是，现在如果您返回到之前运行``ros2 node list``的终端，并再次运行该命令，您将看到三个节点名称：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/my_turtle</span>
<span class="go">/turtlesim</span>
<span class="go">/teleop_turtle</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ros2-node-info">
<h3><a class="toc-backref" href="#id8">3. ros2节点信息</a><a class="headerlink" href="#ros2-node-info" title="永久链接至标题"></a></h3>
<p>既然您知道了节点的名称，您可以使用以下命令访问有关它们的更多信息：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 node info &lt;node_name&gt;</span>
</pre></div>
</div>
<p>要查看您最新的节点``my_turtle``，请运行以下命令：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 node info /my_turtle</span>
</pre></div>
</div>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>ros2 node info``返回订阅者、发布者、服务和动作的列表，即与该节点进行交互的ROS图连接。输出应该如下所示：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">/my_turtle</span>
<span class="go">  Subscribers:</span>
<span class="go">    /parameter_events: rcl_interfaces/msg/ParameterEvent</span>
<span class="go">    /turtle1/cmd_vel: geometry_msgs/msg/Twist</span>
<span class="go">  Publishers:</span>
<span class="go">    /parameter_events: rcl_interfaces/msg/ParameterEvent</span>
<span class="go">    /rosout: rcl_interfaces/msg/Log</span>
<span class="go">    /turtle1/color_sensor: turtlesim/msg/Color</span>
<span class="go">    /turtle1/pose: turtlesim/msg/Pose</span>
<span class="go">  Service Servers:</span>
<span class="go">    /clear: std_srvs/srv/Empty</span>
<span class="go">    /kill: turtlesim/srv/Kill</span>
<span class="go">    /my_turtle/describe_parameters: rcl_interfaces/srv/DescribeParameters</span>
<span class="go">    /my_turtle/get_parameter_types: rcl_interfaces/srv/GetParameterTypes</span>
<span class="go">    /my_turtle/get_parameters: rcl_interfaces/srv/GetParameters</span>
<span class="go">    /my_turtle/list_parameters: rcl_interfaces/srv/ListParameters</span>
<span class="go">    /my_turtle/set_parameters: rcl_interfaces/srv/SetParameters</span>
<span class="go">    /my_turtle/set_parameters_atomically: rcl_interfaces/srv/SetParametersAtomically</span>
<span class="go">    /reset: std_srvs/srv/Empty</span>
<span class="go">    /spawn: turtlesim/srv/Spawn</span>
<span class="go">    /turtle1/set_pen: turtlesim/srv/SetPen</span>
<span class="go">    /turtle1/teleport_absolute: turtlesim/srv/TeleportAbsolute</span>
<span class="go">    /turtle1/teleport_relative: turtlesim/srv/TeleportRelative</span>
<span class="go">  Service Clients:</span>

<span class="go">  Action Servers:</span>
<span class="go">    /turtle1/rotate_absolute: turtlesim/action/RotateAbsolute</span>
<span class="go">  Action Clients:</span>
</pre></div>
</div>
<p>现在尝试在``/teleop_turtle``节点上运行相同的命令，观察它的连接与``my_turtle``有何不同。</p>
<p>在即将进行的教程中，您将更多地了解ROS图连接概念，包括消息类型。</p>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id9">总结</a><a class="headerlink" href="#summary" title="永久链接至标题"></a></h2>
<p>节点是ROS 2中的基本元素，在机器人系统中具有单一的模块化功能。</p>
<p>在本教程中，您利用了``turtlesim``包中创建的节点，通过运行``turtlesim_node``和``turtle_teleop_key``可执行文件。</p>
<p>你学会了如何使用 <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">list</span></code> 命令来发现活动节点的名称，以及使用 <code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">node</span> <span class="pre">info</span></code> 命令来内省单个节点。这些工具对于理解复杂的实际机器人系统中的数据流非常重要。</p>
</div>
<div class="section" id="next-steps">
<h2><a class="toc-backref" href="#id10">下一步</a><a class="headerlink" href="#next-steps" title="永久链接至标题"></a></h2>
<p>现在你已经了解了ROS 2中的节点，可以继续阅读 <a class="reference internal" href="../Understanding-ROS2-Topics/Understanding-ROS2-Topics.html"><span class="doc">topics tutorial</span></a>。主题是连接节点的通信类型之一。</p>
</div>
<div class="section" id="related-content">
<h2><a class="toc-backref" href="#id11">相关内容</a><a class="headerlink" href="#related-content" title="永久链接至标题"></a></h2>
<p>在 <a class="reference internal" href="../../../Concepts.html"><span class="doc">概念</span></a> 页面上，进一步详细介绍了节点的概念。</p>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>