<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tutorials/Beginner-Client-Libraries/Getting-Started-With-Ros2doctor</title>
</head>
<body>
  <div class="section" id="using-ros2doctor-to-identify-issues">
<span id="ros2doctor"></span><h1>使用``ros2doctor``来识别问题 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4615">[4615]</a><a class="headerlink" href="#using-ros2doctor-to-identify-issues" title="永久链接至标题"></a></h1>
<p><strong>目标:</strong> 使用``ros2doctor``工具识别您的ROS 2设置中的问题。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4616">[4616]</a></p>
<p><strong>教程级别:</strong> 初学者 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3951">[3951]</a></p>
<p><strong>时间:</strong> 10分钟 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3663">[3663]</a></p>
<div class="contents local topic" id="contents">
<p class="topic-title">内容 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3277">[3277]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#background" id="id1">背景 [3072]</a></p></li>
<li><p><a class="reference internal" href="#prerequisites" id="id2">先决条件 [3124]</a></p></li>
<li><p><a class="reference internal" href="#tasks" id="id3">任务 [3282]</a></p>
<ul>
<li><p><a class="reference internal" href="#check-your-setup" id="id4">1 检查你的设置 [4621]</a></p></li>
<li><p><a class="reference internal" href="#check-a-system" id="id5">2 检查系统 [4632]</a></p></li>
<li><p><a class="reference internal" href="#get-a-full-report" id="id6">3 获取完整报告 [4643]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#summary" id="id7">总结 [3353]</a></p></li>
<li><p><a class="reference internal" href="#related-content" id="id8">相关内容 [3946]</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id9">下一步 [3797]</a></p></li>
</ul>
</div>
<div class="section" id="background">
<h2>背景 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3072">[3072]</a><a class="headerlink" href="#background" title="永久链接至标题"></a></h2>
<p>当您的ROS 2设置未按预期运行时，您可以使用``ros2doctor``工具检查其设置。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4617">[4617]</a></p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a>ros2doctor``检查ROS 2的所有方面，包括平台、版本、网络、环境、运行系统等，并向您警告可能的错误和问题原因。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4618">[4618]</a></p>
</div>
<div class="section" id="prerequisites">
<h2>先决条件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3124">[3124]</a><a class="headerlink" href="#prerequisites" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ros2doctor``是``ros2cli``包的一部分。只要您安装了``ros2cli``（任何正常安装都应该有），您就可以使用``ros2doctor</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4619">[4619]</a></p>
<p>本教程使用 <a class="reference internal" href="../Beginner-CLI-Tools/Introducing-Turtlesim/Introducing-Turtlesim.html"><span class="doc">turtlesim</span></a> 来演示一些例子。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4620">[4620]</a></p>
</div>
<div class="section" id="tasks">
<h2>任务 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3282">[3282]</a><a class="headerlink" href="#tasks" title="永久链接至标题"></a></h2>
<div class="section" id="check-your-setup">
<h3>1 检查你的设置 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4621">[4621]</a><a class="headerlink" href="#check-your-setup" title="永久链接至标题"></a></h3>
<p>让我们用 <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> 来检查你的整个ROS 2设置。首先，在新终端中source ROS 2，然后输入以下命令： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4622">[4622]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 doctor</span>
</pre></div>
</div>
<p>这将对你的所有设置模块进行检查，并返回警告和错误。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4623">[4623]</a></p>
<p>如果您的ROS 2配置完美无缺，您将看到类似于以下的消息: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4624">[4624]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">All &lt;n&gt; checks passed</span>
</pre></div>
</div>
<p>然而，出现一些警告是很正常的。<a href="#id1"><span class="problematic" id="id2">``</span></a>UserWarning``并不意味着您的配置无法使用；更可能只是指示某些配置不太理想。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4625">[4625]</a></p>
<p>如果您收到一个警告，它会类似于以下的样子: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4626">[4626]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&lt;path&gt;: &lt;line&gt;: UserWarning: &lt;message&gt;</span>
</pre></div>
</div>
<p>例如，如果您使用一个不稳定的ROS 2发行版，<a href="#id1"><span class="problematic" id="id2">``</span></a>ros2doctor``将发现此警告: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4627">[4627]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">UserWarning: Distribution &lt;distro&gt; is not fully supported or tested. To get more consistent features, download a stable version at https://index.ros.org/doc/ros2/Installation/</span>
</pre></div>
</div>
<p>如果``ros2doctor``在您的系统中只发现了警告，您仍将收到``所有 &lt;n&gt; 个检查通过``的消息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4628">[4628]</a></p>
<p>大多数检查被归类为警告而不是错误。大部分情况下，您作为用户需确定``ros2doctor``返回的反馈的重要性。如果它在您的设置中发现了罕见的错误，其标志是``UserWarning: ERROR:<a href="#id1"><span class="problematic" id="id2">``</span></a>，则该检查被视为失败。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4629">[4629]</a></p>
<p>您将看到以下类似的问题反馈列表消息： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4630">[4630]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1/3 checks failed</span>

<span class="go">Failed modules:  network</span>
</pre></div>
</div>
<p>错误指示系统缺少对ROS 2至关重要的设置或功能。应该解决错误以确保系统正常运行。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4631">[4631]</a></p>
</div>
<div class="section" id="check-a-system">
<h3>2 检查系统 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4632">[4632]</a><a class="headerlink" href="#check-a-system" title="永久链接至标题"></a></h3>
<p>您还可以检查正在运行的ROS 2系统，以确定可能导致问题的原因。为了查看``ros2doctor``在正在运行的系统上的工作情况，让我们运行turtlesim，其中的节点正在积极地相互通信。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4633">[4633]</a></p>
<p>通过打开新的终端、设置ROS 2环境变量并输入以下命令来启动系统： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4634">[4634]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run turtlesim turtlesim_node</span>
</pre></div>
</div>
<p>打开另一个终端并设置ROS 2环境变量以运行teleop控制器： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4635">[4635]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 run turtlesim turtle_teleop_key</span>
</pre></div>
</div>
<p>现在在一个新的终端中再次运行 <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code>。如果你在上次运行 <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> 时遇到了警告和错误，你将会看到它们。接下来会有一些与系统本身相关的新警告： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4636">[4636]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">UserWarning: Publisher without subscriber detected on /turtle1/color_sensor.</span>
<span class="go">UserWarning: Publisher without subscriber detected on /turtle1/pose.</span>
</pre></div>
</div>
<p>看起来 <code class="docutils literal notranslate"><span class="pre">/turtlesim</span></code> 节点发布了数据到两个未被订阅的话题上，<code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> 认为这可能会导致问题。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4637">[4637]</a></p>
<p>如果你运行命令来回显 <code class="docutils literal notranslate"><span class="pre">/color_sensor</span></code> 和 <code class="docutils literal notranslate"><span class="pre">/pose</span></code> 话题，这些警告将会消失，因为发布者将会有订阅者。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4638">[4638]</a></p>
<p>你可以尝试在 turtlesim 仍然运行的情况下，在两个新终端中打开，每个终端中都 source ROS 2，并在各自的终端中运行以下命令： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4639">[4639]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 topic echo /turtle1/color_sensor</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 topic echo /turtle1/pose</span>
</pre></div>
</div>
<p>然后再次在其终端中运行``ros2doctor``命令。<code class="docutils literal notranslate"><span class="pre">publisher</span> <span class="pre">without</span> <span class="pre">subscriber``的警告将会消失。（确保在运行``echo``命令的终端中按下``Ctrl+C</span></code>）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4640">[4640]</a></p>
<p>现在尝试退出turtlesim窗口或停止teleop，并再次运行``ros2doctor``命令。你会看到更多警告，指示不同主题的``publisher without subscriber``或``subscriber without publisher``，现在系统中的一个节点不可用。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4641">[4641]</a></p>
<p>在一个包含许多节点的复杂系统中，<a href="#id1"><span class="problematic" id="id2">``</span></a>ros2doctor``对于识别通信问题的可能原因非常有价值。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4642">[4642]</a></p>
</div>
<div class="section" id="get-a-full-report">
<h3>3 获取完整报告 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4643">[4643]</a><a class="headerlink" href="#get-a-full-report" title="永久链接至标题"></a></h3>
<p>虽然``ros2doctor``会提供关于网络、系统等方面的警告，但是使用``--report``参数运行它将提供更详细的信息，帮助您分析问题。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4644">[4644]</a></p>
<p>如果您收到关于网络设置的警告，并想要确切地找出导致警告的配置部分，可以使用``--report``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4645">[4645]</a></p>
<p>当您需要开启一个支持工单以获取ROS 2的帮助时，这也非常有帮助。您可以将报告的相关部分复制粘贴到工单中，以便帮助您的人员更好地了解您的环境并提供更好的支持。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4646">[4646]</a></p>
<p>要获取完整的报告，请在终端中输入以下命令： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4647">[4647]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ros2 doctor --report</span>
</pre></div>
</div>
<p>将返回按五个组进行分类的信息列表： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4648">[4648]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">NETWORK CONFIGURATION</span>
<span class="go">...</span>

<span class="go">PLATFORM INFORMATION</span>
<span class="go">...</span>

<span class="go">RMW MIDDLEWARE</span>
<span class="go">...</span>

<span class="go">ROS 2 INFORMATION</span>
<span class="go">...</span>

<span class="go">TOPIC LIST</span>
<span class="go">...</span>
</pre></div>
</div>
<p>您可以将此处的信息与运行``ros2 doctor``时收到的警告进行交叉检查。例如，如果``ros2 doctor``返回了前面提到的警告，即您的发行版“不完全受支持或经过测试”，您可以查看报告的``ROS 2 INFORMATION``部分： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4649">[4649]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">distribution name      : &lt;distro&gt;</span>
<span class="go">distribution type      : ros2</span>
<span class="go">distribution status    : prerelease</span>
<span class="go">release platforms      : {&#39;&lt;platform&gt;&#39;: [&#39;&lt;version&gt;&#39;]}</span>
</pre></div>
</div>
<p>在这里，您可以看到``distribution status``为``prerelease``，这解释了为什么它不被完全支持。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4650">[4650]</a></p>
</div>
</div>
<div class="section" id="summary">
<h2>总结 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3353">[3353]</a><a class="headerlink" href="#summary" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ros2</span> <span class="pre">doctor``会通知您ROS</span> <span class="pre">2设置和运行系统中的问题。您可以使用</span></code>--report``参数深入了解这些警告背后的信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4651">[4651]</a></p>
<p>请记住，“ros2doctor”不是一个调试工具；它不能帮助您解决代码错误或系统实现方面的问题。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4652">[4652]</a></p>
</div>
<div class="section" id="related-content">
<h2>相关内容 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3946">[3946]</a><a class="headerlink" href="#related-content" title="永久链接至标题"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> 的 README &lt;<a class="reference external" href="https://github.com/ros2/ros2cli/tree/humble/ros2doctor">https://github.com/ros2/ros2cli/tree/humble/ros2doctor</a>&gt; 会告诉您更多关于不同参数的信息。您可能也想在 <code class="docutils literal notranslate"><span class="pre">ros2doctor</span></code> 存储库中查看一下，因为它非常适合初学者，并且是一个开始贡献的绝佳地点。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4653">[4653]</a></p>
</div>
<div class="section" id="next-steps">
<h2>下一步 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3797">[3797]</a><a class="headerlink" href="#next-steps" title="永久链接至标题"></a></h2>
<p>您已经完成了初学者级别的教程！ <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=4654">[4654]</a></p>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>