<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Tutorials/Demos/Content-Filtering-Subscription</title>
</head>
<body>
  <div class="section" id="creating-a-content-filtering-subscription">
<h1>创建内容过滤订阅 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5001">[5001]</a><a class="headerlink" href="#creating-a-content-filtering-subscription" title="永久链接至标题"></a></h1>
<p><strong>目标:</strong> 创建一个内容过滤订阅。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5002">[5002]</a></p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>教程级别：<a href="#id3"><span class="problematic" id="id4">**</span></a>高级 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3068">[3068]</a></p>
<p><strong>时间：</strong> 15分钟 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3507">[3507]</a></p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3070">[]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id2">概述 [5003]</a></p></li>
<li><p><a class="reference internal" href="#rmw-support" id="id3">RMW支持 [5006]</a></p></li>
<li><p><a class="reference internal" href="#installing-the-demo" id="id4">安装演示程序 [5015]</a></p></li>
<li><p><a class="reference internal" href="#temperature-filtering-demo" id="id5">温度过滤演示 [5018]</a></p></li>
<li><p><a class="reference internal" href="#related-content" id="id6">相关内容 [3946]</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h2>概述 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5003">[5003]</a><a class="headerlink" href="#overview" title="永久链接至标题"></a></h2>
<p>ROS 2应用程序通常由主题组成，用于将数据从发布者传输到订阅者。基本上，订阅者接收来自主题发布者的所有已发布数据。但有时，订阅者可能只对发布者发送的数据的子集感兴趣。内容过滤订阅允许只接收应用程序所关注的数据。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5004">[5004]</a></p>
<p>在这个演示中，我们将重点介绍如何创建一个内容过滤订阅以及它们的工作原理。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5005">[5005]</a></p>
</div>
<div class="section" id="rmw-support">
<h2>RMW支持 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5006">[5006]</a><a class="headerlink" href="#rmw-support" title="永久链接至标题"></a></h2>
<p>内容过滤订阅需要RMW实现支持。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5007">[5007]</a></p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">内容过滤订阅支持状态 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5008">[5008]</a></span><a class="headerlink" href="#id1" title="永久链接至表格"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>rmw_fastrtps <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5009">[5009]</a></p></td>
<td><p>支持 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5010">[5010]</a></p></td>
</tr>
<tr class="row-even"><td><p>rmw_connextdds <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5011">[5011]</a></p></td>
<td><p>支持 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5010">[5010]</a></p></td>
</tr>
<tr class="row-odd"><td><p>rmw_cyclonedds <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5012">[5012]</a></p></td>
<td><p>不支持 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5013">[5013]</a></p></td>
</tr>
</tbody>
</table>
<p>目前，所有支持内容过滤订阅的RMW实现都是基于`DDS &lt;<a class="reference external" href="https://www.omg.org/omg-dds-portal/">https://www.omg.org/omg-dds-portal/</a>&gt;`__的。这意味着支持的过滤表达式和参数也依赖于`DDS &lt;<a class="reference external" href="https://www.omg.org/omg-dds-portal/">https://www.omg.org/omg-dds-portal/</a>&gt;`__，您可以参考`DDS规范 &lt;<a class="reference external" href="https://www.omg.org/spec/DDS/1.4/PDF">https://www.omg.org/spec/DDS/1.4/PDF</a>&gt;`__的``附录B - 查询和过滤语法``了解详细信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5014">[5014]</a></p>
</div>
<div class="section" id="installing-the-demo">
<h2>安装演示程序 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5015">[5015]</a><a class="headerlink" href="#installing-the-demo" title="永久链接至标题"></a></h2>
<p>详细了解安装ROS 2的方法，请参阅:doc:<a class="reference internal" href="../../Installation.html"><span class="doc">安装说明</span></a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5016">[5016]</a></p>
<p>如果您已从软件包中安装了ROS 2，请确保已安装``ros-humble-demo-nodes-cpp``。如果您从存档中下载或从源代码构建ROS 2，它已经包含在安装中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5017">[5017]</a></p>
</div>
<div class="section" id="temperature-filtering-demo">
<h2>温度过滤演示 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5018">[5018]</a><a class="headerlink" href="#temperature-filtering-demo" title="永久链接至标题"></a></h2>
<p>该演示展示了如何使用内容过滤订阅仅接收超出可接受温度范围的温度值，以检测紧急情况。内容过滤订阅会过滤掉无趣的温度数据，以避免发出订阅回调。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5019">[5019]</a></p>
<p>内容过滤发布者: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5020">[5020]</a></p>
<p><a class="reference external" href="https://github.com/ros2/demos/blob/humble/demo_nodes_cpp/src/topics/content_filtering_publisher.cpp">https://github.com/ros2/demos/blob/humble/demo_nodes_cpp/src/topics/content_filtering_publisher.cpp</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5021">[5021]</a></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;chrono&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cstdio&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;memory&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;utility&gt;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp_components/register_node_macro.hpp&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/float32.hpp&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;demo_nodes_cpp/visibility_control.h&quot;</span><span class="cp"></span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">std</span><span class="o">::</span><span class="nn">chrono_literals</span><span class="p">;</span><span class="w"></span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">demo_nodes_cpp</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="c1">// The simulated temperature data starts from -100.0 and ends at 150.0 with a step size of 10.0</span>
<span class="k">constexpr</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="n">TEMPERATURE_SETTING</span><span class="w"> </span><span class="p">{</span><span class="mf">-100.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">150.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0f</span><span class="p">};</span><span class="w"></span>

<span class="c1">// Create a ContentFilteringPublisher class that subclasses the generic rclcpp::Node base class.</span>
<span class="c1">// The main function below will instantiate the class as a ROS node.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentFilteringPublisher</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">DEMO_NODES_CPP_PUBLIC</span><span class="w"></span>
<span class="w">  </span><span class="k">explicit</span><span class="w"> </span><span class="n">ContentFilteringPublisher</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="s">&quot;content_filtering_publisher&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a function for when messages are to be sent.</span>
<span class="w">    </span><span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">_IONBF</span><span class="p">,</span><span class="w"> </span><span class="n">BUFSIZ</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">publish_message</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="p">[</span><span class="k">this</span><span class="p">]()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"></span>
<span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">msg_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;</span><span class="p">();</span><span class="w"></span>
<span class="w">        </span><span class="n">msg_</span><span class="o">-&gt;</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temperature_</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">temperature_</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">TEMPERATURE_SETTING</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">temperature_</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">TEMPERATURE_SETTING</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">temperature_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TEMPERATURE_SETTING</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Publishing: &#39;%f&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg_</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Put the message into a queue to be processed by the middleware.</span>
<span class="w">        </span><span class="c1">// This call is non-blocking.</span>
<span class="w">        </span><span class="n">pub_</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">msg_</span><span class="p">));</span><span class="w"></span>
<span class="w">      </span><span class="p">};</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a publisher with a custom Quality of Service profile.</span>
<span class="w">    </span><span class="c1">// Uniform initialization is suggested so it can be trivially changed to</span>
<span class="w">    </span><span class="c1">// rclcpp::KeepAll{} if the user wishes.</span>
<span class="w">    </span><span class="c1">// (rclcpp::KeepLast(7) -&gt; rclcpp::KeepAll() fails to compile)</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">QoS</span><span class="w"> </span><span class="nf">qos</span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">KeepLast</span><span class="p">{</span><span class="mi">7</span><span class="p">});</span><span class="w"></span>
<span class="w">    </span><span class="n">pub_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">qos</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Use a timer to schedule periodic message publishing.</span>
<span class="w">    </span><span class="n">timer_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">create_wall_timer</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">publish_message</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="n">temperature_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TEMPERATURE_SETTING</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;</span><span class="w"> </span><span class="n">msg_</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">pub_</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">TimerBase</span><span class="o">::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">timer_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="p">}</span><span class="w">  </span><span class="c1">// namespace demo_nodes_cpp</span>
</pre></div>
</div>
<p>内容过滤器在订阅端定义，发布者不需要以任何特殊方式进行配置以允许内容过滤。<code class="docutils literal notranslate"><span class="pre">ContentFilteringPublisher</span></code> 节点每秒发布模拟温度数据，从-100.0开始，以10.0的步长逐渐增加，直到达到150.0。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5022">[5022]</a></p>
<p>我们可以通过运行``ros2 run demo_nodes_cpp content_filtering_publisher``可执行文件来运行演示（不要忘记首先源化设置文件）: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5023">[5023]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ros2 run demo_nodes_cpp content_filtering_publisher
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094594</span>.822753479<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-100.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094595</span>.822723857<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-90.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094596</span>.822752996<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-80.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094597</span>.822752475<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-70.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094598</span>.822721485<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-60.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094599</span>.822696188<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-50.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094600</span>.822699217<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-40.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094601</span>.822744113<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-30.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094602</span>.822694805<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-20.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094603</span>.822735805<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-10.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094604</span>.822722094<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;0.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094605</span>.822699960<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;10.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094606</span>.822748946<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;20.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094607</span>.822694017<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;30.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094608</span>.822708798<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;40.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094609</span>.822692417<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;50.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094610</span>.822696426<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;60.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094611</span>.822751913<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;70.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094612</span>.822692231<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;80.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094613</span>.822745549<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;90.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094614</span>.822701982<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;100.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094615</span>.822691465<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;110.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094616</span>.822649070<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;120.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094617</span>.822693616<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;130.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094618</span>.822691832<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;140.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094619</span>.822688452<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;150.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094620</span>.822645327<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-100.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094621</span>.822689219<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-90.000000&#39;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094622</span>.822694292<span class="o">]</span> <span class="o">[</span>content_filtering_publisher<span class="o">]</span>: Publishing: <span class="s1">&#39;-80.000000&#39;</span>
<span class="o">[</span>...<span class="o">]</span>
</pre></div>
</div>
<p>ContentFilteringSubscriber: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5024">[5024]</a></p>
<p><a class="reference external" href="https://github.com/ros2/demos/blob/humble/demo_nodes_cpp/src/topics/content_filtering_subscriber.cpp">https://github.com/ros2/demos/blob/humble/demo_nodes_cpp/src/topics/content_filtering_subscriber.cpp</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5025">[5025]</a></p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp_components/register_node_macro.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rcpputils/join.hpp&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/float32.hpp&quot;</span><span class="cp"></span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;demo_nodes_cpp/visibility_control.h&quot;</span><span class="cp"></span>

<span class="k">namespace</span><span class="w"> </span><span class="nn">demo_nodes_cpp</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="c1">// Emergency temperature data less than -30 or greater than 100</span>
<span class="k">constexpr</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">float</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">EMERGENCY_TEMPERATURE</span><span class="w"> </span><span class="p">{</span><span class="mf">-30.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">100.0f</span><span class="p">};</span><span class="w"></span>

<span class="c1">// Create a ContentFilteringSubscriber class that subclasses the generic rclcpp::Node base class.</span>
<span class="c1">// The main function below will instantiate the class as a ROS node.</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentFilteringSubscriber</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="k">public</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">DEMO_NODES_CPP_PUBLIC</span><span class="w"></span>
<span class="w">  </span><span class="k">explicit</span><span class="w"> </span><span class="n">ContentFilteringSubscriber</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">NodeOptions</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="o">:</span><span class="w"> </span><span class="n">Node</span><span class="p">(</span><span class="s">&quot;content_filtering_subscriber&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">options</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">setvbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">_IONBF</span><span class="p">,</span><span class="w"> </span><span class="n">BUFSIZ</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Create a callback function for when messages are received.</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">callback</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="w">      </span><span class="p">[</span><span class="k">this</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">msg</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"></span>
<span class="w">      </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">EMERGENCY_TEMPERATURE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">EMERGENCY_TEMPERATURE</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="w"></span>
<span class="w">            </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"></span>
<span class="w">            </span><span class="s">&quot;I receive an emergency temperature data: [%f]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;I receive a temperature data: [%f]&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Initialize a subscription with a content filter to receive emergency temperature data that</span>
<span class="w">    </span><span class="c1">// are less than -30 or greater than 100.</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">SubscriptionOptions</span><span class="w"> </span><span class="n">sub_options</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">sub_options</span><span class="p">.</span><span class="n">content_filter_options</span><span class="p">.</span><span class="n">filter_expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;data &lt; %0 OR data &gt; %1&quot;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">sub_options</span><span class="p">.</span><span class="n">content_filter_options</span><span class="p">.</span><span class="n">expression_parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">EMERGENCY_TEMPERATURE</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="w"></span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">EMERGENCY_TEMPERATURE</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="n">sub_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">create_subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;temperature&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">callback</span><span class="p">,</span><span class="w"> </span><span class="n">sub_options</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">sub_</span><span class="o">-&gt;</span><span class="n">is_cft_enabled</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">RCLCPP_WARN</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Content filter is not enabled since it&#39;s not supported&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;subscribed to topic </span><span class="se">\&quot;</span><span class="s">%s</span><span class="se">\&quot;</span><span class="s"> with content filter options </span><span class="se">\&quot;</span><span class="s">%s, {%s}</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">sub_</span><span class="o">-&gt;</span><span class="n">get_topic_name</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="n">sub_options</span><span class="p">.</span><span class="n">content_filter_options</span><span class="p">.</span><span class="n">filter_expression</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span><span class="w"></span>
<span class="w">        </span><span class="n">rcpputils</span><span class="o">::</span><span class="n">join</span><span class="p">(</span><span class="n">sub_options</span><span class="p">.</span><span class="n">content_filter_options</span><span class="p">.</span><span class="n">expression_parameters</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="p">).</span><span class="n">c_str</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="k">private</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Subscription</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">Float32</span><span class="o">&gt;::</span><span class="n">SharedPtr</span><span class="w"> </span><span class="n">sub_</span><span class="p">;</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>

<span class="p">}</span><span class="w">  </span><span class="c1">// namespace demo_nodes_cpp</span>
</pre></div>
</div>
<p>为了启用内容过滤，应用程序可以在``SubscriptionOptions``中设置过滤表达式和表达式参数。应用程序还可以检查订阅中是否启用了内容过滤。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5026">[5026]</a></p>
<p>在这个演示中，<a href="#id1"><span class="problematic" id="id2">``</span></a>ContentFilteringSubscriber``节点创建了一个内容过滤订阅，只有当温度值小于-30.0或大于100.0时才接收消息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5027">[5027]</a></p>
<p>如前所述，内容过滤订阅的支持取决于RMW实现。应用程序可以使用``is_cft_enabled``方法来检查订阅是否实际上启用了内容过滤。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5028">[5028]</a></p>
<p>为了测试内容过滤订阅，让我们运行它： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5029">[5029]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ros2 run demo_nodes_cpp content_filtering_subscriber
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094590</span>.682660703<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: subscribed to topic <span class="s2">&quot;/temperature&quot;</span> with content filter options <span class="s2">&quot;data &lt; %0 OR data &gt; %1, {-30.000000, 100.000000}&quot;</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094594</span>.823805294<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-100.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094595</span>.823419993<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-90.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094596</span>.823410859<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-80.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094597</span>.823350377<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-70.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094598</span>.823282657<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-60.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094599</span>.823297857<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-50.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094600</span>.823355597<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-40.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094615</span>.823315377<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span><span class="m">110</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094616</span>.823258458<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span><span class="m">120</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094617</span>.823323525<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span><span class="m">130</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094618</span>.823315527<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span><span class="m">140</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094619</span>.823331424<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span><span class="m">150</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094620</span>.823271748<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-100.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094621</span>.823343550<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-90.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094622</span>.823286326<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-80.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094623</span>.823371031<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-70.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094624</span>.823333112<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-60.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094625</span>.823266469<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-50.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651094626</span>.823284093<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-40.000000<span class="o">]</span>
</pre></div>
</div>
<p>如果温度值小于-30.0或大于100.0，你应该会看到显示所使用的内容过滤选项和每个接收到的消息的日志。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5030">[5030]</a></p>
<p>如果RMW实现不支持内容过滤，订阅仍然会被创建，但不会启用内容过滤。我们可以通过执行``RMW_IMPLEMENTATION=rmw_cyclonedds_cpp ros2 run demo_nodes_cpp content_filtering_publisher``来尝试这一点。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5031">[5031]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nv">RMW_IMPLEMENTATION</span><span class="o">=</span>rmw_cyclonedds_cpp ros2 run demo_nodes_cpp content_filtering_subscriber
<span class="o">[</span>WARN<span class="o">]</span> <span class="o">[</span><span class="m">1651096637</span>.893842072<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: Content filter is not enabled since it is not supported
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096641</span>.246043703<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-100.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096642</span>.245833527<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-90.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096643</span>.245743471<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-80.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096644</span>.245833932<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-70.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096645</span>.245916679<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-60.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096646</span>.245861895<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-50.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096647</span>.245946352<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive an emergency temperature data: <span class="o">[</span>-40.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096648</span>.245934569<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span>-30.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096649</span>.245877906<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span>-20.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096650</span>.245939068<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span>-10.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096651</span>.245911450<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">0</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096652</span>.245879830<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">10</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096653</span>.245858329<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">20</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096654</span>.245916370<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">30</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096655</span>.245933741<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">40</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096656</span>.245833975<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">50</span>.000000<span class="o">]</span>
<span class="o">[</span>INFO<span class="o">]</span> <span class="o">[</span><span class="m">1651096657</span>.245971483<span class="o">]</span> <span class="o">[</span>content_filtering_subscriber<span class="o">]</span>: I receive a temperature data: <span class="o">[</span><span class="m">60</span>.000000<span class="o">]</span>
</pre></div>
</div>
<p>您可以看到消息``Content filter is not enabled``，这是因为底层RMW实现不支持该功能，但演示仍然成功创建了正常的订阅以接收所有温度数据。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5032">[5032]</a></p>
</div>
<div class="section" id="related-content">
<h2>相关内容 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=3946">[3946]</a><a class="headerlink" href="#related-content" title="永久链接至标题"></a></h2>
<ul class="simple">
<li><p><a href="#id1"><span class="problematic" id="id2">``</span></a>content filtering examples &lt;<a class="reference external" href="https://github.com/ros2/examples/blob/humble/rclcpp/topics/minimal_subscriber/content_filtering.cpp">https://github.com/ros2/examples/blob/humble/rclcpp/topics/minimal_subscriber/content_filtering.cpp</a>&gt;``__涵盖了所有内容过滤订阅的接口。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5033">[5033]</a></p></li>
<li><p><a href="#id1"><span class="problematic" id="id2">``</span></a>content filtering design PR &lt;<a class="reference external" href="https://github.com/ros2/design/pull/282">https://github.com/ros2/design/pull/282</a>&gt;``__ <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=5034">[5034]</a></p></li>
</ul>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>