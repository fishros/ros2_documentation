<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>How-To-Guides/Node-arguments</title>
</head>
<body>
  <div class="section" id="passing-ros-arguments-to-nodes-via-the-command-line">
<h1>通过命令行向节点传递ROS参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=603">[603]</a><a class="headerlink" href="#passing-ros-arguments-to-nodes-via-the-command-line" title="永久链接至标题"></a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=7">[]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#name-remapping" id="id1">名称重映射 [606]</a></p></li>
<li><p><a class="reference internal" href="#logger-configuration" id="id2">日志记录器配置 [614]</a></p></li>
<li><p><a class="reference internal" href="#parameters" id="id3">参数 [616]</a></p></li>
</ul>
</div>
<p>所有ROS节点都接受一组参数，允许重新配置各种属性。例如，配置节点的名称/命名空间、使用的话题/服务名称和节点上的参数。所有ROS特定的参数都必须在``--ros-args``标志之后指定： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=604">[604]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run my_package node_executable --ros-args ...
</pre></div>
</div>
<p>更多详细信息，请参阅`这个设计文档 &lt;<a class="reference external" href="https://design.ros2.org/articles/ros_command_line_arguments.html">https://design.ros2.org/articles/ros_command_line_arguments.html</a>&gt;`__。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=605">[605]</a></p>
<div class="section" id="name-remapping">
<h2>名称重映射 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=606">[606]</a><a class="headerlink" href="#name-remapping" title="永久链接至标题"></a></h2>
<p>可以使用语法``-r &lt;旧名称&gt;:=&lt;新名称&gt;``对节点内的名称（例如：topics/services）进行重映射。节点本身的名称/命名空间可以使用``-r __node:=&lt;新节点名称&gt;``和``-r __ns:=&lt;新节点命名空间&gt;``进行重映射。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=607">[607]</a></p>
<p>请注意，这些重映射是&quot;静态&quot;重映射，即它们在节点的生命周期内生效。目前尚不支持在节点启动后动态重映射名称。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=608">[608]</a></p>
<p>请参考 <a class="reference external" href="https://design.ros2.org/articles/static_remapping.html">此设计文档</a>，了解有关重新映射参数的详细信息（并非所有功能都可用） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=609">[609]</a></p>
<div class="section" id="example">
<h3>示例 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=506">[506]</a><a class="headerlink" href="#example" title="永久链接至标题"></a></h3>
<p>以下调用将使``talker``节点以节点名称``my_talker``启动，发布到名为``my_topic``的主题，而不是默认的``chatter``。命名空间必须以正斜杠开头，设置为``/demo``，这意味着主题在该命名空间中创建（<code class="docutils literal notranslate"><span class="pre">/demo/my_topic</span></code>），而不是全局（<code class="docutils literal notranslate"><span class="pre">/my_topic</span></code>） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=610">[610]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run demo_nodes_cpp talker --ros-args -r __ns:<span class="o">=</span>/demo -r __node:<span class="o">=</span>my_talker -r chatter:<span class="o">=</span>my_topic
</pre></div>
</div>
<div class="section" id="passing-remapping-arguments-to-specific-nodes">
<h4>向特定节点传递重新映射参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=611">[611]</a><a class="headerlink" href="#passing-remapping-arguments-to-specific-nodes" title="永久链接至标题"></a></h4>
<p>如果在单个进程中运行多个节点（例如使用：doc：<a class="reference internal" href="../Concepts/About-Composition.html"><span class="doc">Composition</span></a>），可以使用节点名称作为前缀将重新映射参数传递给特定节点。例如，以下内容将重新映射参数传递给指定的节点： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=612">[612]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run composition manual_composition --ros-args -r talker:__node:<span class="o">=</span>my_talker -r listener:__node:<span class="o">=</span>my_listener
</pre></div>
</div>
<p>下面的示例将同时更改节点名称和重新映射一个主题（节点和命名空间的更改总是在主题重新映射之前应用）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=613">[613]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run composition manual_composition --ros-args -r talker:__node:<span class="o">=</span>my_talker -r my_talker:chatter:<span class="o">=</span>my_topic -r listener:__node:<span class="o">=</span>my_listener -r my_listener:chatter:<span class="o">=</span>my_topic
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="logger-configuration">
<h2>日志记录器配置 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=614">[614]</a><a class="headerlink" href="#logger-configuration" title="永久链接至标题"></a></h2>
<p>请参阅 <a class="reference internal" href="../Tutorials/Demos/Logging-and-logger-configuration.html"><span class="doc">日志记录页面中的--log-level参数用法</span></a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=615">[615]</a></p>
</div>
<div class="section" id="parameters">
<h2>参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=616">[616]</a><a class="headerlink" href="#parameters" title="永久链接至标题"></a></h2>
<div class="section" id="setting-parameters-directly-from-the-command-line">
<span id="nodeargsparameters"></span><h3>直接从命令行设置参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=617">[617]</a><a class="headerlink" href="#setting-parameters-directly-from-the-command-line" title="永久链接至标题"></a></h3>
<p>您可以使用以下语法直接从命令行设置参数: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=618">[618]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run package_name executable_name --ros-args -p param_name:<span class="o">=</span>param_value
</pre></div>
</div>
<p>例如，您可以运行: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=619">[619]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run demo_nodes_cpp parameter_blackboard --ros-args -p some_int:<span class="o">=</span><span class="m">42</span> -p <span class="s2">&quot;a_string:=Hello world&quot;</span> -p <span class="s2">&quot;some_lists.some_integers:=[1, 2, 3, 4]&quot;</span> -p <span class="s2">&quot;some_lists.some_doubles:=[3.14, 2.718]&quot;</span>
</pre></div>
</div>
<p>其他节点将能够检索参数值，例如: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=620">[620]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ros2 param list parameter_blackboard
a_string
qos_overrides./parameter_events.publisher.depth
qos_overrides./parameter_events.publisher.durability
qos_overrides./parameter_events.publisher.history
qos_overrides./parameter_events.publisher.reliability
some_int
some_lists.some_doubles
some_lists.some_integers
use_sim_time
</pre></div>
</div>
</div>
<div class="section" id="setting-parameters-from-yaml-files">
<h3>从YAML文件中设置参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=621">[621]</a><a class="headerlink" href="#setting-parameters-from-yaml-files" title="永久链接至标题"></a></h3>
<p>参数可以以yaml文件的形式通过命令行设置。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=622">[622]</a></p>
<p>有关yaml文件语法的示例，请参阅此处 &lt;<a class="reference external" href="https://github.com/ros2/rcl/tree/humble/rcl_yaml_param_parser">https://github.com/ros2/rcl/tree/humble/rcl_yaml_param_parser</a>&gt;。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=623">[623]</a></p>
<p>例如，将以下内容保存为 <code class="docutils literal notranslate"><span class="pre">demo_params.yaml</span></code> 文件： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=624">[624]</a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">parameter_blackboard</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">ros__parameters</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nt">some_int</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span><span class="w"></span>
<span class="w">        </span><span class="nt">a_string</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Hello</span><span class="nv"> </span><span class="s">world&quot;</span><span class="w"></span>
<span class="w">        </span><span class="nt">some_lists</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="nt">some_integers</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">]</span><span class="w"></span>
<span class="w">            </span><span class="nt">some_doubles </span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3.14</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2.718</span><span class="p p-Indicator">]</span><span class="w"></span>
</pre></div>
</div>
<p>然后，您可以在节点内使用 <code class="docutils literal notranslate"><span class="pre">declare_parameter</span></code> 或 <a href="#id1"><span class="problematic" id="id2">``</span></a>declare_parameters``（请参阅 <a class="reference external" href="https://docs.ros2.org/foxy/api/rclcpp/classrclcpp_1_1Node.html#a095ea977b26e7464d9371efea5f36c42">文档</a> 了解函数签名）声明参数，或者如果通过命令行覆盖传递了参数，则可以 <a class="reference external" href="https://docs.ros2.org/foxy/api/rclcpp/classrclcpp_1_1NodeOptions.html#a094ceb7af7c9b358ec007a4b8e14d40d">设置节点自动声明参数</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=625">[625]</a></p>
<p>然后运行以下命令： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=626">[626]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run demo_nodes_cpp parameter_blackboard --ros-args --params-file demo_params.yaml
</pre></div>
</div>
<p>其他节点将能够检索参数值，例如: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=620">[620]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ros2 param list parameter_blackboard
a_string
qos_overrides./parameter_events.publisher.depth
qos_overrides./parameter_events.publisher.durability
qos_overrides./parameter_events.publisher.history
qos_overrides./parameter_events.publisher.reliability
some_int
some_lists.some_doubles
some_lists.some_integers
use_sim_time
</pre></div>
</div>
</div>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>