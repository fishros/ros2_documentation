<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>How-To-Guides/Setup-ROS-2-with-VSCode-and-Docker-Container</title>
</head>
<body>
  <div class="section" id="setup-ros-2-with-vscode-and-docker-community-contributed">
<h1>使用VSCode和Docker设置ROS 2 [社区贡献] <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=959">[959]</a><a class="headerlink" href="#setup-ros-2-with-vscode-and-docker-community-contributed" title="永久链接至标题"></a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title">内容 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=362">[362]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#install-vs-code-and-docker" id="id1">安装VS Code和Docker [960]</a></p>
<ul>
<li><p><a class="reference internal" href="#install-docker" id="id2">安装Docker [962]</a></p></li>
<li><p><a class="reference internal" href="#install-vs-code" id="id3">安装 VS Code [966]</a></p></li>
<li><p><a class="reference internal" href="#install-remote-development-extension" id="id4">安装远程开发扩展 [969]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configure-workspace-in-docker-and-vs-code" id="id5">配置Docker和VS Code工作区 [971]</a></p>
<ul>
<li><p><a class="reference internal" href="#add-your-ros-2-workspace" id="id6">添加你的ROS 2工作区 [972]</a></p></li>
<li><p><a class="reference internal" href="#edit-devcontainer-json-for-your-environment" id="id7">根据您的环境编辑 devcontainer.json [976]</a></p></li>
<li><p><a class="reference internal" href="#edit-dockerfile" id="id8">编辑 Dockerfile [979]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#open-and-build-development-container" id="id9">打开并构建开发容器 [982]</a></p>
<ul>
<li><p><a class="reference internal" href="#test-container" id="id10">测试容器 [984]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="install-vs-code-and-docker">
<h2>安装VS Code和Docker <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=960">[960]</a><a class="headerlink" href="#install-vs-code-and-docker" title="永久链接至标题"></a></h2>
<p>使用Visual Studio Code和Docker容器，您可以在无需更改操作系统或使用虚拟机的情况下运行您喜爱的ROS 2发行版。通过本教程，您可以设置一个Docker容器，用于您未来的ROS 2项目。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=961">[961]</a></p>
<div class="section" id="install-docker">
<h3>安装Docker <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=962">[962]</a><a class="headerlink" href="#install-docker" title="永久链接至标题"></a></h3>
<p>要安装Docker并设置正确的用户权限，请使用以下命令。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=963">[963]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt install docker.io git python3-pip</span>
<span class="go">pip3 install vcstool</span>
<span class="go">echo export PATH=$HOME/.local/bin:$PATH &gt;&gt; ~/.bashrc</span>
<span class="go">source ~/.bashrc</span>
<span class="go">sudo groupadd docker</span>
<span class="go">sudo usermod -aG docker $USER</span>
<span class="go">newgrp docker</span>
</pre></div>
</div>
<p>现在，您可以通过运行以下命令来检查安装是否成功： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=964">[964]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">docker run hello-world</span>
</pre></div>
</div>
<p>如果您无法直接运行 hello-world，请先启动 Docker 守护进程： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=965">[965]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo systemctl start docker</span>
</pre></div>
</div>
</div>
<div class="section" id="install-vs-code">
<h3>安装 VS Code <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=966">[966]</a><a class="headerlink" href="#install-vs-code" title="永久链接至标题"></a></h3>
<p>请使用以下命令安装 VS Code： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=967">[967]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt update</span>
<span class="go">sudo apt install software-properties-common apt-transport-https wget -y</span>
<span class="go">wget -q https://packages.microsoft.com/keys/microsoft.asc -O- | sudo apt-key add -</span>
<span class="go">sudo add-apt-repository &quot;deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable main&quot;</span>
<span class="go">sudo apt install code</span>
</pre></div>
</div>
<p>您可以在终端中输入“code”来运行 VS Code。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=968">[968]</a></p>
</div>
<div class="section" id="install-remote-development-extension">
<h3>安装远程开发扩展 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=969">[969]</a><a class="headerlink" href="#install-remote-development-extension" title="永久链接至标题"></a></h3>
<p>在VS Code中搜索扩展（CTRL+SHIFT+X），找到“远程开发”扩展并安装它。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=970">[970]</a></p>
</div>
</div>
<div class="section" id="configure-workspace-in-docker-and-vs-code">
<h2>配置Docker和VS Code工作区 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=971">[971]</a><a class="headerlink" href="#configure-workspace-in-docker-and-vs-code" title="永久链接至标题"></a></h2>
<div class="section" id="add-your-ros-2-workspace">
<h3>添加你的ROS 2工作区 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=972">[972]</a><a class="headerlink" href="#add-your-ros-2-workspace" title="永久链接至标题"></a></h3>
<p>添加一个工作空间以便在容器中构建和打开它们，例如： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=973">[973]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd ~/</span>
<span class="go">mkdir ws_[project]</span>
<span class="go">cd ws_[project]</span>
<span class="go">mkdir src</span>
</pre></div>
</div>
<p>现在在工作空间的根目录下创建一个 .devcontainer 文件夹，并在该文件夹中添加 devcontainer.json 和 Dockerfile。此外，您需要创建一个缓存文件夹，用于缓存不同的 ROS 2 发行版的构建和安装文件夹。工作空间的结构应该如下所示： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=974">[974]</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ws_[project]
├── cache
|   ├── [ROS2_DISTRO]
|   |   ├── build
|   |   ├── install
|   |   └── log
|   └── ...
|
├── src
    ├── .devcontainer
    │   ├── devcontainer.json
    │   └── Dockerfile
    ├── package1
    └── package2
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">文件-&gt;打开文件夹...</span></code> 或 <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span> <span class="pre">Ctrl+O</span></code>，在 VS Code 中打开您的工作空间的 <code class="docutils literal notranslate"><span class="pre">src</span></code> 文件夹。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=975">[975]</a></p>
</div>
<div class="section" id="edit-devcontainer-json-for-your-environment">
<h3>根据您的环境编辑 devcontainer.json <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=976">[976]</a><a class="headerlink" href="#edit-devcontainer-json-for-your-environment" title="永久链接至标题"></a></h3>
<p>为了使开发容器正常运行，我们必须使用正确的用户构建它。因此，请在 <code class="docutils literal notranslate"><span class="pre">.devcontainer/devcontainer.json</span></code> 中添加以下内容： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=977">[977]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ROS 2 Development Container&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;privileged&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;remoteUser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;dockerfile&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dockerfile&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;args&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;USERNAME&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;workspaceFolder&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/home/ws&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;workspaceMount&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;source=${localWorkspaceFolder},target=/home/ws/src,type=bind&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;customizations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;vscode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;extensions&quot;</span><span class="p">:[</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;ms-vscode.cpptools&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;ms-vscode.cpptools-themes&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;twxs.cmake&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;donjayamanne.python-extension-pack&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;eamodio.gitlens&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;ms-iot.vscode-ros&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;containerEnv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;DISPLAY&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;unix:0&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;ROS_LOCALHOST_ONLY&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;ROS_DOMAIN_ID&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;42&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;runArgs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;--net=host&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;-e&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DISPLAY=${env:DISPLAY}&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;mounts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">       </span><span class="s2">&quot;source=/tmp/.X11-unix,target=/tmp/.X11-unix,type=bind,consistency=cached&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;source=/dev/dri,target=/dev/dri,type=bind,consistency=cached&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;source=${localWorkspaceFolder}/../cache/ROS_DISTRO/build,target=/home/ws/build,type=bind&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;source=${localWorkspaceFolder}/../cache/ROS_DISTRO/install,target=/home/ws/install,type=bind&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;source=${localWorkspaceFolder}/../cache/ROS_DISTRO/log,target=/home/ws/log,type=bind&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;postCreateCommand&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sudo rosdep update &amp;&amp; sudo rosdep install --from-paths src --ignore-src -y &amp;&amp; sudo chown -R USERNAME /home/ws/&quot;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">Ctrl+F</span></code> 打开搜索和替换菜单。搜索 <code class="docutils literal notranslate"><span class="pre">USERNAME</span></code> 并用您的 <code class="docutils literal notranslate"><span class="pre">Linux</span> <span class="pre">用户名</span></code> 进行替换。如果您不知道您的用户名，可以在终端中运行 <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$USERNAME</span></code> 来找到它。同时用您想要使用并且已经添加到缓存中的 ROS 2 发行版替换 <code class="docutils literal notranslate"><span class="pre">ROS_DISTRO</span></code>，例如 &quot;humble&quot; 或 &quot;foxy&quot;。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=978">[978]</a></p>
</div>
<div class="section" id="edit-dockerfile">
<h3>编辑 Dockerfile <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=979">[979]</a><a class="headerlink" href="#edit-dockerfile" title="永久链接至标题"></a></h3>
<p>打开 Dockerfile 并添加以下内容： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=980">[980]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>FROM ros:ROS_DISTRO
ARG <span class="nv">USERNAME</span><span class="o">=</span>USERNAME
ARG <span class="nv">USER_UID</span><span class="o">=</span><span class="m">1000</span>
ARG <span class="nv">USER_GID</span><span class="o">=</span><span class="nv">$USER_UID</span>

<span class="c1"># Create the user</span>
RUN groupadd --gid <span class="nv">$USER_GID</span> <span class="nv">$USERNAME</span> <span class="se">\</span>
    <span class="o">&amp;&amp;</span> useradd --uid <span class="nv">$USER_UID</span> --gid <span class="nv">$USER_GID</span> -m <span class="nv">$USERNAME</span> <span class="se">\</span>
    <span class="c1">#</span>
    <span class="c1"># [Optional] Add sudo support. Omit if you don&#39;t need to install software after connecting.</span>
    <span class="o">&amp;&amp;</span> apt-get update <span class="se">\</span>
    <span class="o">&amp;&amp;</span> apt-get install -y sudo <span class="se">\</span>
    <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="nv">$USERNAME</span> <span class="nv">ALL</span><span class="o">=</span><span class="se">\(</span>root<span class="se">\)</span> NOPASSWD:ALL &gt; /etc/sudoers.d/<span class="nv">$USERNAME</span> <span class="se">\</span>
    <span class="o">&amp;&amp;</span> chmod <span class="m">0440</span> /etc/sudoers.d/<span class="nv">$USERNAME</span>
RUN apt-get update <span class="o">&amp;&amp;</span> apt-get upgrade -y
RUN apt-get install -y python3-pip
ENV SHELL /bin/bash

<span class="c1"># ********************************************************</span>
<span class="c1"># * Anything else you want to do like clean up goes here *</span>
<span class="c1"># ********************************************************</span>

<span class="c1"># [Optional] Set the default user. Omit if you want to keep the default as root.</span>
USER <span class="nv">$USERNAME</span>
CMD <span class="o">[</span><span class="s2">&quot;/bin/bash&quot;</span><span class="o">]</span>
</pre></div>
</div>
<p>在此处搜索``USERNAME``并用您的``Linux用户名``替换，将``ROS_DISTRO``替换为您希望使用的ROS 2发行版，并将其添加到之前的缓存中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=981">[981]</a></p>
</div>
</div>
<div class="section" id="open-and-build-development-container">
<h2>打开并构建开发容器 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=982">[982]</a><a class="headerlink" href="#open-and-build-development-container" title="永久链接至标题"></a></h2>
<p>使用``View-&gt;Command Palette...``或``Ctrl+Shift+P``打开命令面板。搜索命令``Dev Containers: (Re-)build and Reopen in Container``并执行它。这将为您构建开发 Docker 容器。这需要一些时间，请坐下或去喝杯咖啡。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=983">[983]</a></p>
<div class="section" id="test-container">
<h3>测试容器 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=984">[984]</a><a class="headerlink" href="#test-container" title="永久链接至标题"></a></h3>
<p>为了测试是否一切正常工作，请在容器中打开一个终端，使用 <code class="docutils literal notranslate"><span class="pre">查看-&gt;终端</span></code> 或者在VS Code中使用 <code class="docutils literal notranslate"><span class="pre">Ctrl+Shift+`</span> <span class="pre">``</span> <span class="pre">并选择</span> <span class="pre">``新终端</span></code>。在终端内执行以下操作： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=985">[985]</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt install ros-$ROS_DISTRO-rviz2 -y</span>
<span class="go">source /opt/ros/$ROS_DISTRO/setup.bash</span>
<span class="go">rviz2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>可能存在显示RVIZ的问题。如果没有弹出窗口，请检查 <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">$DISPLAY</span></code> 的值——如果输出为1，您可以通过 <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;export</span> <span class="pre">DISPLAY=unix:1&quot;</span> <span class="pre">&gt;&gt;</span> <span class="pre">/etc/bash.bashrc</span></code> 来解决此问题，然后再次进行测试。您还可以在 devcontainer.json 中更改 DISPLAY 的值并重新构建。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=986">[986]</a></p>
</div>
</div>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>