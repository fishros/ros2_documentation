<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>How-To-Guides/RQt-Port-Plugin-Windows</title>
</head>
<body>
  <div class="section" id="porting-rqt-plugins-to-windows">
<h1>将RQt插件移植到Windows<a class="headerlink" href="#porting-rqt-plugins-to-windows" title="永久链接至标题"></a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录</p>
<ul class="simple">
<li><p><a class="reference internal" href="#rqt-porting-examples" id="id1">RQt移植示例</a></p></li>
<li><p><a class="reference internal" href="#considerations-for-windows-10" id="id2">Windows 10 的注意事项</a></p>
<ul>
<li><p><a class="reference internal" href="#troubles-with-tinyxml-version-1" id="id3">TinyXML 版本 1 的问题</a></p></li>
<li><p><a class="reference internal" href="#code-that-uses-cplusplus-and-code-that-requires-pluginlib" id="id4">使用``__cplusplus``的代码和需要pluginlib的代码</a></p></li>
<li><p><a class="reference internal" href="#locations-of-build-artifacts-before-install" id="id5">构建产物的位置（安装前）</a></p></li>
<li><p><a class="reference internal" href="#compiler-and-linker-flags" id="id6">编译器和链接器标志</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="rqt-porting-examples">
<h2><a class="toc-backref" href="#id1">RQt移植示例</a><a class="headerlink" href="#rqt-porting-examples" title="永久链接至标题"></a></h2>
<p>这里是`qt_gui_core &lt;<a class="reference external" href="https://github.com/ros-visualization/qt_gui_core/commit/6fb9624033a849f56d1bc1aad0e40d252bf99c2b">https://github.com/ros-visualization/qt_gui_core/commit/6fb9624033a849f56d1bc1aad0e40d252bf99c2b</a>&gt;`_的ROS 2移植版本。</p>
<p>这里是`python_qt_binding &lt;<a class="reference external" href="https://github.com/ros-visualization/python_qt_binding/pull/56">https://github.com/ros-visualization/python_qt_binding/pull/56</a>&gt;`__的ROS 2移植版本。</p>
</div>
<div class="section" id="considerations-for-windows-10">
<h2><a class="toc-backref" href="#id2">Windows 10 的注意事项</a><a class="headerlink" href="#considerations-for-windows-10" title="永久链接至标题"></a></h2>
<div class="section" id="troubles-with-tinyxml-version-1">
<h3><a class="toc-backref" href="#id3">TinyXML 版本 1 的问题</a><a class="headerlink" href="#troubles-with-tinyxml-version-1" title="永久链接至标题"></a></h3>
<p>我无法成功使用 TinyXML。在必要时我升级到 TinyXML-2。这是一个相当简单的变更。</p>
<p>查看 <a class="reference external" href="https://github.com/ros-visualization/qt_gui_core/pull/147">此 PR</a> 以获取将代码迁移到 TinyXML-2 的示例。</p>
</div>
<div class="section" id="code-that-uses-cplusplus-and-code-that-requires-pluginlib">
<h3><a class="toc-backref" href="#id4">使用``__cplusplus``的代码和需要pluginlib的代码</a><a class="headerlink" href="#code-that-uses-cplusplus-and-code-that-requires-pluginlib" title="永久链接至标题"></a></h3>
<p>在某些地方，尤其是在pluginlib的ROS 2端口中，使用了``__cplusplus``标志。不幸的是，在Windows Visual Studio上，无论实际使用的C++标准是什么，都无法正确设置该标志。有关更多信息，请参阅`此页面&lt;<a class="reference external" href="https://docs.microsoft.com/en-us/cpp/build/reference/zc-cplusplus?view=vs-2017">https://docs.microsoft.com/en-us/cpp/build/reference/zc-cplusplus?view=vs-2017</a>&gt;`__。</p>
<p>要设置它，您需要添加编译选项``/Zc:__cplusplus``。</p>
<p>例如，在CMake中，您可以这样做：</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_compile_options</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s2">&quot;/Zc:__cplusplus&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="locations-of-build-artifacts-before-install">
<h3><a class="toc-backref" href="#id5">构建产物的位置（安装前）</a><a class="headerlink" href="#locations-of-build-artifacts-before-install" title="永久链接至标题"></a></h3>
<p>这个问题只在构建 <code class="docutils literal notranslate"><span class="pre">qt_gui_cpp</span></code> 时出现。在这个软件包中，自定义命令依赖于软件包的另一个部分中的目标库。然而，在构建完成之前，该库不会被安装。Windows 构建位于 ${configuration} 目录中。例如：</p>
<p>在 Linux 上，<code class="docutils literal notranslate"><span class="pre">qt_gui_cpp.a</span></code> 将会构建在：&lt;ros2_ws&gt;/build/qt_gui_cpp/src/qt_gui_cpp/</p>
<p>但是在 Windows 上，<code class="docutils literal notranslate"><span class="pre">qt_gui_cpp.lib</span></code> 将会构建在：&lt;ros2_ws&gt;/build/qt_gui_cpp/src/qt_gui_cpp/Release</p>
<p>为了在这种情况下实现跨平台兼容性，请使用 <a class="reference external" href="https://cmake.org/cmake/help/v3.5/manual/cmake-generator-expressions.7.html">CMake 生成器表达式</a>。然而，在需要链接库时，请确保使用 <code class="docutils literal notranslate"><span class="pre">$&lt;TARGET_LINKER_FILE:_target&gt;</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">$&lt;TARGET_FILE:_target&gt;</span></code>。后者会找到 <code class="docutils literal notranslate"><span class="pre">.dll</span></code> 文件，在Windows上无法链接。参见 <a class="reference external" href="https://github.com/ros-visualization/qt_gui_core/pull/162/files">此处的示例</a>。</p>
</div>
<div class="section" id="compiler-and-linker-flags">
<h3><a class="toc-backref" href="#id6">编译器和链接器标志</a><a class="headerlink" href="#compiler-and-linker-flags" title="永久链接至标题"></a></h3>
<p>通常在移植到Windows时，许多软件包可能会使用额外的编译器标志。您可以在 <a class="reference external" href="https://docs.microsoft.com/en-us/cpp/build/reference/compiler-options-listed-by-category?view=vs-2017">Microsoft 的文档</a> 中找到Windows编译器标志。C++编译器称为 <code class="docutils literal notranslate"><span class="pre">cl.exe</span></code>。</p>
<p>有关链接器标志，请参阅 <a class="reference external" href="https://docs.microsoft.com/en-us/cpp/build/reference/linker-options?view=vs-2017">Microsoft 的文档</a>。链接器程序称为 <code class="docutils literal notranslate"><span class="pre">link.exe</span></code>。</p>
<p>然而，CMake实际上在变量中提供了许多这些选项。这个`StackOverflow页面&lt;<a class="reference external" href="https://stackoverflow.com/questions/9298278/cmake-print-out-all-accessible-variables-in-a-script">https://stackoverflow.com/questions/9298278/cmake-print-out-all-accessible-variables-in-a-script</a>&gt;`__提供了一个很好的示例，可以查看脚本中所有可用的CMake变量。</p>
</div>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>