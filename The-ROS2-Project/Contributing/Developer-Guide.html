<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>The-ROS2-Project/Contributing/Developer-Guide</title>
</head>
<body>
  <div class="section" id="ros-2-developer-guide">
<h1>ROS 2开发者指南 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1644">[1644]</a><a class="headerlink" href="#ros-2-developer-guide" title="永久链接至标题"></a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1329">[]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#general-principles" id="id2">一般原则 [1646]</a></p></li>
<li><p><a class="reference internal" href="#quality-practices" id="id3">质量实践 [1651]</a></p>
<ul>
<li><p><a class="reference internal" href="#versioning" id="id4">版本管理 [1654]</a></p></li>
<li><p><a class="reference internal" href="#change-control-process" id="id5">变更控制流程 [1692]</a></p></li>
<li><p><a class="reference internal" href="#documentation" id="id6">文档 [1708]</a></p></li>
<li><p><a class="reference internal" href="#testing" id="id7">测试 [1729]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#general-practices" id="id8">一般实践 [1743]</a></p>
<ul>
<li><p><a class="reference internal" href="#issues" id="id9">问题 [1746]</a></p></li>
<li><p><a class="reference internal" href="#branches" id="id10">分支 [1759]</a></p></li>
<li><p><a class="reference internal" href="#pull-requests" id="id11">拉取请求 [1768]</a></p></li>
<li><p><a class="reference internal" href="#library-versioning" id="id12">库版本管理 [1781]</a></p></li>
<li><p><a class="reference internal" href="#development-process" id="id13">开发过程 [1783]</a></p></li>
<li><p><a class="reference internal" href="#changes-to-rmw-api" id="id14">RMW API的更改 [1789]</a></p></li>
<li><p><a class="reference internal" href="#tracking-tasks" id="id15">跟踪任务 [1795]</a></p></li>
<li><p><a class="reference internal" href="#programming-conventions" id="id16">编程约定 [1804]</a></p></li>
<li><p><a class="reference internal" href="#filesystem-layout" id="id17">文件系统布局 [1812]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#developer-workflow" id="id18">开发者工作流程 [1837]</a></p></li>
<li><p><a class="reference internal" href="#architectural-development-practices" id="id19">架构开发实践 [1865]</a></p>
<ul>
<li><p><a class="reference internal" href="#software-development-lifecycle" id="id20">软件开发生命周期 [1867]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#build-farm-introduction" id="id21">构建农场介绍 [1931]</a></p>
<ul>
<li><p><a class="reference internal" href="#note-on-coverage-runs" id="id22">覆盖率运行注意事项 [1967]</a></p></li>
<li><p><a class="reference internal" href="#how-to-read-the-coverage-rate-from-the-buildfarm-report" id="id23">如何从构建工厂报告中读取覆盖率 [1970]</a></p></li>
<li><p><a class="reference internal" href="#how-to-calculate-the-coverage-rate-from-the-buildfarm-report" id="id24">如何从构建农场报告中计算覆盖率 [1979]</a></p></li>
<li><p><a class="reference internal" href="#how-to-measure-coverage-locally-using-lcov-ubuntu" id="id25">如何使用 lcov（Ubuntu）在本地测量覆盖率 [1991]</a></p></li>
</ul>
</li>
</ul>
</div>
<p>这个页面定义了我们在开发ROS 2时采用的实践和策略。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1645">[1645]</a></p>
<div class="section" id="general-principles">
<h2>一般原则 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1646">[1646]</a><a class="headerlink" href="#general-principles" title="永久链接至标题"></a></h2>
<p>以下原则适用于所有ROS 2的开发： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1647">[1647]</a></p>
<ul class="simple">
<li><p><strong>共享所有权</strong>：每个参与ROS 2开发的人都应该对系统的所有部分有所所有感。代码的原始作者没有特殊的权限或义务来控制或维护该代码块。每个人都可以自由地在任何地方提出更改、处理任何类型的问题票和审核任何拉取请求。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1648">[1648]</a></p></li>
<li><p><strong>愿意做任何工作</strong>：作为共享所有权的必然结果，每个人都应该愿意承担任何可用的任务，并为系统的任何方面做出贡献。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1649">[1649]</a></p></li>
<li><p><strong>寻求帮助</strong>：如果在某个任务上遇到困难，请适当地通过工单、评论或电子邮件向你的开发同事寻求帮助。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1650">[1650]</a></p></li>
</ul>
</div>
<div class="section" id="quality-practices">
<h2>质量实践 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1651">[1651]</a><a class="headerlink" href="#quality-practices" title="永久链接至标题"></a></h2>
<p>根据它们所遵循的开发实践，软件包可以根据不同的质量水平进行分类，根据《REP 2004：软件包质量分类指南 &lt;<a class="reference external" href="https://www.ros.org/reps/rep-2004.html">https://www.ros.org/reps/rep-2004.html</a>&gt;》中的准则进行分类。这些分类根据版本管理、测试、文档编写等方面的策略进行区分。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1652">[1652]</a></p>
<p>以下部分是我们遵循的特定开发规则，以确保核心软件包具有最高质量（“一级”）。我们建议所有ROS开发人员努力遵守以下政策，以确保ROS生态系统的质量。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1653">[1653]</a></p>
<div class="section" id="versioning">
<span id="semver"></span><h3>版本管理 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1654">[1654]</a><a class="headerlink" href="#versioning" title="永久链接至标题"></a></h3>
<p>我们将使用`语义化版本指南 &lt;<a class="reference external" href="http://semver.org/">http://semver.org/</a>&gt;`__（<code class="docutils literal notranslate"><span class="pre">semver</span></code>）进行版本管理。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1655">[1655]</a></p>
<p>我们还将遵守一些基于``semver``的ROS特定规则，这些规则是在``semver``完整意义上建立的。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1656">[1656]</a></p>
<ul class="simple">
<li><p>不应该在已发布的ROS发行版中进行主要版本增加（即破坏性变更） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1657">[1657]</a></p>
<ul>
<li><p>补丁（保持接口兼容）和次要（非破坏性）版本增加不会破坏兼容性，因此此类更改*允许*在发布中进行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1658">[1658]</a></p></li>
<li><p>主要ROS版本是发布破坏性变更的最佳时机。如果核心包需要多个破坏性变更，则应将它们合并到集成分支（例如rolling）中，以便快速在CI中发现问题，但同时发布以减少ROS用户的主要发布数量 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1659">[1659]</a></p></li>
<li><p>尽管主要增量需要新的发行版，但新的发行版并不一定需要进行主要更新（如果开发和发布可以在不破坏API的情况下进行） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1660">[1660]</a></p></li>
</ul>
</li>
<li><p>对于编译代码，ABI（应用二进制接口）被视为公共接口的一部分。任何需要重新编译依赖代码的更改都被视为主要更改（破坏性的） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1661">[1661]</a></p>
<ul>
<li><p>ABI破坏性更改可以在次要版本升级之前（加入滚动发布）进行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1662">[1662]</a></p></li>
</ul>
</li>
<li><p>尽管 Dashing 和 Eloquent 的主要版本组件为``0``，我们仍对核心包的API稳定性进行强制执行，尽管 <a class="reference external" href="https://semver.org/#spec-item-4">SemVer 规范</a> 中有关初始开发的规定 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1663">[1663]</a></p>
<ul>
<li><p>随后，软件包应努力达到成熟状态并增加到版本``1.0.0``以符合``semver``的规范 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1664">[1664]</a></p></li>
</ul>
</li>
</ul>
<div class="section" id="caveats">
<h4>注意事项 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1665">[1665]</a><a class="headerlink" href="#caveats" title="永久链接至标题"></a></h4>
<p>这些规则是*尽力而为*的。在极端情况下，可能需要在一个主要版本/发布中打破API的兼容性。对于非计划中的兼容性断裂，是将主版本号还是次版本号增加将根据具体情况进行评估。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1666">[1666]</a></p>
<p>例如，考虑一个涉及发布的 X-turtle 和对应的主版本号为``1.0.0``的 Y-turtle 的情况。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1667">[1667]</a></p>
<p>如果在 X-turtle 中发现必须打破API兼容性的问题，显然不能选择升级到``2.0.0``，因为``2.0.0``已经存在。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1668">[1668]</a></p>
<p>在这种情况下处理X-turtle版本的解决方案，都是非理想的，包括： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1669">[1669]</a></p>
<ol class="arabic simple">
<li><p>增加X-turtle的次要版本：非理想，因为它违反了语义化版本规范（SemVer）中破坏性变更必须增加主要版本的原则。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1670">[1670]</a></p></li>
<li><p>将X-turtle的主要版本升级到超过Y-turtle（<code class="docutils literal notranslate"><span class="pre">3.0.0</span></code>）：非理想，因为旧发行版的版本将会高于已有的新发行版版本，这将使得特定版本条件代码失效/破坏。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1671">[1671]</a></p></li>
</ol>
<p>开发人员将需要决定使用哪种解决方案，或者更重要的是，他们愿意违背哪个原则。我们不能建议选用其中一种，但无论哪种情况，我们都要求采取明确的措施手动向用户传达中断情况及其解释（不仅仅是版本号的增加）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1672">[1672]</a></p>
<p>如果没有 Y-turtle，即使修复只是一个补丁，X-turtle 也必须升级到 <code class="docutils literal notranslate"><span class="pre">2.0.0</span></code>。这种情况符合 SemVer 规则，但违反了我们自己的规定，即在发布的分发版中不应引入主要增量。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1673">[1673]</a></p>
<p>这就是为什么我们将版本规则视为“尽力而为”。尽管上述例子不太可能出现，但准确定义我们的版本系统非常重要。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1674">[1674]</a></p>
</div>
<div class="section" id="public-api-declaration">
<h4>公共 API 声明 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1675">[1675]</a><a class="headerlink" href="#public-api-declaration" title="永久链接至标题"></a></h4>
<p>根据 <code class="docutils literal notranslate"><span class="pre">semver</span></code>，每个软件包必须明确声明一个公共 API。我们将使用软件包的质量声明中的“公共 API 声明”部分来声明哪些符号是公共 API 的一部分。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1676">[1676]</a></p>
<p>对于大多数 C 和 C++ 包，声明是其安装的任何头文件。然而，定义一组被视为私有的符号也是可以接受的。在头文件中避免私有符号可以帮助实现 ABI 的稳定性，但并非必需。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1677">[1677]</a></p>
<p>对于其他语言如 Python，必须明确定义公共 API，以便清楚地知道哪些符号可以依赖于版本指南。公共 API 还可以扩展到构建工件，如配置变量、CMake 配置文件等，以及可执行文件、命令行选项和输出。包的文档应清楚地说明公共 API 的任何元素。如果你使用的内容在包的文档中没有明确列出作为公共 API 的一部分，那么你不能指望它在次要或修补版本之间不发生变化。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1678">[1678]</a></p>
</div>
<div class="section" id="deprecation-strategy">
<h4>废弃策略 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1679">[1679]</a><a class="headerlink" href="#deprecation-strategy" title="永久链接至标题"></a></h4>
<p>在可能的情况下，我们还将使用主要版本增量的滴答滴答废弃和迁移策略。新的废弃将在新的发行版中提出，伴随着编译器警告，表示该功能正在被废弃。在下一个发布中，该功能将被完全移除（不再有警告）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1680">[1680]</a></p>
<p>示例函数 <code class="docutils literal notranslate"><span class="pre">foo</span></code> 已弃用，并被函数 <code class="docutils literal notranslate"><span class="pre">bar</span></code> 替代： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1681">[1681]</a></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 14%" />
<col style="width: 86%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>版本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1523">[1523]</a></p></th>
<th class="head"><p>API <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1682">[1682]</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X-turtle <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1683">[1683]</a></p></td>
<td><p>void foo(); <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1684">[1684]</a></p></td>
</tr>
<tr class="row-odd"><td><p>Y-龟 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1685">[1685]</a></p></td>
<td><p>[[已弃用(&quot;使用bar()&quot;)]] void foo(); &lt;br&gt; void bar(); <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1686">[1686]</a></p></td>
</tr>
<tr class="row-even"><td><p>Z-龟 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1687">[1687]</a></p></td>
<td><p>void bar(); <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1688">[1688]</a></p></td>
</tr>
</tbody>
</table>
<p>在发行版发布之后，我们不能添加废弃项。然而，废弃项不一定需要引发主要版本的升级。如果在发行版发布之前进行次要版本的升级，就可以引入废弃项（类似于破坏ABI的更改）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1689">[1689]</a></p>
<p>例如，如果X-turtle作为``2.0.0``开始开发，可以在X-turtle发布之前的``2.1.0``中添加废弃项。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1690">[1690]</a></p>
<p>我们将尽可能在不同发行版之间保持兼容性。然而，与语义化版本控制（SemVer）相关的注意事项一样，特定情况下可能无法完全遵守打勾或废弃项。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1691">[1691]</a></p>
</div>
</div>
<div class="section" id="change-control-process">
<h3>变更控制流程 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1692">[1692]</a><a class="headerlink" href="#change-control-process" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>所有更改都必须通过拉取请求进行。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1693">[1693]</a></p></li>
<li><p>我们将在ROSCore仓库的拉取请求中执行`开发者证书 (DCO) &lt;<a class="reference external" href="https://developercertificate.org/">https://developercertificate.org/</a>&gt;`_ 的强制要求。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1694">[1694]</a></p>
<ul>
<li><p>它要求所有提交消息都包含与提交作者相匹配的``Signed-off-by``行及其电子邮件地址。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1695">[1695]</a></p></li>
<li><p>您可以在``git commit``命令中添加``-s`` / <code class="docutils literal notranslate"><span class="pre">--signoff``参数或手动编写所需的消息（例如：``Signed-off-by:</span> <span class="pre">Your</span> <span class="pre">Name</span> <span class="pre">Developer</span> <span class="pre">&lt;your.name&#64;example.com&gt;</span></code>）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1696">[1696]</a></p></li>
<li><p>只涉及空格删除、拼写错误更正和其他 <a class="reference external" href="http://cr.openjdk.java.net/~jrose/draft/trivial-fixes.html">微小更改</a> 的拉取请求，不需要DCO。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1697">[1697]</a></p></li>
</ul>
</li>
<li><p>对于每个拉取请求，始终在所有 <a class="reference external" href="https://www.ros.org/reps/rep-2000.html#support-tiers">一级支持平台</a> 上运行CI作业，并在拉取请求中包含作业链接。（如果您无权访问Jenkins作业，将有人为您触发作业。） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1698">[1698]</a></p></li>
<li><p>需要至少来自未参与拉取请求撰写的其他开发人员的1个批准才能被视为已批准。在合并之前需要批准。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1699">[1699]</a></p>
<ul>
<li><p>软件包可以选择增加此数字。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1700">[1700]</a></p></li>
</ul>
</li>
<li><p>在合并相关更改之前，必须先提出对文档（API文档、功能文档、发布说明等）所需的任何更改。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1701">[1701]</a></p></li>
</ul>
<div class="section" id="guidelines-for-backporting-prs">
<h4>关于回溯拉取请求的准则 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1702">[1702]</a><a class="headerlink" href="#guidelines-for-backporting-prs" title="永久链接至标题"></a></h4>
<p>在更改较旧版本的ROS时： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1703">[1703]</a></p>
<ul class="simple">
<li><p>确保在向较旧版本回溯更改的拉取请求之前，这些功能或修复已被接受并合并到滚动分支中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1704">[1704]</a></p></li>
<li><p>当将代码回溯到较旧的版本时，还要考虑回溯到任何其他 <a class="reference internal" href="../../Releases.html"><span class="doc">仍受支持的版本</span></a>，甚至非LTS版本。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1705">[1705]</a></p></li>
<li><p>如果您要完整地回溯单个PR，请将回溯PR的标题命名为&quot;[Distro] &lt;原始PR的名称&gt;&quot;。如果从一个或多个PR回溯部分更改，则标题应为&quot;[Distro] &lt;更改的描述&gt;&quot;。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1706">[1706]</a></p></li>
<li><p>在回溯PR的描述中链接到您回溯更改的所有PR。在将Foxy更改回溯到Dashing时，您不需要链接到同一更改的Eloquent回溯。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1707">[1707]</a></p></li>
</ul>
</div>
</div>
<div class="section" id="documentation">
<h3>文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1708">[1708]</a><a class="headerlink" href="#documentation" title="永久链接至标题"></a></h3>
<p>所有的软件包都应该在其README中包含或从其README中链接到以下文档元素： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1709">[1709]</a></p>
<ul class="simple">
<li><p>描述和目的 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1710">[1710]</a></p></li>
<li><p>公共API的定义和描述 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1711">[1711]</a></p></li>
<li><p>示例 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1507">[1507]</a></p></li>
<li><p>如何构建和安装（应该引用外部工具/工作流程） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1712">[1712]</a></p></li>
<li><p>如何构建和运行测试 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1713">[1713]</a></p></li>
<li><p>如何构建文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1714">[1714]</a></p></li>
<li><p>如何进行开发（对于描述诸如``python setup.py develop``之类的内容很有用） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1715">[1715]</a></p></li>
<li><p>许可证和版权声明 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1716">[1716]</a></p></li>
</ul>
<p>每个源文件必须有一个许可证和版权声明，通过自动化检查工具进行检查。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1717">[1717]</a></p>
<p>每个软件包必须有一个LICENSE文件，通常是Apache 2.0许可证，除非该软件包有现有的宽松许可证（例如，rviz使用三条款的BSD许可证）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1718">[1718]</a></p>
<p>每个软件包应该对自身和其目的进行描述，尽量假设读者没有关于ROS或其他相关项目的先前知识而意外发现该软件包。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1719">[1719]</a></p>
<p>每个软件包应该定义和描述其公共API，以便用户可以合理地预期语义版本控制政策所覆盖的内容。即使在C和C++中，公共API可以通过API和ABI检查来强制执行，这也是一个很好的机会来描述代码的结构和每个部分的功能。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1720">[1720]</a></p>
<p>理应很容易通过任何软件包的文档了解如何构建、运行、构建并运行测试，并构建文档。显然，我们应该避免在常见工作流程中重复自己，比如在工作空间中构建软件包，但基本工作流程应该被描述或引用。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1721">[1721]</a></p>
<p>最后，它应该包含开发者的任何文档。这可能包括使用类似 <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">develop</span></code> 的方法测试代码的工作流程，或者可能意味着描述如何利用软件包提供的扩展点。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1722">[1722]</a></p>
<p>示例： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1723">[1723]</a></p>
<ul class="simple">
<li><p>功能：<a class="reference external" href="https://docs.ros.org/hydro/api/capabilities/html/">https://docs.ros.org/hydro/api/capabilities/html/</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1724">[1724]</a></p>
<ul>
<li><p>这个例子展示了描述公共API的文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1725">[1725]</a></p></li>
</ul>
</li>
<li><p>catkin_tools：<a class="reference external" href="https://catkin-tools.readthedocs.org/en/latest/development/extending_the_catkin_command.html">https://catkin-tools.readthedocs.org/en/latest/development/extending_the_catkin_command.html</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1726">[1726]</a></p>
<ul>
<li><p>这是描述软件包扩展点的示例 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1727">[1727]</a></p></li>
</ul>
</li>
</ul>
<p>（API文档尚未自动生成） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1728">[1728]</a></p>
</div>
<div class="section" id="testing">
<h3>测试 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1729">[1729]</a><a class="headerlink" href="#testing" title="永久链接至标题"></a></h3>
<p>所有的软件包都应该具备一定程度的 <a class="reference internal" href="../../Tutorials/Intermediate/Testing/Testing-Main.html#testingmain"><span class="std std-ref">系统测试、集成测试和/或单元测试。</span></a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1730">[1730]</a></p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>单元测试**应该始终位于被测试的软件包中，并且应该使用诸如``Mock``之类的工具，尝试在构建的场景中测试代码库的狭窄部分。单元测试不应引入非测试工具的测试依赖，例如 gtest、nosestest、pytest、mock 等... <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1731">[1731]</a></p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>集成测试**可以测试代码的各个部分之间或代码与系统之间的交互。它们通常以我们期望用户使用它们的方式测试软件接口。与单元测试类似，集成测试应该位于被测试的软件包中，除非绝对必要，否则不应引入非工具测试依赖，即所有非工具依赖都应在极端审查下才被允许，因此应尽量避免使用。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1732">[1732]</a></p>
<p><a href="#id1"><span class="problematic" id="id2">**</span></a>系统测试**旨在测试软件包之间的端到端情况，并应位于它们自己的软件包中，以避免软件包膨胀或耦合以及避免循环依赖。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1733">[1733]</a></p>
<p>通常情况下，应尽量减少外部或跨包的测试依赖，以避免循环依赖和紧密耦合的测试包。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1734">[1734]</a></p>
<p>所有的包都应该有一些单元测试和可能的集成测试，但其数量取决于包的质量分类。以下小节适用于“Level 1”包： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1735">[1735]</a></p>
<div class="section" id="code-coverage">
<h4>代码覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1736">[1736]</a><a class="headerlink" href="#code-coverage" title="永久链接至标题"></a></h4>
<p>我们将提供行覆盖率，并保证行覆盖率达到95%以上。如果有合理降低百分比目标的情况，必须明确记录。我们可以提供分支覆盖率，或者将某些代码排除在覆盖率之外（测试代码、调试代码等）。在合并更改之前，我们要求覆盖率要增加或保持不变，但在适当的理由下，可能会接受降低代码覆盖率的更改（例如，删除以前覆盖的代码可能会导致百分比下降）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1737">[1737]</a></p>
</div>
<div class="section" id="performance">
<h4>性能 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1738">[1738]</a><a class="headerlink" href="#performance" title="永久链接至标题"></a></h4>
<p>我们强烈建议进行性能测试，但我们也认识到对于某些软件包来说，这并没有意义。如果有性能测试，我们将选择在每次更改或发布之前进行检查，或者两者都要进行。我们还需要对降低性能的更改或发布进行合并的理由。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1739">[1739]</a></p>
</div>
<div class="section" id="linters-and-static-analysis">
<h4>代码检查器和静态分析 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1740">[1740]</a><a class="headerlink" href="#linters-and-static-analysis" title="永久链接至标题"></a></h4>
<p>我们将使用:doc:<a class="reference internal" href="Code-Style-Language-Versions.html"><span class="doc">ROS代码风格</span></a>，并使用来自`ament_lint_common&lt;<a class="reference external" href="https://github.com/ament/ament_lint/tree/humble/ament_lint_common/doc/index.rst">https://github.com/ament/ament_lint/tree/humble/ament_lint_common/doc/index.rst</a>&gt;`_的代码检查器来强制执行。必须使用`ament_lint_common`的所有代码检查器和静态分析工具。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1741">[1741]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">ament_lint_auto</span></code> 文档提供了关于运行 <code class="docutils literal notranslate"><span class="pre">ament_lint_common</span></code> 的信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1742">[1742]</a></p>
</div>
</div>
</div>
<div class="section" id="general-practices">
<h2>一般实践 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1743">[1743]</a><a class="headerlink" href="#general-practices" title="永久链接至标题"></a></h2>
<p>一些实践适用于所有 ROS 2 开发。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1744">[1744]</a></p>
<p>这些实践不会影响软件包质量等级（如 <a class="reference external" href="https://www.ros.org/reps/rep-2004.html">REP 2004</a> 中所述），但在开发过程中仍然强烈推荐。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1745">[1745]</a></p>
<div class="section" id="issues">
<h3>问题 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1746">[1746]</a><a class="headerlink" href="#issues" title="永久链接至标题"></a></h3>
<p>在提交问题时，请确保： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1747">[1747]</a></p>
<ul class="simple">
<li><p>提供足够的信息让其他人能够理解问题。在ROS 2中，以下几点对于缩小问题原因范围非常有帮助。在每个类别中尽可能尝试多种替代方案将特别有帮助。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1748">[1748]</a></p>
<ul>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>操作系统及版本。<a href="#id3"><span class="problematic" id="id4">**</span></a>原因：ROS 2支持多个平台，某些错误可能只出现在特定版本的操作系统/编译器上。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1749">[1749]</a></p></li>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>安装方法。<a href="#id3"><span class="problematic" id="id4">**</span></a>理由：某些问题只在使用“fat archives”或Debians安装ROS 2时才显现出来。这可以帮助我们确定问题是否与打包过程有关。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1750">[1750]</a></p></li>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>ROS 2的具体版本。<a href="#id3"><span class="problematic" id="id4">**</span></a>理由：某些错误可能存在于特定的ROS 2版本中，后来被修复。了解您的安装是否包含这些修复非常重要。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1751">[1751]</a></p></li>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>正在使用的DDS/RMW实现**（参见`此页面&lt;../../Concepts/About-Different-Middleware-Vendors&gt;`，以了解如何确定使用的是哪个）。理由：通信问题可能特定于所使用的基础ROS中间件。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1752">[1752]</a></p></li>
<li><p><a href="#id1"><span class="problematic" id="id2">**</span></a>正在使用的ROS 2客户端库。<a href="#id3"><span class="problematic" id="id4">**</span></a>理由：这可以帮助我们缩小问题可能出现的堆栈层级范围。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1753">[1753]</a></p></li>
</ul>
</li>
<li><p>包含一系列重现问题的步骤。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1754">[1754]</a></p></li>
<li><p>如果遇到错误，请考虑提供一个`简短、自包含、正确（可编译）的示例 &lt;<a class="reference external" href="http://sscce.org/">http://sscce.org/</a>&gt;`__。如果其他人能够轻松地重现错误，问题更有可能被解决。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1755">[1755]</a></p></li>
<li><p>提及已尝试过的故障排除步骤，包括： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1756">[1756]</a></p>
<ul>
<li><p>升级到最新版本的代码，该版本可能包含尚未发布的错误修复。参见`此部分 &lt;building-from-source&gt;`，并按照说明获取&quot;rolling&quot;分支。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1757">[1757]</a></p></li>
<li><p>尝试使用不同的RMW实现。请参考`此页面 &lt;../../How-To-Guides/Working-with-multiple-RMW-implementations&gt;`了解如何操作。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1758">[1758]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="branches">
<h3>分支 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1759">[1759]</a><a class="headerlink" href="#branches" title="永久链接至标题"></a></h3>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>这只是一些指南。选择分支名称以匹配其自身工作流程是包维护者的责任。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1760">[1760]</a></p>
</div>
<p>在一个包的源代码库中，为其所针对的每个ROS发行版创建**单独的分支**是一种良好的做法。这些分支通常以它们所针对的发行版命名。例如，针对Humble发行版的开发可以创建一个名为``humble``的分支。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1761">[1761]</a></p>
<p>从这些分支中也可以发布版本，以适应相应的发行版。针对特定ROS发行版的开发可以在相应的分支上进行。例如：针对``foxy``的开发提交将被放到``foxy``分支，并且针对``foxy``的软件包发布将从同一分支进行。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1762">[1762]</a></p>
<div class="admonition note">
<p class="admonition-title">注解</p>
<p>这需要软件包维护者根据需要执行回溯或向前移植，以保持所有分支与功能的同步。维护者还必须对所有仍然进行软件包发布的分支进行常规维护（修复错误等）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1763">[1763]</a></p>
<p>例如，如果某个功能已合并到特定于Rolling的分支（例如``rolling``或``main``），并且该功能也适用于Humble发行版（不会破坏API等），那么将该功能回溯到Humble特定分支是一种良好的做法。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1764">[1764]</a></p>
<p>如果存在新功能或错误修复，则维护者可以为这些旧的发行版进行发布。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1765">[1765]</a></p>
</div>
<p><strong>关于</strong> <code class="docutils literal notranslate"><span class="pre">main</span></code> <strong>和</strong> <code class="docutils literal notranslate"><span class="pre">rolling</span></code> <strong>呢？</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1766">[1766]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">main</span></code> 通常目标为 <span class="xref std std-doc">Rolling &lt;../../Releases/Release-Rolling-Ridley&gt;`（即下一个尚未发布的ROS版本），但维护者可能决定从 ``rolling`</span> 分支进行开发和发布。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1767">[1767]</a></p>
</div>
<div class="section" id="pull-requests">
<h3>拉取请求 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1768">[1768]</a><a class="headerlink" href="#pull-requests" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>一个拉取请求应该只关注一个更改。不同的更改应该放入不同的拉取请求中。参见 <a class="reference external" href="https://github.com/blog/1943-how-to-write-the-perfect-pull-request">GitHub完美拉取请求指南</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1769">[1769]</a></p></li>
<li><p>补丁应该尽量保持最小的大小，并避免任何不必要的更改。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1770">[1770]</a></p></li>
<li><p>拉取请求必须包含最少数量的有意义的提交。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1771">[1771]</a></p>
<ul>
<li><p>在拉取请求正在审核中时，您可以创建新的提交。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1772">[1772]</a></p></li>
</ul>
</li>
<li><p>在合并拉取请求之前，所有的更改应该被压缩成少量的语义提交，以保持历史清晰。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1773">[1773]</a></p>
<ul>
<li><p>在审核期间避免压缩提交记录。您的审阅人员可能不会注意到您所做的更改，从而引入混淆的可能性。而且，无论如何在合并之前都要进行压缩；提前压缩没有任何好处。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1774">[1774]</a></p></li>
</ul>
</li>
<li><p>任何开发者都可以审核并批准拉取请求（请参阅 <a class="reference internal" href="#general-principles">General Principles</a>）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1775">[1775]</a></p></li>
<li><p>当您正在处理尚未准备好审核或合并的更改时，请使用草稿拉取请求。当这些更改准备好进行审核时，将拉取请求从草稿状态移出。请注意，如果您想从草稿拉取请求中获得特定人员的早期反馈意见，可以在拉取请求的描述或评论中提及他们。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1776">[1776]</a></p></li>
<li><p>如果您的拉取请求依赖于其他拉取请求，请通过在拉取请求的描述顶部添加 <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">Depends</span> <span class="pre">on</span> <span class="pre">&lt;link&gt;</span></code> 来链接到每个所依赖的拉取请求。这样做有助于审阅人员了解拉取请求的上下文。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1777">[1777]</a></p></li>
<li><p>当您开始审查拉取请求时，请在拉取请求上发表评论，以便其他开发人员知道您正在进行审查。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1778">[1778]</a></p></li>
<li><p>拉取请求审查不是只读的，审查人员会发表评论，然后等待作者处理。作为审查人员，可以自由地进行一些小的改进（拼写错误、样式问题等）。作为拉取请求的发起人，如果您在一个分支上工作，请勾选`允许来自上游贡献者的编辑 &lt;<a class="reference external" href="https://github.com/blog/2247-improving-collaboration-with-forks">https://github.com/blog/2247-improving-collaboration-with-forks</a>&gt;`__ 选项，这将有助于前述情况。作为审查人员，也可以自由地进行一些较大的改进，但考虑将它们放在一个单独的分支中（在评论中提到新的分支，或者从新分支向原始分支发起另一个拉取请求）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1779">[1779]</a></p></li>
<li><p>任何开发人员（作者、审查人员或其他人）都可以合并任何已批准的拉取请求。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1780">[1780]</a></p></li>
</ul>
</div>
<div class="section" id="library-versioning">
<h3>库版本管理 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1781">[1781]</a><a class="headerlink" href="#library-versioning" title="永久链接至标题"></a></h3>
<p>我们将同时对一个包中的所有库进行版本控制。这意味着库的版本继承自该包。这样可以防止库和包的版本分歧，并与共享同一个代码仓库的包发布策略保持一致。如果您需要库具有不同的版本，请考虑将它们拆分为不同的包。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1782">[1782]</a></p>
</div>
<div class="section" id="development-process">
<h3>开发过程 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1783">[1783]</a><a class="headerlink" href="#development-process" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>默认分支（大多数情况下是滚动分支）必须始终构建，通过所有测试并且没有警告信息。如果出现任何回归问题，最重要的是至少恢复到先前的状态。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1784">[1784]</a></p></li>
<li><p>始终使用启用了测试的构建。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1785">[1785]</a></p></li>
<li><p>在对更改进行推送之前，始终在本地运行测试，并确保它们在拉取请求中正常工作。除了使用自动化测试外，还要手动运行修改后的代码路径，以确保补丁按预期工作。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1786">[1786]</a></p></li>
<li><p>对于每个拉取请求，始终运行适用于所有平台的CI作业，并在拉取请求中包含作业链接。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1787">[1787]</a></p></li>
</ul>
<p>有关推荐的软件开发工作流程的更多详细信息，请参阅“软件开发生命周期”_部分。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1788">[1788]</a></p>
</div>
<div class="section" id="changes-to-rmw-api">
<h3>RMW API的更改 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1789">[1789]</a><a class="headerlink" href="#changes-to-rmw-api" title="永久链接至标题"></a></h3>
<p>当更新 <a class="reference external" href="https://github.com/ros2/rmw">RMW API</a> 时，需要同时更新Tier 1中间件库的RMW实现。例如，RMW API 中引入了新函数 <code class="docutils literal notranslate"><span class="pre">rmw_foo()</span></code>，必须在以下软件包中实现（截至ROS Galactic版本）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1790">[1790]</a></p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/ros2/rmw_connextdds">rmw_connextdds</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1791">[1791]</a></p></li>
<li><p><a class="reference external" href="https://github.com/ros2/rmw_cyclonedds">rmw_cyclonedds</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1792">[1792]</a></p></li>
<li><p><a class="reference external" href="https://github.com/ros2/rmw_fastrtps">rmw_fastrtps</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1793">[1793]</a></p></li>
</ul>
<p>如果可行的话，也应考虑更新非一级中间件库（例如，根据更改的大小）。有关中间件库及其等级的列表，请参阅 <a class="reference external" href="https://www.ros.org/reps/rep-2000.html">REP-2000</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1794">[1794]</a></p>
</div>
<div class="section" id="tracking-tasks">
<h3>跟踪任务 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1795">[1795]</a><a class="headerlink" href="#tracking-tasks" title="永久链接至标题"></a></h3>
<p>为了帮助组织ROS 2的工作，核心ROS 2开发团队使用看板式 <a class="reference external" href="https://github.com/orgs/ros2/projects">GitHub项目看板</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1796">[1796]</a></p>
<p>然而，并不是所有问题和拉取请求都在项目看板上跟踪。一个看板通常表示一个即将发布的版本或特定的项目。可以通过浏览 <a class="reference external" href="https://github.com/ros2">ROS 2存储库的个别问题页面</a> 来浏览票证。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1797">[1797]</a></p>
<p>任何给定的ROS 2项目看板中的列名称和用途可能会有所不同，但通常遵循相同的一般结构： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1798">[1798]</a></p>
<ul class="simple">
<li><p><strong>待办事项</strong>：与项目相关的问题，可以分配处理 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1799">[1799]</a></p></li>
<li><p><strong>进行中</strong>：正在进行工作的活动拉取请求 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1800">[1800]</a></p></li>
<li><p><strong>审核中</strong>：工作已完成且准备好进行审核的拉取请求，以及目前正在进行主动审核的请求 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1801">[1801]</a></p></li>
<li><p><strong>完成</strong>：合并/关闭拉取请求和相关问题（仅供参考） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1802">[1802]</a></p></li>
</ul>
<p>如果要请求更改权限，请在您感兴趣的工单上发表评论即可。根据复杂程度，描述您打算如何解决问题可能会很有用。我们将更新状态（如果您没有权限），然后您可以开始处理拉取请求。如果您经常做出贡献，我们可能会直接授予您管理标签等权限。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1803">[1803]</a></p>
</div>
<div class="section" id="programming-conventions">
<h3>编程约定 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1804">[1804]</a><a class="headerlink" href="#programming-conventions" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>防御式编程：确保尽早持有假设。例如，检查每个返回代码，并确保至少抛出异常，直到处理情况更加优雅为止。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1805">[1805]</a></p></li>
<li><p>所有错误消息必须指向 <code class="docutils literal notranslate"><span class="pre">stderr</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1806">[1806]</a></p></li>
<li><p>在尽可能狭窄的范围内声明变量。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1807">[1807]</a></p></li>
<li><p>保持一组项目（依赖项、导入项、包含项等）按字母顺序排列。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1808">[1808]</a></p></li>
</ul>
<div class="section" id="c-specific">
<h4>特定于 C++。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1809">[1809]</a><a class="headerlink" href="#c-specific" title="永久链接至标题"></a></h4>
<ul class="simple">
<li><p>避免直接将流 (<code class="xref any docutils literal notranslate"><span class="pre">&lt;&lt;</span></code>) 输出到 <code class="xref any docutils literal notranslate"><span class="pre">stdout</span></code>/<code class="xref any docutils literal notranslate"><span class="pre">stderr</span></code>，以防止多个线程之间的交错。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1810">[1810]</a></p></li>
<li><p>避免使用引用来操作 <code class="xref any docutils literal notranslate"><span class="pre">std::shared_ptr</span></code>，因为这会破坏引用计数。如果原始实例超出作用域且引用正在使用中，它将访问已释放的内存。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1811">[1811]</a></p></li>
</ul>
</div>
</div>
<div class="section" id="filesystem-layout">
<h3>文件系统布局 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1812">[1812]</a><a class="headerlink" href="#filesystem-layout" title="永久链接至标题"></a></h3>
<p>软件包和存储库的文件系统布局应遵循相同的约定，以便为浏览我们的源代码的用户提供一致的体验。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1813">[1813]</a></p>
<div class="section" id="package-layout">
<h4>包布局 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1814">[1814]</a><a class="headerlink" href="#package-layout" title="永久链接至标题"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src</span></code>: 包含所有的 C 和 C++ 代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1815">[1815]</a></p>
<ul>
<li><p>同时包含未安装的 C/C++ 头文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1816">[1816]</a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">include</span></code>: 包含所有已安装的 C 和 C++ 头文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1817">[1817]</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;package</span> <span class="pre">name&gt;</span></code>：对于所有已安装的 C 和 C++ 标头，它们应该由包名进行命名空间分隔 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1818">[1818]</a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;package_name&gt;</span></code>：包含所有 Python 代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1819">[1819]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code>：包含所有自动化测试和测试数据 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1820">[1820]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>：包含配置文件，例如 YAML 参数文件和 RViz 配置文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1821">[1821]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc</span></code>：包含所有的文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1822">[1822]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">launch</span></code>：包含所有的启动文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1823">[1823]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">package.xml</span></code>：根据`REP-0140 &lt;<a class="reference external" href="https://www.ros.org/reps/rep-0140.html">https://www.ros.org/reps/rep-0140.html</a>&gt;`_定义的（可能会更新用于原型设计） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1824">[1824]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>：仅限使用 CMake 的 ROS 软件包 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1825">[1825]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">setup.py</span></code>：仅适用于仅使用Python代码的ROS软件包 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1826">[1826]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">README</span></code>：可以作为项目的首页在GitHub上显示 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1827">[1827]</a></p>
<ul>
<li><p>这可以是简短或详细的，但至少应该链接到项目文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1828">[1828]</a></p></li>
<li><p>考虑在此README中添加CI或代码覆盖率标签 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1829">[1829]</a></p></li>
<li><p>它也可以是 <code class="docutils literal notranslate"><span class="pre">.rst</span></code> 或任何 GitHub 支持的格式 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1830">[1830]</a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONTRIBUTING</span></code>：描述贡献准则 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1831">[1831]</a></p>
<ul>
<li><p>这可能涉及许可证的含义，例如使用 Apache 2 许可证时 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1832">[1832]</a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">LICENSE</span></code>：此软件包的许可证副本或许可证 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1833">[1833]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CHANGELOG.rst</span></code>：<a class="reference external" href="https://www.ros.org/reps/rep-0132.html">REP-0132</a> 兼容的变更日志 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1834">[1834]</a></p></li>
</ul>
</div>
<div class="section" id="repository-layout">
<h4>存储库布局 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1835">[1835]</a><a class="headerlink" href="#repository-layout" title="永久链接至标题"></a></h4>
<p>每个软件包应该位于与软件包同名的子文件夹中。如果一个存储库只包含一个软件包，它可以选择位于存储库的根目录中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1836">[1836]</a></p>
</div>
</div>
</div>
<div class="section" id="developer-workflow">
<h2>开发者工作流程 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1837">[1837]</a><a class="headerlink" href="#developer-workflow" title="永久链接至标题"></a></h2>
<p>我们使用 <a class="reference external" href="https://github.com/orgs/ros2/projects">GitHub项目面板</a> 来跟踪与即将发布的版本和较大项目相关的未解决问题和活动中的PR。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1838">[1838]</a></p>
<p>通常的工作流程是： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1839">[1839]</a></p>
<ul>
<li><p>讨论设计（在适当的存储库上的GitHub票证，并在需要时在 <a class="reference external" href="https://github.com/ros2/design">https://github.com/ros2/design</a> 上创建设计PR） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1840">[1840]</a></p></li>
<li><p>在一个分支上的特性分支上编写实现 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1841">[1841]</a></p>
<ul class="simple">
<li><p>请查看 <a class="reference internal" href="#"><span class="doc">开发人员指南</span></a> 以获取指导方针和最佳实践 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1842">[1842]</a></p></li>
</ul>
</li>
<li><p>编写测试 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1843">[1843]</a></p></li>
<li><p>启用并运行代码检查工具 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1844">[1844]</a></p></li>
<li><p>在本地运行测试，使用 <a href="#id1"><span class="problematic" id="id2">``</span></a>colcon test``（请参阅 <a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Colcon-Tutorial.html"><span class="doc">colcon 教程</span></a>） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1845">[1845]</a></p></li>
<li><p>一旦本地构建没有警告并且所有测试都通过，请在你的功能分支上运行CI： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1846">[1846]</a></p>
<ul class="simple">
<li><p>访问 ci.ros2.org <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1847">[1847]</a></p></li>
<li><p>登录（右上角） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1848">[1848]</a></p></li>
<li><p>点击 <code class="docutils literal notranslate"><span class="pre">ci_launcher</span></code> 作业 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1849">[1849]</a></p></li>
<li><p>点击&quot;使用参数构建&quot;（左列） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1850">[1850]</a></p></li>
<li><p>在第一个框中输入&quot;CI_BRANCH_TO_TEST&quot;，输入您的特性分支名称 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1851">[1851]</a></p></li>
<li><p>点击 <code class="docutils literal notranslate"><span class="pre">build</span></code> 按钮 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1852">[1852]</a></p></li>
</ul>
<p>(如果您不是ROS 2的贡献者，您无法访问CI工作区。在这种情况下，请联系您的PR审查者为您运行CI) <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1853">[1853]</a></p>
</li>
<li><p>如果您的使用场景需要运行代码覆盖率: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1854">[1854]</a></p>
<ul class="simple">
<li><p>访问 ci.ros2.org <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1847">[1847]</a></p></li>
<li><p>登录（右上角） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1848">[1848]</a></p></li>
<li><p>点击``ci_linux_coverage``作业 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1855">[1855]</a></p></li>
<li><p>点击&quot;使用参数构建&quot;（左列） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1850">[1850]</a></p></li>
<li><p>确保将&quot;CI_BUILD_ARGS&quot;和&quot;CI_TEST_ARGS&quot;保留为默认值 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1856">[1856]</a></p></li>
<li><p>点击 <code class="docutils literal notranslate"><span class="pre">build</span></code> 按钮 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1852">[1852]</a></p></li>
<li><p>在文档的末尾，有关于如何 <a href="#id1"><span class="problematic" id="id2">:ref:`解读报告结果 &lt;read-coverage-report&gt;`和 :ref:`计算覆盖率 &lt;calculate-coverage-rate&gt;`的说明 `[1857] &lt;http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1857&gt;`_</span></a></p></li>
</ul>
</li>
<li><p>如果 CI 作业在没有警告、错误和测试失败的情况下构建成功，请在您的 PR 或汇总所有 PR 的高级票证上发布您作业的链接（参见示例 <a class="reference external" href="https://github.com/ros2/rcl/pull/106#issuecomment-271119200">here</a>) <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1858">[1858]</a></p>
<ul class="simple">
<li><p>请注意，这些徽章的 Markdown 代码位于“ci_launcher”作业的控制台输出中 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1859">[1859]</a></p></li>
</ul>
</li>
<li><p>当 PR 被批准后： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1860">[1860]</a></p>
<ul class="simple">
<li><p>提交 PR 的人使用“Squash and Merge”选项将其合并，以便保持干净的历史记录 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1861">[1861]</a></p>
<ul>
<li><p>如果这些提交应该保持分开：将所有的 nitpick/linters/typo 提交合并在一起，然后合并剩余的提交集合 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1862">[1862]</a></p>
<ul>
<li><p>注意：每个 PR 应该针对一个具体的功能，因此大部分情况下 Squash and Merge 是有意义的 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1863">[1863]</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>合并后删除该分支 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1864">[1864]</a></p></li>
</ul>
</div>
<div class="section" id="architectural-development-practices">
<h2>架构开发实践 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1865">[1865]</a><a class="headerlink" href="#architectural-development-practices" title="永久链接至标题"></a></h2>
<p>本节描述了在对ROS 2进行重大架构更改时应采用的理想生命周期。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1866">[1866]</a></p>
<div class="section" id="software-development-lifecycle">
<h3>软件开发生命周期 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1867">[1867]</a><a class="headerlink" href="#software-development-lifecycle" title="永久链接至标题"></a></h3>
<p>本节逐步描述了如何规划、设计和实现一个新功能： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1868">[1868]</a></p>
<ol class="arabic simple">
<li><p>任务创建 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1869">[1869]</a></p></li>
<li><p>创建设计文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1870">[1870]</a></p></li>
<li><p>设计评审 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1871">[1871]</a></p></li>
<li><p>实现 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1872">[1872]</a></p></li>
<li><p>代码评审 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1873">[1873]</a></p></li>
</ol>
<div class="section" id="task-creation">
<h4>任务创建 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1874">[1874]</a><a class="headerlink" href="#task-creation" title="永久链接至标题"></a></h4>
<p>需要对ROS 2关键部分进行更改的任务应在发布周期的早期阶段进行设计审查。如果设计审查在后期阶段进行，则更改将成为未来发布的一部分。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1875">[1875]</a></p>
<ul class="simple">
<li><p>在适当的 <a class="reference external" href="https://github.com/ros2/">ros2 代码库</a> 中创建一个问题，清楚地描述正在进行的任务。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1876">[1876]</a></p>
<ul>
<li><p>它应具有明确的成功标准，并突出显示预期的具体改进。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1877">[1877]</a></p></li>
<li><p>如果该功能针对ROS版本，请确保在ROS版本票据中进行跟踪（<a class="reference external" href="https://github.com/ros2/ros2/issues/607">示例</a>）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1878">[1878]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="writing-the-design-document">
<h4>编写设计文档 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1879">[1879]</a><a class="headerlink" href="#writing-the-design-document" title="永久链接至标题"></a></h4>
<p>设计文档不得包含机密信息。是否需要为您的更改编写设计文档取决于任务的大小。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1880">[1880]</a></p>
<ol class="arabic simple">
<li><p>您正在进行小的更改或修复错误： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1881">[1881]</a></p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>不需要设计文档，但应在适当的存储库中打开一个问题来跟踪工作并避免重复努力。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1882">[1882]</a></p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>您正在实施新功能或希望为OSRF拥有的基础架构（如Jenkins CI）做贡献： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1883">[1883]</a></p></li>
</ol>
<blockquote>
<div><ul class="simple">
<li><p>需要设计文档，并应贡献给 <a class="reference external" href="https://github.com/ros2/design/">ros2/design</a>，以便在 <a class="reference external" href="https://design.ros2.org/">https://design.ros2.org/</a> 上访问。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1884">[1884]</a></p></li>
<li><p>您应该fork存储库并提交拉取请求，详细说明设计。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1885">[1885]</a></p></li>
</ul>
<p>在拉取请求或提交消息中提及相关的ros2问题（例如，<code class="docutils literal notranslate"><span class="pre">任务ros2/ros2#&lt;问题编号&gt;的设计文档</span></code>）。详细说明可在`ROS 2 Contribute &lt;<a class="reference external" href="https://design.ros2.org/contribute.html">https://design.ros2.org/contribute.html</a>&gt;`__页面找到。设计评论将直接在拉取请求上进行。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1886">[1886]</a></p>
</div></blockquote>
<p>如果任务计划在特定版本的ROS中发布，应在拉取请求中包含这些信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1887">[1887]</a></p>
</div>
<div class="section" id="design-document-review">
<h4>设计文档审查 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1888">[1888]</a><a class="headerlink" href="#design-document-review" title="永久链接至标题"></a></h4>
<p>一旦设计准备好进行审查，应打开拉取请求并指定适当的审阅者。建议将项目所有者（即所有受影响软件包的维护者，根据``package.xml``维护者字段定义，参见`REP-140 &lt;<a class="reference external" href="https://www.ros.org/reps/rep-0140.html#maintainer-multiple-but-at-least-one">https://www.ros.org/reps/rep-0140.html#maintainer-multiple-but-at-least-one</a>&gt;`__）作为审阅者。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1889">[1889]</a></p>
<ul>
<li><p>如果设计文档很复杂或者审阅人员的日程安排有冲突，可以设置一个可选的设计审查会议。在这种情况下， <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1890">[1890]</a></p>
<p><strong>会议之前</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1891">[1891]</a></p>
<ul class="simple">
<li><p>至少提前一周发送会议邀请 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1892">[1892]</a></p></li>
<li><p>建议会议持续一个小时 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1893">[1893]</a></p></li>
<li><p>会议邀请应列出审查期间需要做出的所有决策（需要包维护者批准的决策） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1894">[1894]</a></p></li>
<li><dl class="simple">
<dt>会议要求出席人员：设计拉取请求的审查人员 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1895">[1895]</a></dt><dd><p>会议可选出席人员：所有OSRF工程师，如果适用的话 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1896">[1896]</a></p>
</dd>
</dl>
</li>
</ul>
<p><strong>在会议期间</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1897">[1897]</a></p>
<ul class="simple">
<li><p>任务负责人主导会议，提出他们的想法，并管理讨论，以确保在规定时间内达成一致意见 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1898">[1898]</a></p></li>
</ul>
<p><strong>会议之后</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1899">[1899]</a></p>
<ul class="simple">
<li><p>任务负责人应该向所有与会者发送会议纪要 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1900">[1900]</a></p></li>
<li><p>如果有关设计的小问题被提出： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1901">[1901]</a></p>
<ul>
<li><p>任务所有者应根据反馈意见更新设计文档的拉取请求 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1902">[1902]</a></p></li>
<li><p>不需要额外的审查 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1903">[1903]</a></p></li>
</ul>
</li>
<li><p>如果有关设计方面的重大问题被提出： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1904">[1904]</a></p>
<ul>
<li><p>可以删除没有明确一致意见的部分，这是可以接受的 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1905">[1905]</a></p></li>
<li><p>设计中有争议的部分可以在未来作为一个独立任务重新提交 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1906">[1906]</a></p></li>
<li><p>如果无法移除有争议的部分，直接与包的所有者合作以达成一致 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1907">[1907]</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p>一旦达成共识： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1908">[1908]</a></p>
<ul class="simple">
<li><p>确保已合并`ros2/design &lt;<a class="reference external" href="https://github.com/ros2/design/">https://github.com/ros2/design/</a>&gt;`__的拉取请求（如果适用） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1909">[1909]</a></p></li>
<li><p>更新并关闭与此设计任务相关的 GitHub 问题 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1910">[1910]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="implementation">
<h4>实现 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1872">[1872]</a><a class="headerlink" href="#implementation" title="永久链接至标题"></a></h4>
<p>开始之前，请参阅 <a class="reference internal" href="#pull-requests">Pull requests</a> 部分以了解最佳实践。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1911">[1911]</a></p>
<ul class="simple">
<li><p>对于每个需要修改的存储库： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1912">[1912]</a></p>
<ul>
<li><p>修改代码，完成后或定期备份工作，然后进入下一步。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1913">[1913]</a></p></li>
<li><p><a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Interactive-Staging">使用``git add -i``进行自我审查</a>，并将更改添加到暂存区。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1914">[1914]</a></p></li>
<li><p>使用``git commit -s``创建一个新的带有签名的提交。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1915">[1915]</a></p>
<ul>
<li><p>一个拉取请求应该包含最少的语义化的有意义的提交（例如，大量的一行提交是不可接受的）。在反馈过程中创建新的修正提交，或者根据需要使用``git commit --amend``修正现有的提交，如果你不想每次都创建新的提交。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1916">[1916]</a></p></li>
<li><p>每个提交必须有适当编写的、有意义的提交消息。更多说明请查看 <a class="reference external" href="https://chris.beams.io/posts/git-commit/">这里</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1917">[1917]</a></p></li>
<li><p>将文件移动操作放在单独的提交中进行，否则 Git 可能无法准确跟踪文件的历史记录。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1918">[1918]</a></p></li>
<li><p>无论是拉取请求描述还是提交信息，都必须包含与相关 ros2 问题的引用，这样在合并拉取请求时会自动关闭它。有关更多详细信息，请参阅此 <a class="reference external" href="https://help.github.com/articles/closing-issues-using-keywords/">文档</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1919">[1919]</a></p></li>
<li><p>推送新的提交。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1920">[1920]</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="code-review">
<h4>代码审查。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1921">[1921]</a><a class="headerlink" href="#code-review" title="永久链接至标题"></a></h4>
<p>一旦修改准备好进行代码审查： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1922">[1922]</a></p>
<ul class="simple">
<li><p>为每个修改后的仓库打开一个拉取请求。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1923">[1923]</a></p>
<ul>
<li><p>记住遵循 <a class="reference internal" href="#pull-requests">拉取请求</a> 的最佳实践。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1924">[1924]</a></p></li>
<li><p><a class="reference external" href="https://hub.github.com/">GitHub</a> 可用于从命令行创建拉取请求。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1925">[1925]</a></p></li>
<li><p>如果任务计划在特定版本的ROS中发布，则应在每个拉取请求中包含此信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1926">[1926]</a></p></li>
</ul>
</li>
<li><p>应在拉取请求中提及已审查设计文档的包所有者。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1927">[1927]</a></p></li>
<li><p>代码审查SLO：尽管审查拉取请求是尽力而为的，但有助于评审人员在一周内对拉取请求发表评论，代码作者在一周内回复评论，以确保不会失去上下文。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1928">[1928]</a></p></li>
<li><p>按照通常的做法，根据反馈进行迭代，根据需要修改和更新开发分支。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1929">[1929]</a></p></li>
<li><p>一旦PR被批准，软件包维护人员将合并这些更改。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1930">[1930]</a></p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="build-farm-introduction">
<h2>构建农场介绍 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1931">[1931]</a><a class="headerlink" href="#build-farm-introduction" title="永久链接至标题"></a></h2>
<p>构建农场位于 <a class="reference external" href="https://ci.ros2.org/">ci.ros2.org</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1932">[1932]</a></p>
<p>每晚我们运行夜间任务，对各种场景和平台进行构建和运行所有测试。此外，在合并之前，我们还会将所有拉取请求与这些平台进行测试。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1933">[1933]</a></p>
<p>这是当前的目标平台和架构设置，尽管它会随时间变化而发展: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1934">[1934]</a></p>
<ul class="simple">
<li><p>Ubuntu 22.04 Jammy <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1935">[1935]</a></p>
<ul>
<li><p>amd64 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1936">[1936]</a></p></li>
<li><p>aarch64 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1937">[1937]</a></p></li>
</ul>
</li>
<li><p>Windows 10 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1938">[1938]</a></p>
<ul>
<li><p>amd64 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1936">[1936]</a></p></li>
</ul>
</li>
</ul>
<p>构建农场上有几类工作： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1939">[1939]</a></p>
<ul class="simple">
<li><p>手动工作（由开发人员手动触发）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1940">[1940]</a></p>
<ul>
<li><p>ci_linux：在Ubuntu Xenial上构建+测试代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1941">[1941]</a></p></li>
<li><p>ci_linux-aarch64：在ARM 64位机器（aarch64）上的Ubuntu Xenial上构建+测试代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1942">[1942]</a></p></li>
<li><p>ci_linux_coverage：构建 + 测试 + 生成测试覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1943">[1943]</a></p></li>
<li><p>ci_windows：在 Windows 10 上构建 + 测试代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1944">[1944]</a></p></li>
<li><p>ci_launcher：触发上述所有作业 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1945">[1945]</a></p></li>
</ul>
</li>
<li><p>每晚运行的夜间任务： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1946">[1946]</a></p>
<ul>
<li><p>调试：使用CMAKE_BUILD_TYPE=Debug构建和测试代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1947">[1947]</a></p>
<ul>
<li><p>每夜构建（Linux平台，调试模式） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1948">[1948]</a></p></li>
<li><p>每夜构建（Linux平台，aarch64架构，调试模式） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1949">[1949]</a></p></li>
<li><p>每夜构建（Windows平台，调试模式） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1950">[1950]</a></p></li>
</ul>
</li>
<li><p>发布：使用CMAKE_BUILD_TYPE=Release构建和测试代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1951">[1951]</a></p>
<ul>
<li><p>每夜构建：Linux平台 Release 版本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1952">[1952]</a></p></li>
<li><p>每夜构建：Linux（aarch64架构）平台 Release 版本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1953">[1953]</a></p></li>
<li><p>每夜构建：Windows平台 Release 版本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1954">[1954]</a></p></li>
</ul>
</li>
<li><p>重复执行：构建，然后运行每个测试最多20次或直到失败（也称为稳定性测试） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1955">[1955]</a></p>
<ul>
<li><p>每夜Linux重复执行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1956">[1956]</a></p></li>
<li><p>每夜Linux-aarch64重复执行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1957">[1957]</a></p></li>
<li><p>每夜Windows重复执行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1958">[1958]</a></p></li>
</ul>
</li>
<li><p>覆盖率： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1959">[1959]</a></p>
<ul>
<li><p>nightly_linux_coverage：构建 + 测试代码 + 分析 C/C++ 和 Python 的覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1960">[1960]</a></p>
<ul>
<li><p>结果以 Cobertura 报告的形式导出 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1961">[1961]</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>打包（每晚运行；结果打包成一个归档文件）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1962">[1962]</a></p>
<ul>
<li><p><a href="#id26"><span class="problematic" id="id27">打包_</span></a> Linux <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1963">[1963]</a></p></li>
<li><p><a href="#id28"><span class="problematic" id="id29">打包_</span></a> Windows <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1964">[1964]</a></p></li>
</ul>
</li>
</ul>
<p>通过提供源码和二进制包的构建、持续集成、测试和分析，另外两个构建农场支持 ROS / ROS 2 生态系统。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1965">[1965]</a></p>
<p>有关详细信息、常见问题和故障排除，请参阅：<a class="reference internal" href="Build-Farms.html"><span class="doc">构建农场</span></a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1966">[1966]</a></p>
<div class="section" id="note-on-coverage-runs">
<h3>覆盖率运行注意事项 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1967">[1967]</a><a class="headerlink" href="#note-on-coverage-runs" title="永久链接至标题"></a></h3>
<p>ROS 2软件包的组织方式是，给定软件包的测试代码不仅包含在该软件包内，还可以存在于其他软件包中。换句话说，在测试阶段，软件包可以执行属于其他软件包的代码。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1968">[1968]</a></p>
<p>为了达到ROS 2核心软件包中所有可用代码的覆盖率，建议使用一组固定的建议存储库运行构建。该集合在Jenkins中的覆盖率作业的默认参数中定义。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1969">[1969]</a></p>
</div>
<div class="section" id="how-to-read-the-coverage-rate-from-the-buildfarm-report">
<span id="read-coverage-report"></span><h3>如何从构建工厂报告中读取覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1970">[1970]</a><a class="headerlink" href="#how-to-read-the-coverage-rate-from-the-buildfarm-report" title="永久链接至标题"></a></h3>
<p>查看给定包的覆盖率报告： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1971">[1971]</a></p>
<ul class="simple">
<li><p>当``ci_linux_coverage``构建完成后，点击``Coverage Report`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1972">[1972]</a></p></li>
<li><p>向下滚动到``Coverage Breakdown by Package``表格 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1973">[1973]</a></p></li>
<li><p>在表格中，查看名为&quot;Name&quot;的第一列 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1974">[1974]</a></p></li>
</ul>
<p>构建工厂中的覆盖率报告包括在ROS工作空间中使用的所有软件包。覆盖率报告包括与同一软件包对应的不同路径： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1975">[1975]</a></p>
<ul class="simple">
<li><p>以以下形式的名称条目: <code class="docutils literal notranslate"><span class="pre">src.*.&lt;repository_name&gt;.&lt;package_name&gt;.*</span></code>。这些对应于针对软件包自身源代码的单元测试运行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1976">[1976]</a></p></li>
<li><p>以以下形式的名称条目: <code class="docutils literal notranslate"><span class="pre">build.&lt;repository_name&gt;.&lt;package_name&gt;.*</span></code>。这些对应于针对构建或配置时生成的文件的软件包的单元测试运行 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1977">[1977]</a></p></li>
<li><p>以以下形式的名称条目: <code class="docutils literal notranslate"><span class="pre">install.&lt;package_name&gt;.*</span></code>。这些对应于来自其他软件包的测试运行的系统/集成测试 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1978">[1978]</a></p></li>
</ul>
</div>
<div class="section" id="how-to-calculate-the-coverage-rate-from-the-buildfarm-report">
<span id="calculate-coverage-rate"></span><h3>如何从构建农场报告中计算覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1979">[1979]</a><a class="headerlink" href="#how-to-calculate-the-coverage-rate-from-the-buildfarm-report" title="永久链接至标题"></a></h3>
<p>使用自动脚本获取组合单元覆盖率： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1980">[1980]</a></p>
<blockquote>
<div><ul class="simple">
<li><p>从ci_linux_coverage Jenkins构建中复制构建的URL <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1981">[1981]</a></p></li>
<li><p>下载 <a class="reference external" href="https://raw.githubusercontent.com/ros2/ci/master/tools/get_coverage_ros2_pkg.py">get_coverage_ros2_pkg</a> 脚本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1982">[1982]</a></p></li>
<li><p>执行脚本：<a href="#id1"><span class="problematic" id="id2">``</span></a>./get_coverage_ros2_pkg.py &lt;jenkins_build_url&gt; &lt;ros2_package_name&gt;``（<a class="reference external" href="https://github.com/ros2/ci/blob/master/tools/README.md">README</a>） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1983">[1983]</a></p></li>
<li><p>从脚本输出的&quot;Combined unit testing&quot;最后一行中获取结果 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1984">[1984]</a></p></li>
</ul>
</div></blockquote>
<p>替代方法：从覆盖率报告中获取组合单元覆盖率（需要手动计算）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1985">[1985]</a></p>
<ul class="simple">
<li><p>当ci_linux_coverage构建完成后，点击``Cobertura Coverage Report`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1986">[1986]</a></p></li>
<li><p>向下滚动到``Coverage Breakdown by Package``表格 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1973">[1973]</a></p></li>
<li><p>在表格中，查找第一列“Name”下的内容（其中&lt;package_name&gt;是您正在测试的软件包）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1987">[1987]</a></p>
<ul>
<li><p>在模式“src.*.&lt;repository_name&gt;.&lt;package_name&gt;.*”下的所有目录中，获取列“Lines”中的两个绝对值。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1988">[1988]</a></p></li>
<li><p>在模式“build/.&lt;repository_name&gt;.*”下的所有目录中，获取列“Lines”中的两个绝对值。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1989">[1989]</a></p></li>
</ul>
</li>
<li><p>使用上述选择：对于每个单元格，第一个值是测试的行数，第二个值是代码总行数。汇总所有行以获得测试的行数总和和正在测试的代码行数总和。进行除法运算以获取覆盖率。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1990">[1990]</a></p></li>
</ul>
</div>
<div class="section" id="how-to-measure-coverage-locally-using-lcov-ubuntu">
<span id="measure-coverage-locally"></span><h3>如何使用 lcov（Ubuntu）在本地测量覆盖率 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1991">[1991]</a><a class="headerlink" href="#how-to-measure-coverage-locally-using-lcov-ubuntu" title="永久链接至标题"></a></h3>
<p>要在自己的机器上测量覆盖率，请安装``lcov``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1992">[1992]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install -y lcov
</pre></div>
</div>
<p>本节的其余部分假设您正在使用自己的 colcon 工作空间。使用覆盖率标志进行调试编译。可以使用 colcon 标志来针对特定的软件包。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1993">[1993]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>colcon build --cmake-args -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug -DCMAKE_CXX_FLAGS<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CMAKE_CXX_FLAGS</span><span class="si">}</span><span class="s2"> --coverage&quot;</span> -DCMAKE_C_FLAGS<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CMAKE_C_FLAGS</span><span class="si">}</span><span class="s2"> --coverage&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lcov</span></code> 需要一个初始基准，您可以使用以下命令生成。根据您的需要更新输出文件位置。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1994">[1994]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lcov --no-external --capture --initial --directory . --output-file ~/ros2_base.info
</pre></div>
</div>
<p>运行测试以获得与覆盖率测量相关的软件包。例如，如果同时测量``rclcpp``和``test_rclcpp`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1995">[1995]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>colcon <span class="nb">test</span> --packages-select rclcpp test_rclcpp
</pre></div>
</div>
<p>使用类似的命令捕获 lcov 结果，但这次不使用``--initial``标志。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1996">[1996]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lcov --no-external --capture --directory . --output-file ~/ros2.info
</pre></div>
</div>
<p>合并追踪的 .info 文件： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1997">[1997]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lcov --add-tracefile ~/ros2_base.info --add-tracefile ~/ros2.info --output-file ~/ros2_coverage.info
</pre></div>
</div>
<p>生成 HTML，以便轻松可视化和标注覆盖的代码行。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1998">[1998]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir -p coverage
genhtml ~/ros2_coverage.info --output-directory coverage
</pre></div>
</div>
</div>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>