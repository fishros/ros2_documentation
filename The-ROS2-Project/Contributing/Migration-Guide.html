<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>The-ROS2-Project/Contributing/Migration-Guide</title>
</head>
<body>
  <div class="section" id="migration-guide-from-ros-1">
<h1>从ROS 1迁移指南 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1999">[1999]</a><a class="headerlink" href="#migration-guide-from-ros-1" title="永久链接至标题"></a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">目录 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1329">[]</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#prerequisites" id="id1">先决条件 [2004]</a></p></li>
<li><p><a class="reference internal" href="#migration-steps" id="id2">迁移步骤 [2006]</a></p>
<ul>
<li><p><a class="reference internal" href="#package-manifests" id="id3">软件包清单 [2007]</a></p></li>
<li><p><a class="reference internal" href="#metapackages" id="id4">元软件包 [2010]</a></p></li>
<li><p><a class="reference internal" href="#message-service-and-action-definitions" id="id5">消息、服务和动作定义 [2012]</a></p></li>
<li><p><a class="reference internal" href="#build-system" id="id6">构建系统 [2024]</a></p></li>
<li><p><a class="reference internal" href="#update-source-code" id="id7">更新源代码 [2071]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#parameters" id="id8">参数 [2113]</a></p></li>
<li><p><a class="reference internal" href="#launch-files" id="id9">启动文件 [2118]</a></p></li>
<li><p><a class="reference internal" href="#example-converting-an-existing-ros-1-package-to-use-ros-2" id="id10">示例：将现有的ROS 1包转换为使用ROS 2 [2120]</a></p>
<ul>
<li><p><a class="reference internal" href="#the-ros-1-code" id="id11">ROS 1代码 [2122]</a></p></li>
<li><p><a class="reference internal" href="#migrating-to-ros-2" id="id12">迁移到ROS 2 [2133]</a></p></li>
<li><p><a class="reference internal" href="#update-scripts" id="id13">更新脚本 [2181]</a></p></li>
<li><p><a class="reference internal" href="#more-examples-and-tools" id="id14">更多示例和工具 [2211]</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#licensing" id="id15">许可 [2214]</a></p>
<ul>
<li><p><a class="reference internal" href="#changing-the-license" id="id16">更改许可证 [2220]</a></p></li>
</ul>
</li>
</ul>
</div>
<p>有两种不同类型的包迁移： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2000">[2000]</a></p>
<ul class="simple">
<li><p>将现有包的源代码从ROS 1迁移到ROS 2，并且意图是源代码的大部分保持相同或至少相似。一个例子是`pluginlib &lt;<a class="reference external" href="https://github.com/ros/pluginlib">https://github.com/ros/pluginlib</a>&gt;`_，其中源代码在同一存储库的不同分支中维护，常见的补丁可以在需要时在这些分支之间移植。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2001">[2001]</a></p></li>
<li><p>为ROS 2实现与ROS 1包相同或相似的功能，但假设源代码将有显着差异。一个例子是ROS 1中的`roscpp &lt;<a class="reference external" href="https://github.com/ros/ros_comm/tree/melodic-devel/clients/roscpp">https://github.com/ros/ros_comm/tree/melodic-devel/clients/roscpp</a>&gt;`_和ROS 2中的`rclcpp &lt;<a class="reference external" href="https://github.com/ros2/rclcpp/tree/rolling/rclcpp">https://github.com/ros2/rclcpp/tree/rolling/rclcpp</a>&gt;`_，它们是单独的存储库，不共享任何代码。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2002">[2002]</a></p></li>
</ul>
<p>本文重点介绍前一种情况，并描述了将ROS 1软件包迁移到ROS 2的高级步骤。它不旨在成为逐步迁移指南，并不被视为“最终”解决方案。未来的版本将旨在使迁移过程更加顺利，并减少维护ROS 1和ROS 2相同分支上的单个软件包所需的工作量。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2003">[2003]</a></p>
<div class="section" id="prerequisites">
<h2>先决条件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2004">[2004]</a><a class="headerlink" href="#prerequisites" title="永久链接至标题"></a></h2>
<p>在将ROS 1软件包迁移到ROS 2之前，必须在ROS 2中提供所有依赖项。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2005">[2005]</a></p>
</div>
<div class="section" id="migration-steps">
<h2>迁移步骤 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2006">[2006]</a><a class="headerlink" href="#migration-steps" title="永久链接至标题"></a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#package-manifests" id="id17">软件包清单 [2007]</a></p></li>
<li><p><a class="reference internal" href="#metapackages" id="id18">元软件包 [2010]</a></p></li>
<li><p><a class="reference internal" href="#message-service-and-action-definitions" id="id19">消息、服务和动作定义 [2012]</a></p></li>
<li><p><a class="reference internal" href="#build-system" id="id20">构建系统 [2024]</a></p></li>
<li><p><a class="reference internal" href="#update-source-code" id="id21">更新源代码 [2071]</a></p></li>
</ul>
</div>
<div class="section" id="package-manifests">
<h3>软件包清单 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2007">[2007]</a><a class="headerlink" href="#package-manifests" title="永久链接至标题"></a></h3>
<p>ROS 2不支持软件包规范的格式1，而仅支持更新的格式版本（2及更高）。因此，如果软件包使用格式1，则必须将``package.xml``文件更新至至少格式2。由于ROS 1支持所有格式，因此在ROS 1软件包中执行此转换是安全的。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2008">[2008]</a></p>
<p>在ROS 2中，某些软件包的名称可能不同，因此需要相应地更新依赖关系。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2009">[2009]</a></p>
</div>
<div class="section" id="metapackages">
<h3>元软件包 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2010">[2010]</a><a class="headerlink" href="#metapackages" title="永久链接至标题"></a></h3>
<p>ROS 2没有针对元包的特殊软件包类型。元包仍然可以作为仅包含运行时依赖项的常规软件包存在。在从ROS 1迁移元包时，只需在软件包清单中删除``&lt;metapackage /&gt;``标签。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2011">[2011]</a></p>
</div>
<div class="section" id="message-service-and-action-definitions">
<h3>消息、服务和动作定义 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2012">[2012]</a><a class="headerlink" href="#message-service-and-action-definitions" title="永久链接至标题"></a></h3>
<p>消息文件必须以``.msg``结尾，并且必须位于子文件夹``msg``中。服务文件必须以``.srv``结尾，并且必须位于子文件夹``srv``中。动作文件必须以``.action``结尾，并且必须位于子文件夹``action``中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2013">[2013]</a></p>
<p>这些文件可能需要更新以符合`ROS接口定义&lt;<a class="reference external" href="https://design.ros2.org/articles/interface_definition.html">https://design.ros2.org/articles/interface_definition.html</a>&gt;`__。一些原始类型已被删除，ROS 1中的``duration``和``time``类型已被替换为普通消息定义，并且必须从`builtin_interfaces &lt;<a class="reference external" href="https://github.com/ros2/rcl_interfaces/tree/humble/builtin_interfaces">https://github.com/ros2/rcl_interfaces/tree/humble/builtin_interfaces</a>&gt;`__软件包中使用。此外，一些命名约定比ROS 1更严格。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2014">[2014]</a></p>
<p>在你的 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 中: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2015">[2015]</a></p>
<ul class="simple">
<li><p>添加 <code class="docutils literal notranslate"><span class="pre">&lt;buildtool_depend&gt;rosidl_default_generators&lt;/buildtool_depend&gt;</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2016">[2016]</a></p></li>
<li><p>添加 <code class="docutils literal notranslate"><span class="pre">&lt;exec_depend&gt;rosidl_default_runtime&lt;/exec_depend&gt;</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2017">[2017]</a></p></li>
<li><p>对于每个依赖的消息包，添加 <code class="docutils literal notranslate"><span class="pre">&lt;depend&gt;message_package&lt;/depend&gt;</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2018">[2018]</a></p></li>
</ul>
<p>在你的 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 中： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2019">[2019]</a></p>
<ul class="simple">
<li><p>首先启用 C++14 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2020">[2020]</a></p></li>
</ul>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>添加 <code class="docutils literal notranslate"><span class="pre">find_package(rosidl_default_generators</span> <span class="pre">REQUIRED)</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2021">[2021]</a></p></li>
<li><p>对于每个依赖的消息包，添加 <code class="docutils literal notranslate"><span class="pre">find_package(message_package</span> <span class="pre">REQUIRED)</span></code>，并将 CMake 函数调用 <code class="docutils literal notranslate"><span class="pre">generate_messages</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">rosidl_generate_interfaces</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2022">[2022]</a></p></li>
</ul>
<p>这将替代所有消息和服务文件的``add_message_files``和``add_service_files``列表，可以将它们删除。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2023">[2023]</a></p>
</div>
<div class="section" id="build-system">
<h3>构建系统 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2024">[2024]</a><a class="headerlink" href="#build-system" title="永久链接至标题"></a></h3>
<p>ROS 2中的构建系统称为`ament &lt;<a class="reference external" href="https://design.ros2.org/articles/ament.html">https://design.ros2.org/articles/ament.html</a>&gt;`__，构建工具是:doc:<a class="reference internal" href="../../Tutorials/Beginner-Client-Libraries/Colcon-Tutorial.html"><span class="doc">colcon</span></a>。Ament基于CMake构建：<a href="#id1"><span class="problematic" id="id2">``</span></a>ament_cmake``提供了简化编写``CMakeLists.txt``文件的CMake函数。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2025">[2025]</a></p>
<div class="section" id="build-tool">
<h4>构建工具 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2026">[2026]</a><a class="headerlink" href="#build-tool" title="永久链接至标题"></a></h4>
<p>与使用``catkin_make``、<a href="#id1"><span class="problematic" id="id2">``</span></a>catkin_make_isolated``或``catkin build``不同，ROS 2使用命令行工具 <a class="reference external" href="https://design.ros2.org/articles/build_tool.html">colcon</a> 来构建和安装一组软件包。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2027">[2027]</a></p>
</div>
<div class="section" id="pure-python-package">
<h4>纯Python软件包 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2028">[2028]</a><a class="headerlink" href="#pure-python-package" title="永久链接至标题"></a></h4>
<p>如果ROS 1软件包仅使用CMake来调用``setup.py``文件，并且除了Python代码之外不包含任何其他内容（例如，也没有消息、服务等），则应将其转换为ROS 2的纯Python软件包： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2029">[2029]</a></p>
<ul>
<li><p>更新或在``package.xml``文件中添加构建类型： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2030">[2030]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
  <span class="nt">&lt;build_type&gt;</span>ament_python<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
</li>
<li><p>移除 <code class="xref any docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2031">[2031]</a></p></li>
<li><p>将 <code class="xref any docutils literal notranslate"><span class="pre">setup.py</span></code> 文件更新为标准的 Python 设置脚本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2032">[2032]</a></p></li>
</ul>
<p>ROS 2 仅支持 Python 3。虽然每个软件包可以选择支持 Python 2，但如果它使用其他 ROS 2 软件包提供的任何 API，则必须使用 Python 3 调用可执行文件。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2033">[2033]</a></p>
</div>
<div class="section" id="update-the-cmakelists-txt-to-use-ament-cmake">
<h4>更新 <em>CMakeLists.txt</em> 使用 <em>ament_cmake</em> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2034">[2034]</a><a class="headerlink" href="#update-the-cmakelists-txt-to-use-ament-cmake" title="永久链接至标题"></a></h4>
<p>将以下更改应用于使用``ament_cmake``而不是``catkin``： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2035">[2035]</a></p>
<ul>
<li><p>在``package.xml``文件的导出部分中设置构建类型： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2036">[2036]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
  <span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
</li>
<li><p>将``find_package``调用替换为``catkin``，<a href="#id1"><span class="problematic" id="id2">``</span></a>COMPONENTS``改为： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2037">[2037]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">component1</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c"># ...</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">componentN</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>移动并更新``catkin_package``调用为： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2038">[2038]</a></p>
<ul class="simple">
<li><p>请改为调用``ament_package``，但是要在所有目标都注册之后调用。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2039">[2039]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ament_package``的唯一有效参数是``CONFIG_EXTRAS</span></code>。所有其他参数都由单独的函数处理，这些函数都需要在``ament_package``之前调用： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2040">[2040]</a></p>
<ul>
<li><p>不要使用``CATKIN_DEPENDS ...``，而是在之前调用``ament_export_dependencies(...)``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2041">[2041]</a></p></li>
<li><p>不要使用``INCLUDE_DIRS ...``，而是在之前调用``ament_export_include_directories(...)``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2042">[2042]</a></p></li>
<li><p>在调用``LIBRARIES ...``之前，请使用``ament_export_libraries(...)``进行传递。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2043">[2043]</a></p></li>
</ul>
</li>
<li><p><strong>TODO 文档化 ament_export_targets（在 Eloquent 和更早的版本中为 ``ament_export_interfaces``）?</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2044">[2044]</a></p></li>
</ul>
</li>
<li><p>将``add_message_files``、<a href="#id1"><span class="problematic" id="id2">``</span></a>add_service_files``和``generate_messages``的调用替换为`rosidl_generate_interfaces &lt;<a class="reference external" href="https://github.com/ros2/rosidl/blob/humble/rosidl_cmake/cmake/rosidl_generate_interfaces.cmake">https://github.com/ros2/rosidl/blob/humble/rosidl_cmake/cmake/rosidl_generate_interfaces.cmake</a>&gt;`__。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2045">[2045]</a></p>
<ul>
<li><p>第一个参数是``target_name``。如果你只构建一个库，那么它是``${PROJECT_NAME}``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2046">[2046]</a></p></li>
<li><p>接着是相对于软件包根目录的消息文件名列表。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2047">[2047]</a></p>
<ul class="simple">
<li><p>如果您将多次使用文件名列表，则建议为清晰起见编写一个消息文件列表，并将其传递给函数。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2048">[2048]</a></p></li>
</ul>
</li>
<li><p>最后一个多值关键字参数是``generate_messages``的``DEPENDENCIES``，需要依赖消息软件包的列表。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2049">[2049]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">rosidl_generate_interfaces</span><span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span>
<span class="w">  </span><span class="o">${</span><span class="nv">msg_files</span><span class="o">}</span>
<span class="w">  </span><span class="s">DEPENDENCIES</span><span class="w"> </span><span class="s">std_msgs</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>删除所有*devel空间*的出现。相关的CMake变量，如``CATKIN_DEVEL_PREFIX``，已不再存在。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2050">[2050]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_DEPENDS</span></code> 和 <code class="docutils literal notranslate"><span class="pre">DEPENDS</span></code> 参数被传递给新的函数 <a class="reference external" href="https://github.com/ament/ament_cmake/blob/humble/ament_cmake_export_dependencies/cmake/ament_export_dependencies.cmake">ament_export_dependencies</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2051">[2051]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_BIN_DESTINATION</span></code>: <code class="docutils literal notranslate"><span class="pre">bin</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2052">[2052]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_INCLUDE_DESTINATION</span></code>: <code class="docutils literal notranslate"><span class="pre">include</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2053">[2053]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_LIB_DESTINATION</span></code>: <code class="docutils literal notranslate"><span class="pre">lib</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2054">[2054]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_LIBEXEC_DESTINATION</span></code>：<code class="docutils literal notranslate"><span class="pre">lib</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2055">[2055]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_GLOBAL_SHARE_DESTINATION</span></code>：<code class="docutils literal notranslate"><span class="pre">share</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2056">[2056]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_BIN_DESTINATION</span></code>：<code class="docutils literal notranslate"><span class="pre">lib/${PROJECT_NAME}</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2057">[2057]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_INCLUDE_DESTINATION</span></code>：<code class="docutils literal notranslate"><span class="pre">include/${PROJECT_NAME}</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2058">[2058]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_LIB_DESTINATION</span></code>: <code class="docutils literal notranslate"><span class="pre">lib</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2059">[2059]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CATKIN_PACKAGE_SHARE_DESTINATION</span></code>: <code class="docutils literal notranslate"><span class="pre">share/${PROJECT_NAME}</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2060">[2060]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="unit-tests">
<h4>单元测试 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2061">[2061]</a><a class="headerlink" href="#unit-tests" title="永久链接至标题"></a></h4>
<p>如果您正在使用 gtest: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2062">[2062]</a></p>
<p>将 <code class="docutils literal notranslate"><span class="pre">CATKIN_ENABLE_TESTING</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">BUILD_TESTING</span></code>。将 <code class="docutils literal notranslate"><span class="pre">catkin_add_gtest</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">ament_add_gtest</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2063">[2063]</a></p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">-   if (CATKIN_ENABLE_TESTING)</span><span class="w"></span>
<span class="gd">-     find_package(GTest REQUIRED)  # or rostest</span><span class="w"></span>
<span class="gd">-     include_directories(${GTEST_INCLUDE_DIRS})</span><span class="w"></span>
<span class="gd">-     catkin_add_gtest(${PROJECT_NAME}-some-test src/test/some_test.cpp)</span><span class="w"></span>
<span class="gd">-     target_link_libraries(${PROJECT_NAME}-some-test</span><span class="w"></span>
<span class="gd">-       ${PROJECT_NAME}_some_dependency</span><span class="w"></span>
<span class="gd">-       ${catkin_LIBRARIES}</span><span class="w"></span>
<span class="gd">-       ${GTEST_LIBRARIES})</span><span class="w"></span>
<span class="gd">-   endif()</span><span class="w"></span>
<span class="gi">+   if (BUILD_TESTING)</span><span class="w"></span>
<span class="gi">+     find_package(ament_cmake_gtest REQUIRED)</span><span class="w"></span>
<span class="gi">+     ament_add_gtest(${PROJECT_NAME}-some-test src/test/test_something.cpp)</span><span class="w"></span>
<span class="gi">+     ament_target_dependencies(${PROJECT_NAME)-some-test</span><span class="w"></span>
<span class="gi">+       &quot;rclcpp&quot;</span><span class="w"></span>
<span class="gi">+       &quot;std_msgs&quot;)</span><span class="w"></span>
<span class="gi">+     target_link_libraries(${PROJECT_NAME}-some-test</span><span class="w"></span>
<span class="gi">+       ${PROJECT_NAME}_some_dependency)</span><span class="w"></span>
<span class="gi">+   endif()</span><span class="w"></span>
</pre></div>
</div>
<p>在你的 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 中添加 <code class="docutils literal notranslate"><span class="pre">&lt;test_depend&gt;ament_cmake_gtest&lt;/test_depend&gt;</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2064">[2064]</a></p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">-   &lt;test_depend&gt;rostest&lt;/test_depend&gt;</span><span class="w"></span>
<span class="gi">+   &lt;test_depend&gt;ament_cmake_gtest&lt;/test_depend&gt;</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="linters">
<h4>代码检查工具 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1512">[1512]</a><a class="headerlink" href="#linters" title="永久链接至标题"></a></h4>
<p>在ROS 2中，我们致力于使用代码检查工具来保持代码的整洁。不同语言的代码风格定义在我们的 <a class="reference internal" href="Developer-Guide.html"><span class="doc">开发人员指南</span></a> 中。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2065">[2065]</a></p>
<p>如果你从头开始一个项目，建议遵循代码风格指南，并通过在 <code class="docutils literal notranslate"><span class="pre">if(BUILD_TESTING)</span></code> 下面添加以下代码来启用自动代码检查单元测试（在alpha 5之前为 <code class="docutils literal notranslate"><span class="pre">AMENT_ENABLE_TESTING</span></code>）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2066">[2066]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">ament_lint_auto</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">ament_lint_auto_find_test_dependencies</span><span class="p">()</span>
</pre></div>
</div>
<p>您还需要将以下依赖项添加到您的 <code class="docutils literal notranslate"><span class="pre">package.xml</span></code> 文件中： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2067">[2067]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;test_depend&gt;</span>ament_lint_auto<span class="nt">&lt;/test_depend&gt;</span>
<span class="nt">&lt;test_depend&gt;</span>ament_lint_common<span class="nt">&lt;/test_depend&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="continue-to-use-catkin-in-cmake">
<h4>继续在 CMake 中使用 <code class="docutils literal notranslate"><span class="pre">catkin</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2068">[2068]</a><a class="headerlink" href="#continue-to-use-catkin-in-cmake" title="永久链接至标题"></a></h4>
<p>ROS 2 使用 ament 作为构建系统，但为了向后兼容，ROS 2 有一个名为 <code class="docutils literal notranslate"><span class="pre">catkin</span></code> 的包，它提供了与 ROS 1 中的 catkin 几乎相同的 API。为了使用此向后兼容 API，<code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 文件必须在所有目标之后 <em>仅</em> 更新为调用函数 <code class="docutils literal notranslate"><span class="pre">catkin_ament_package()</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2069">[2069]</a></p>
<p><strong>注意：目前尚未实施此功能，目前仅为想法。由于与依赖项相关的更改数量较多，尚未确定此兼容性 API 是否足够有用以证明付出努力的价值。</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2070">[2070]</a></p>
</div>
</div>
<div class="section" id="update-source-code">
<h3>更新源代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2071">[2071]</a><a class="headerlink" href="#update-source-code" title="永久链接至标题"></a></h3>
<div class="section" id="messages-services-and-actions">
<h4>消息、服务和动作 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2072">[2072]</a><a class="headerlink" href="#messages-services-and-actions" title="永久链接至标题"></a></h4>
<p>ROS 2的消息、服务和动作的命名空间在包名后使用子命名空间（分别是``msg``、<code class="docutils literal notranslate"><span class="pre">srv``或``action</span></code>）。因此，一个包含语句的形式如下：<code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;my_interfaces/msg/my_message.hpp&gt;</span></code>。C++类型的命名为：<code class="docutils literal notranslate"><span class="pre">my_interfaces::msg::MyMessage</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2073">[2073]</a></p>
<p>共享指针类型在消息结构体中作为typedef提供：<code class="docutils literal notranslate"><span class="pre">my_interfaces::msg::MyMessage::SharedPtr``以及``my_interfaces::msg::MyMessage::ConstSharedPtr</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2074">[2074]</a></p>
<p>更多详细信息请参阅有关`生成的C++接口 &lt;<a class="reference external" href="https://design.ros2.org/articles/generated_interfaces_cpp.html">https://design.ros2.org/articles/generated_interfaces_cpp.html</a>&gt;`__的文章。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2075">[2075]</a></p>
<p>迁移需要通过以下方式更改包含： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2076">[2076]</a></p>
<ul class="simple">
<li><p>在包名称和消息数据类型之间插入子文件夹``msg`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2077">[2077]</a></p></li>
<li><p>将包含的文件名从驼峰式更改为下划线分隔 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2078">[2078]</a></p></li>
<li><p>将``*.h``更改为``*.hpp`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2079">[2079]</a></p></li>
</ul>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ROS 1 style is in comments, ROS 2 follows, uncommented.</span>
<span class="c1">// # include &lt;geometry_msgs/PointStamped.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;geometry_msgs/msg/point_stamped.hpp&gt;</span><span class="cp"></span>

<span class="c1">// geometry_msgs::PointStamped point_stamped;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">PointStamped</span><span class="w"> </span><span class="n">point_stamped</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>迁移需要在所有实例中插入``msg``命名空间的代码。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2080">[2080]</a></p>
</div>
<div class="section" id="use-of-service-objects">
<h4>使用服务对象 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2081">[2081]</a><a class="headerlink" href="#use-of-service-objects" title="永久链接至标题"></a></h4>
<p>ROS 2中的服务回调函数不具有布尔返回值。建议在失败时抛出异常，而不是返回false。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2082">[2082]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// ROS 1 style is in comments, ROS 2 follows, uncommented.</span>
<span class="c1">// #include &quot;nav_msgs/GetMap.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;nav_msgs/srv/get_map.hpp&quot;</span><span class="cp"></span>

<span class="c1">// bool service_callback(</span>
<span class="c1">//   nav_msgs::GetMap::Request &amp; request,</span>
<span class="c1">//   nav_msgs::GetMap::Response &amp; response)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">service_callback</span><span class="p">(</span><span class="w"></span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">nav_msgs</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">GetMap</span><span class="o">::</span><span class="n">Request</span><span class="o">&gt;</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">nav_msgs</span><span class="o">::</span><span class="n">srv</span><span class="o">::</span><span class="n">GetMap</span><span class="o">::</span><span class="n">Response</span><span class="o">&gt;</span><span class="w"> </span><span class="n">response</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">// ...</span>
<span class="w">  </span><span class="c1">// return true;  // or false for failure</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="usages-of-ros-time">
<h4>ros::Time的用法 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2083">[2083]</a><a class="headerlink" href="#usages-of-ros-time" title="永久链接至标题"></a></h4>
<p>关于``ros::Time``的用法： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2084">[2084]</a></p>
<ul class="simple">
<li><p>将所有``ros::Time``的实例替换为``rclcpp::Time`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2085">[2085]</a></p></li>
<li><p>如果您的消息或代码使用了std_msgs::Time： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2086">[2086]</a></p>
<ul>
<li><p>将所有的std_msgs::Time实例转换为builtin_interfaces::msg::Time <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2087">[2087]</a></p></li>
<li><p>将所有的#include &quot;std_msgs/time.h&quot;转换为#include &quot;builtin_interfaces/msg/time.hpp&quot; <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2088">[2088]</a></p></li>
<li><p>将所有使用std_msgs::Time字段``nsec``的实例转换为builtin_interfaces::msg::Time字段``nanosec`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2089">[2089]</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="usages-of-ros-rate">
<h4>ros::Rate的用法 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2090">[2090]</a><a class="headerlink" href="#usages-of-ros-rate" title="永久链接至标题"></a></h4>
<p>有一个等效的类型 <code class="docutils literal notranslate"><span class="pre">rclcpp::Rate</span></code> 对象，基本上可以替换 <code class="docutils literal notranslate"><span class="pre">ros::Rate</span></code>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2091">[2091]</a></p>
</div>
<div class="section" id="ros-client-library">
<h4>ROS 客户端库 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2092">[2092]</a><a class="headerlink" href="#ros-client-library" title="永久链接至标题"></a></h4>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="Migration-Guide-Python.html">ROS 1的Python迁移指南 [2222]</a></li>
</ul>
</div>
<p><strong>注意：其他待编写</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2093">[2093]</a></p>
</div>
<div class="section" id="boost">
<h4>Boost <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=1480">[1480]</a><a class="headerlink" href="#boost" title="永久链接至标题"></a></h4>
<p>之前由 Boost 提供的许多功能已经集成到 C++ 标准库中。因此，我们希望尽可能利用新的核心功能，并避免对 Boost 的依赖。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2094">[2094]</a></p>
<div class="section" id="shared-pointers">
<h5>共享指针 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2095">[2095]</a><a class="headerlink" href="#shared-pointers" title="永久链接至标题"></a></h5>
<p>将共享指针从 boost 转换为标准 C++，请替换以下实例： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2096">[2096]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/shared_ptr.hpp&gt;</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;memory&gt;</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2097">[2097]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::shared_ptr</span></code> 替换为 <code class="docutils literal notranslate"><span class="pre">std::shared_ptr</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2098">[2098]</a></p></li>
</ul>
<p>还可能存在诸如 <code class="docutils literal notranslate"><span class="pre">weak_ptr</span></code> 的变体，您也希望进行转换。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2099">[2099]</a></p>
<p>此外，建议使用 <code class="docutils literal notranslate"><span class="pre">using</span></code> 而不是 <code class="docutils literal notranslate"><span class="pre">typedef</span></code>。<code class="docutils literal notranslate"><span class="pre">using</span></code> 在模板逻辑中能够更好地发挥作用。有关详细信息，请参阅 <a class="reference external" href="https://stackoverflow.com/questions/10747810/what-is-the-difference-between-typedef-and-using-in-c11">这里</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2100">[2100]</a></p>
</div>
<div class="section" id="thread-mutexes">
<h5>线程/互斥锁 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2101">[2101]</a><a class="headerlink" href="#thread-mutexes" title="永久链接至标题"></a></h5>
<p>在ROS代码库中，<code class="docutils literal notranslate"><span class="pre">boost::thread</span></code> 中的互斥锁是另一个常见的boost部分。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2102">[2102]</a></p>
<ul class="simple">
<li><p>将``boost::mutex::scoped_lock``替换为``std::unique_lock&lt;std::mutex&gt;`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2103">[2103]</a></p></li>
<li><p>将``boost::mutex``替换为``std::mutex`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2104">[2104]</a></p></li>
<li><p>将``#include &lt;boost/thread/mutex.hpp&gt;``替换为``#include &lt;mutex&gt;`` <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2105">[2105]</a></p></li>
</ul>
</div>
<div class="section" id="unordered-map">
<h5>无序映射 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2106">[2106]</a><a class="headerlink" href="#unordered-map" title="永久链接至标题"></a></h5>
<p>替换: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2107">[2107]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/unordered_map.hpp&gt;</span></code> 为 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;unordered_map&gt;</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2108">[2108]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::unordered_map</span></code> 为 <code class="docutils literal notranslate"><span class="pre">std::unordered_map</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2109">[2109]</a></p></li>
</ul>
</div>
<div class="section" id="function">
<h5>函数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2110">[2110]</a><a class="headerlink" href="#function" title="永久链接至标题"></a></h5>
<p>替换: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2107">[2107]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;boost/function.hpp&gt;</span></code> 与 <code class="docutils literal notranslate"><span class="pre">#include</span> <span class="pre">&lt;functional&gt;</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2111">[2111]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boost::function</span></code> 与 <code class="docutils literal notranslate"><span class="pre">std::function</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2112">[2112]</a></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="parameters">
<h2>参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2113">[2113]</a><a class="headerlink" href="#parameters" title="永久链接至标题"></a></h2>
<p>在ROS 1中，参数与一个中央服务器相关联，允许通过网络API在运行时检索参数。在ROS 2中，参数与每个节点相关联，并且可以在运行时通过ROS服务进行配置。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2114">[2114]</a></p>
<ul class="simple">
<li><p>请参阅 <a class="reference external" href="https://design.ros2.org/articles/ros_parameters.html">ROS 2参数设计文档</a> 了解有关系统模型的更多详细信息。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2115">[2115]</a></p></li>
<li><p>请参阅 <a class="reference internal" href="../../Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Parameters/Understanding-ROS2-Parameters.html"><span class="doc">ROS 2 CLI用法</span></a> 以更好地理解CLI工具的工作原理及其与ROS 1工具的区别。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2116">[2116]</a></p></li>
<li><p>请参阅 <a class="reference internal" href="../../How-To-Guides/Parameters-YAML-files-migration-guide.html"><span class="doc">将YAML参数文件从ROS 1迁移到ROS 2 [705]</span></a> 了解在ROS 2中如何解析YAML参数文件以及与ROS实现的区别。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2117">[2117]</a></p></li>
</ul>
</div>
<div class="section" id="launch-files">
<h2>启动文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2118">[2118]</a><a class="headerlink" href="#launch-files" title="永久链接至标题"></a></h2>
<p>在ROS 1中，启动文件始终使用`.xml &lt;<a class="reference external" href="https://wiki.ros.org/roslaunch/XML">https://wiki.ros.org/roslaunch/XML</a>&gt;`__文件指定，而ROS 2则支持使用Python脚本以提供更大的灵活性（请参阅`launch包 &lt;<a class="reference external" href="https://github.com/ros2/launch/tree/humble/launch">https://github.com/ros2/launch/tree/humble/launch</a>&gt;`__），同时还支持XML和YAML文件。请参阅`单独的教程 &lt;../../How-To-Guides/Launch-files-migration-guide&gt;`，了解如何将ROS 1的启动文件迁移到ROS 2。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2119">[2119]</a></p>
</div>
<div class="section" id="example-converting-an-existing-ros-1-package-to-use-ros-2">
<h2>示例：将现有的ROS 1包转换为使用ROS 2 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2120">[2120]</a><a class="headerlink" href="#example-converting-an-existing-ros-1-package-to-use-ros-2" title="永久链接至标题"></a></h2>
<p>假设我们有一个名为``talker``的简单ROS 1包，在一个名为``talker``的节点中使用了``roscpp``。该包位于catkin工作空间中，位置为``~/ros1_talker``。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2121">[2121]</a></p>
<div class="section" id="the-ros-1-code">
<h3>ROS 1代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2122">[2122]</a><a class="headerlink" href="#the-ros-1-code" title="永久链接至标题"></a></h3>
<p>这是我们的catkin工作空间的目录布局： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2123">[2123]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/ros1_talker
$ find .
.
./src
./src/talker
./src/talker/package.xml
./src/talker/CMakeLists.txt
./src/talker/talker.cpp
</pre></div>
</div>
<p>以下是这三个文件的内容： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2124">[2124]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/package.xml</span></code>： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2125">[2125]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;package&gt;</span>
  <span class="nt">&lt;name&gt;</span>talker<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;description&gt;</span>talker<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;maintainer</span> <span class="na">email=</span><span class="s">&quot;gerkey@osrfoundation.org&quot;</span><span class="nt">&gt;</span>Brian Gerkey<span class="nt">&lt;/maintainer&gt;</span>
  <span class="nt">&lt;license&gt;</span>Apache 2.0<span class="nt">&lt;/license&gt;</span>
  <span class="nt">&lt;buildtool_depend&gt;</span>catkin<span class="nt">&lt;/buildtool_depend&gt;</span>
  <span class="nt">&lt;build_depend&gt;</span>roscpp<span class="nt">&lt;/build_depend&gt;</span>
  <span class="nt">&lt;build_depend&gt;</span>std_msgs<span class="nt">&lt;/build_depend&gt;</span>
  <span class="nt">&lt;run_depend&gt;</span>roscpp<span class="nt">&lt;/run_depend&gt;</span>
  <span class="nt">&lt;run_depend&gt;</span>std_msgs<span class="nt">&lt;/run_depend&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/CMakeLists.txt</span></code>： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2126">[2126]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">2.8.3</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">talker</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">catkin</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">roscpp</span><span class="w"> </span><span class="s">std_msgs</span><span class="p">)</span>
<span class="nb">catkin_package</span><span class="p">()</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">catkin_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="s">talker.cpp</span><span class="p">)</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="o">${</span><span class="nv">catkin_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">RUNTIME</span><span class="w"> </span><span class="s">DESTINATION</span><span class="w"> </span><span class="o">${</span><span class="nv">CATKIN_PACKAGE_BIN_DESTINATION</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">src/talker/talker.cpp</span></code>： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2127">[2127]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;ros/ros.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/String.h&quot;</span><span class="cp"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;talker&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">Publisher</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">advertise</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">ros</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="n">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;hello world &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">ROS_INFO</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="n">chatter_pub</span><span class="p">.</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">ros</span><span class="o">::</span><span class="n">spinOnce</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">loop_rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<div class="section" id="building-the-ros-1-code">
<h4>构建 ROS 1 代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2128">[2128]</a><a class="headerlink" href="#building-the-ros-1-code" title="永久链接至标题"></a></h4>
<p>我们先执行一个环境设置文件（在这个例子中是使用 bash 设置 Jade），然后使用 <code class="docutils literal notranslate"><span class="pre">catkin_make</span> <span class="pre">install</span></code> 来构建我们的包： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2129">[2129]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. /opt/ros/jade/setup.bash
<span class="nb">cd</span> ~/ros1_talker
catkin_make install
</pre></div>
</div>
</div>
<div class="section" id="running-the-ros-1-node">
<h4>运行 ROS 1 节点 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2130">[2130]</a><a class="headerlink" href="#running-the-ros-1-node" title="永久链接至标题"></a></h4>
<p>如果还没有一个在运行，我们首先启动 <code class="docutils literal notranslate"><span class="pre">roscore</span></code>，并从我们的 <code class="docutils literal notranslate"><span class="pre">catkin</span></code> 安装目录中获取设置文件（这里也可以使用系统设置文件 <code class="docutils literal notranslate"><span class="pre">/opt/ros/jade/setup.bash</span></code>）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2131">[2131]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. ~/ros1_talker/install/setup.bash
roscore
</pre></div>
</div>
<p>在另一个终端中，我们使用 <code class="docutils literal notranslate"><span class="pre">rosrun</span></code> 从 <code class="docutils literal notranslate"><span class="pre">catkin</span></code> 安装空间运行节点，再次首先获取设置文件（在这种情况下，必须是我们工作空间中的设置文件）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2132">[2132]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. ~/ros1_talker/install/setup.bash
rosrun talker talker
</pre></div>
</div>
</div>
</div>
<div class="section" id="migrating-to-ros-2">
<h3>迁移到ROS 2 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2133">[2133]</a><a class="headerlink" href="#migrating-to-ros-2" title="永久链接至标题"></a></h3>
<p>我们首先创建一个新的工作空间来进行工作： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2134">[2134]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir ~/ros2_talker
<span class="nb">cd</span> ~/ros2_talker
</pre></div>
</div>
<p>我们将从我们的ROS 1软件包中复制源代码树到该工作空间中，在那里我们可以进行修改: <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2135">[2135]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir src
cp -a ~/ros1_talker/src/talker src
</pre></div>
</div>
<p>现在我们将修改节点中的C++代码。ROS 2的C++库名为``rclcpp``，其提供的API与``roscpp``提供的API不同。这两个库之间的概念非常相似，这使得修改相对来说相当简单。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2136">[2136]</a></p>
<div class="section" id="included-headers">
<h4>包含的头文件 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2137">[2137]</a><a class="headerlink" href="#included-headers" title="永久链接至标题"></a></h4>
<p>我们需要包含``rclcpp/rclcpp.hpp``来替代``ros/ros.h``，后者提供了对``roscpp``库API的访问权限，而前者则提供了对``rclcpp``库API的访问权限： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2138">[2138]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//#include &quot;ros/ros.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p>要获取``std_msgs/String``消息定义，我们需要包含``std_msgs/msg/string.hpp``，而不是``std_msgs/String.h``： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2139">[2139]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//#include &quot;std_msgs/String.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="section" id="changing-c-library-calls">
<h4>更改C++库调用 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2140">[2140]</a><a class="headerlink" href="#changing-c-library-calls" title="永久链接至标题"></a></h4>
<p>不再将节点名称传递给库初始化调用，我们现在进行初始化，然后将节点名称传递给节点对象的创建（我们可以使用``auto``关键字，因为现在我们要求使用C++14编译器）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2141">[2141]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  ros::init(argc, argv, &quot;talker&quot;);</span>
<span class="c1">//  ros::NodeHandle n;</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;talker&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>发布者和速率对象的创建看起来非常相似，只是命名空间和方法的名称有一些变化。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2142">[2142]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  ros::Publisher chatter_pub = n.advertise&lt;std_msgs::String&gt;(&quot;chatter&quot;, 1000);</span>
<span class="c1">//  ros::Rate loop_rate(10);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="nf">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>为了进一步控制消息传递的处理方式，可以传递一个质量服务（<code class="docutils literal notranslate"><span class="pre">QoS</span></code>）配置文件。默认配置文件是 <code class="docutils literal notranslate"><span class="pre">rmw_qos_profile_default</span></code>。更多详情，请参阅 <a class="reference external" href="https://design.ros2.org/articles/qos.html">设计文档</a> 和 <a class="reference internal" href="../../Concepts/About-Quality-of-Service-Settings.html"><span class="doc">概念概述</span></a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2143">[2143]</a></p>
<p>在命名空间中，对传出消息的创建方式有所不同： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2144">[2144]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  std_msgs::String msg;</span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>我们用 <code class="docutils literal notranslate"><span class="pre">rclcpp::ok()</span></code> 替代了 <code class="docutils literal notranslate"><span class="pre">ros::ok()</span></code>： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2145">[2145]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//  while (ros::ok())</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span><span class="w"></span>
</pre></div>
</div>
<p>在发布循环中，我们仍然像之前一样访问 <code class="docutils literal notranslate"><span class="pre">data</span></code> 字段： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2146">[2146]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>要打印控制台消息，不再使用``ROS_INFO()``，而是使用``RCLCPP_INFO()``及其各种相关函数。关键区别在于``RCLCPP_INFO()``将Logger对象作为第一个参数。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2147">[2147]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//    ROS_INFO(&quot;%s&quot;, msg.data.c_str());</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span><span class="w"></span>
</pre></div>
</div>
<p>发布消息的方式与之前相同： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2148">[2148]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">chatter_pub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>循环（即让通信系统处理任何待处理的传入/传出消息）的方式不同，调用现在将节点作为参数： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2149">[2149]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">//    ros::spinOnce();</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_some</span><span class="p">(</span><span class="n">node</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>使用rate对象进行休眠的方式保持不变。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2150">[2150]</a></p>
<p>将所有内容组合在一起，新的 <code class="xref any docutils literal notranslate"><span class="pre">talker.cpp</span></code> 如下所示： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2151">[2151]</a></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="c1">// #include &quot;ros/ros.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;rclcpp/rclcpp.hpp&quot;</span><span class="cp"></span>
<span class="c1">// #include &quot;std_msgs/String.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;std_msgs/msg/string.hpp&quot;</span><span class="cp"></span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="c1">//  ros::init(argc, argv, &quot;talker&quot;);</span>
<span class="c1">//  ros::NodeHandle n;</span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Node</span><span class="o">::</span><span class="n">make_shared</span><span class="p">(</span><span class="s">&quot;talker&quot;</span><span class="p">);</span><span class="w"></span>
<span class="c1">//  ros::Publisher chatter_pub = n.advertise&lt;std_msgs::String&gt;(&quot;chatter&quot;, 1000);</span>
<span class="c1">//  ros::Rate loop_rate(10);</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">chatter_pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node</span><span class="o">-&gt;</span><span class="n">create_publisher</span><span class="o">&lt;</span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;chatter&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">Rate</span><span class="w"> </span><span class="n">loop_rate</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="c1">//  std_msgs::String msg;</span>
<span class="w">  </span><span class="n">std_msgs</span><span class="o">::</span><span class="n">msg</span><span class="o">::</span><span class="n">String</span><span class="w"> </span><span class="n">msg</span><span class="p">;</span><span class="w"></span>
<span class="c1">//  while (ros::ok())</span>
<span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">rclcpp</span><span class="o">::</span><span class="n">ok</span><span class="p">())</span><span class="w"></span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">stringstream</span><span class="w"> </span><span class="n">ss</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">ss</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;hello world &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">count</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ss</span><span class="p">.</span><span class="n">str</span><span class="p">();</span><span class="w"></span>
<span class="c1">//    ROS_INFO(&quot;%s&quot;, msg.data.c_str());</span>
<span class="w">    </span><span class="n">RCLCPP_INFO</span><span class="p">(</span><span class="n">node</span><span class="o">-&gt;</span><span class="n">get_logger</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">c_str</span><span class="p">());</span><span class="w"></span>
<span class="w">    </span><span class="n">chatter_pub</span><span class="o">-&gt;</span><span class="n">publish</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span><span class="w"></span>
<span class="c1">//    ros::spinOnce();</span>
<span class="w">    </span><span class="n">rclcpp</span><span class="o">::</span><span class="n">spin_some</span><span class="p">(</span><span class="n">node</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">loop_rate</span><span class="p">.</span><span class="n">sleep</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="changing-the-package-xml">
<h4>修改 <a class="reference internal" href="../../Concepts/About-Build-System.html#term-package.xml"><code class="xref any std std-term docutils literal notranslate"><span class="pre">package.xml</span></code></a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2152">[2152]</a><a class="headerlink" href="#changing-the-package-xml" title="永久链接至标题"></a></h4>
<p>ROS 2 不支持包规范的格式1，只支持更新的格式版本（2及更高）。我们首先在 <a class="reference internal" href="../../Glossary.html#term-package"><code class="xref any std std-term docutils literal notranslate"><span class="pre">package</span></code></a> 标签中指定格式版本： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2153">[2153]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- &lt;package&gt; --&gt;</span>
<span class="nt">&lt;package</span> <span class="na">format=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>ROS 2 使用名为 <code class="xref any docutils literal notranslate"><span class="pre">ament_cmake</span></code> 的较新版本 <code class="xref any docutils literal notranslate"><span class="pre">catkin</span></code>，我们在 <code class="xref any docutils literal notranslate"><span class="pre">buildtool_depend</span></code> 标签中进行了指定： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2154">[2154]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt; --&gt;</span>
  <span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
</pre></div>
</div>
<p>在我们的构建依赖项中，我们使用``rclcpp``代替了``roscpp``，它提供了我们使用的C++ API。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2155">[2155]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;build_depend&gt;roscpp&lt;/build_depend&gt; --&gt;</span>
  <span class="nt">&lt;build_depend&gt;</span>rclcpp<span class="nt">&lt;/build_depend&gt;</span>
</pre></div>
</div>
<p>在运行时依赖项中，我们进行了相同的修改，并且还将``run_depend``标签更新为``exec_depend``标签（这是升级到软件包格式版本2的一部分）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2156">[2156]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!--  &lt;run_depend&gt;roscpp&lt;/run_depend&gt; --&gt;</span>
  <span class="nt">&lt;exec_depend&gt;</span>rclcpp<span class="nt">&lt;/exec_depend&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;std_msgs&lt;/run_depend&gt; --&gt;</span>
  <span class="nt">&lt;exec_depend&gt;</span>std_msgs<span class="nt">&lt;/exec_depend&gt;</span>
</pre></div>
</div>
<p>在ROS 1中，我们使用``&lt;depend&gt;``来简化指定编译时和运行时的依赖关系。在ROS 2中，我们可以做同样的事情： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2157">[2157]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>
<span class="nt">&lt;depend&gt;</span>std_msgs<span class="nt">&lt;/depend&gt;</span>
</pre></div>
</div>
<p>我们还需要告诉构建工具我们是哪种类型的软件包，以便它知道如何构建我们。因为我们使用``ament``和CMake，所以我们添加以下行来声明我们的构建类型为``ament_cmake``： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2158">[2158]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;export&gt;</span>
  <span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
<span class="nt">&lt;/export&gt;</span>
</pre></div>
</div>
<p>将所有内容放在一起，我们的``package.xml``现在看起来像这样： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2159">[2159]</a></p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cm">&lt;!-- &lt;package&gt; --&gt;</span>
<span class="nt">&lt;package</span> <span class="na">format=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;name&gt;</span>talker<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.0.0<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;description&gt;</span>talker<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;maintainer</span> <span class="na">email=</span><span class="s">&quot;gerkey@osrfoundation.org&quot;</span><span class="nt">&gt;</span>Brian Gerkey<span class="nt">&lt;/maintainer&gt;</span>
  <span class="nt">&lt;license&gt;</span>Apache License 2.0<span class="nt">&lt;/license&gt;</span>
<span class="cm">&lt;!--  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt; --&gt;</span>
  <span class="nt">&lt;buildtool_depend&gt;</span>ament_cmake<span class="nt">&lt;/buildtool_depend&gt;</span>
<span class="cm">&lt;!--  &lt;build_depend&gt;roscpp&lt;/build_depend&gt; --&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;roscpp&lt;/run_depend&gt; --&gt;</span>
<span class="cm">&lt;!--  &lt;run_depend&gt;std_msgs&lt;/run_depend&gt; --&gt;</span>
  <span class="nt">&lt;depend&gt;</span>rclcpp<span class="nt">&lt;/depend&gt;</span>
  <span class="nt">&lt;depend&gt;</span>std_msgs<span class="nt">&lt;/depend&gt;</span>
  <span class="nt">&lt;export&gt;</span>
    <span class="nt">&lt;build_type&gt;</span>ament_cmake<span class="nt">&lt;/build_type&gt;</span>
  <span class="nt">&lt;/export&gt;</span>
<span class="nt">&lt;/package&gt;</span>
</pre></div>
</div>
<p><strong>TODO: 展示一个更简化的文件版本，只使用``&lt;depend&gt;``标签，这在版本2的包格式中是可用的（也在``catkin``中支持，严格来说与ROS 2无关）。</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2160">[2160]</a></p>
</div>
<div class="section" id="changing-the-cmake-code">
<h4>修改CMake代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2161">[2161]</a><a class="headerlink" href="#changing-the-cmake-code" title="永久链接至标题"></a></h4>
<p>ROS 2依赖于更高版本的CMake： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2162">[2162]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1">#cmake_minimum_required(VERSION 2.8.3)</span>
cmake_minimum_required<span class="o">(</span>VERSION <span class="m">3</span>.5<span class="o">)</span>
</pre></div>
</div>
<p>ROS 2 依赖于 C++14 标准。根据你使用的编译器，对于 C++14 的支持可能默认没有启用。在使用 <code class="docutils literal notranslate"><span class="pre">gcc</span></code> 5.3（Ubuntu Xenial 上使用的版本）时，我们需要显式启用它，可以通过在文件顶部附近添加以下行来实现： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2163">[2163]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
</pre></div>
</div>
<p>在所有平台上工作的首选方式如下： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2164">[2164]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</pre></div>
</div>
<p>使用 <code class="docutils literal notranslate"><span class="pre">catkin</span></code>，我们通过将要构建的包作为 <code class="docutils literal notranslate"><span class="pre">COMPONENTS</span></code> 参数传递给初始查找 <code class="docutils literal notranslate"><span class="pre">catkin</span></code> 本身的命令来指定要构建的包。对于 <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code>，我们逐个查找每个包，从 <code class="docutils literal notranslate"><span class="pre">ament_cmake</span></code> 开始： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2165">[2165]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#find_package(catkin REQUIRED COMPONENTS roscpp std_msgs)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">std_msgs</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</pre></div>
</div>
<p>系统依赖项与以前一样可以找到： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2166">[2166]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">find_package</span><span class="p">(</span><span class="s">Boost</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">COMPONENTS</span><span class="w"> </span><span class="s">system</span><span class="w"> </span><span class="s">filesystem</span><span class="w"> </span><span class="s">thread</span><span class="p">)</span>
</pre></div>
</div>
<p>我们使用 <code class="docutils literal notranslate"><span class="pre">catkin_package()</span></code> 来自动生成像 CMake 配置文件这样的东西，以供使用我们包的其他包使用。与构建目标之前的调用相反，现在我们在目标之后调用类似的 <code class="docutils literal notranslate"><span class="pre">ament_package()</span></code>： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2167">[2167]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c"># catkin_package()</span>
<span class="c"># At the bottom of the file:</span>
<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p>唯一需要手动包含的目录是本地目录和不是 ament 包的依赖项： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2168">[2168]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#include_directories(${catkin_INCLUDE_DIRS})</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="s">include</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>更好的选择是为每个目标单独指定包含目录，而不是为所有目标包含所有目录： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2169">[2169]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_include_directories</span><span class="p">(</span><span class="s">target</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">include</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>类似于我们单独找到每个依赖包的方式，我们需要将每个依赖包链接到构建目标上。对于 ament 包作为依赖包的链接，不使用 <code class="docutils literal notranslate"><span class="pre">target_link_libraries()</span></code>，而是使用 <code class="docutils literal notranslate"><span class="pre">ament_target_dependencies()</span></code> 是处理构建标志更简洁和更彻底的方式。它自动处理 <code class="docutils literal notranslate"><span class="pre">_INCLUDE_DIRS</span></code> 中定义的包含目录和 <code class="docutils literal notranslate"><span class="pre">_LIBRARIES</span></code> 中定义的链接库。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2170">[2170]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#target_link_libraries(talker ${catkin_LIBRARIES})</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">talker</span>
<span class="w">  </span><span class="s">rclcpp</span>
<span class="w">  </span><span class="s">std_msgs</span><span class="p">)</span>
</pre></div>
</div>
<p>要与非ament软件包（例如系统依赖项，如“Boost”或在同一个“CMakeLists.txt”中构建的库）进行链接，请使用“target_link_libraries()”： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2171">[2171]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">target</span><span class="w"> </span><span class="o">${</span><span class="nv">Boost_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>对于安装，“catkin”定义了变量，如“CATKIN_PACKAGE_BIN_DESTINATION”。而在“ament_cmake”中，我们只需要提供相对于安装根目录的路径，例如可执行文件的路径为“bin”： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2172">[2172]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#install(TARGETS talker</span>
<span class="c">#  RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION})</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</div>
<p>可选地，我们可以安装并导出包含的目录给下游软件包： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2173">[2173]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">install</span><span class="p">(</span><span class="s">DIRECTORY</span><span class="w"> </span><span class="s">include/</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
</pre></div>
</div>
<p>可选地，我们可以为下游软件包导出依赖项： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2174">[2174]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">ament_export_dependencies</span><span class="p">(</span><span class="s">std_msgs</span><span class="p">)</span>
</pre></div>
</div>
<p>将所有内容放在一起，新的 <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> 如下所示： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2175">[2175]</a></p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="c">#cmake_minimum_required(VERSION 2.8.3)</span>
<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.5</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">talker</span><span class="p">)</span>
<span class="nb">if</span><span class="p">(</span><span class="s">NOT</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="p">)</span>
<span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">14</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="nb">if</span><span class="p">(</span><span class="s">CMAKE_COMPILER_IS_GNUCXX</span><span class="w"> </span><span class="s">OR</span><span class="w"> </span><span class="s">CMAKE_CXX_COMPILER_ID</span><span class="w"> </span><span class="s">MATCHES</span><span class="w"> </span><span class="s2">&quot;Clang&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wall</span><span class="w"> </span><span class="s">-Wextra</span><span class="w"> </span><span class="s">-Wpedantic</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
<span class="c">#find_package(catkin REQUIRED COMPONENTS roscpp std_msgs)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">ament_cmake</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">rclcpp</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">std_msgs</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
<span class="c">#catkin_package()</span>
<span class="c">#include_directories(${catkin_INCLUDE_DIRS})</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
<span class="nb">add_executable</span><span class="p">(</span><span class="s">talker</span><span class="w"> </span><span class="s">talker.cpp</span><span class="p">)</span>
<span class="c">#target_link_libraries(talker ${catkin_LIBRARIES})</span>
<span class="nb">ament_target_dependencies</span><span class="p">(</span><span class="s">talker</span>
<span class="w">  </span><span class="s">rclcpp</span>
<span class="w">  </span><span class="s">std_msgs</span><span class="p">)</span>
<span class="c">#install(TARGETS talker</span>
<span class="c">#  RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION})</span>
<span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="s">talker</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib/</span><span class="o">${</span><span class="nv">PROJECT_NAME</span><span class="o">}</span><span class="p">)</span>
<span class="nb">install</span><span class="p">(</span><span class="s">DIRECTORY</span><span class="w"> </span><span class="s">include/</span>
<span class="w">  </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_include_directories</span><span class="p">(</span><span class="s">include</span><span class="p">)</span>
<span class="nb">ament_export_dependencies</span><span class="p">(</span><span class="s">std_msgs</span><span class="p">)</span>
<span class="nb">ament_package</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>TODO: 展示使用 ``ament_auto`` 的效果。</strong> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2176">[2176]</a></p>
</div>
<div class="section" id="building-the-ros-2-code">
<h4>构建 ROS 2 代码 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2177">[2177]</a><a class="headerlink" href="#building-the-ros-2-code" title="永久链接至标题"></a></h4>
<p>我们先引用一个环境设置文件（在这个例子中，我们按照 ROS 2 安装教程生成了一个位于 <code class="docutils literal notranslate"><span class="pre">~/ros2_ws</span></code> 的文件），然后使用 <code class="docutils literal notranslate"><span class="pre">colcon</span> <span class="pre">build</span></code> 构建我们的软件包： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2178">[2178]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. ~/ros2_ws/install/setup.bash
<span class="nb">cd</span> ~/ros2_talker
colcon build
</pre></div>
</div>
</div>
<div class="section" id="running-the-ros-2-node">
<h4>运行ROS 2节点 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2179">[2179]</a><a class="headerlink" href="#running-the-ros-2-node" title="永久链接至标题"></a></h4>
<p>由于我们将“talker”可执行文件安装到“bin”目录中，在我们安装树中的设置文件生效后，我们可以直接使用名称调用它（另外，目前还没有ROS 2等效的“rosrun”）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2180">[2180]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>. ~/ros2_ws/install/setup.bash
talker
</pre></div>
</div>
</div>
</div>
<div class="section" id="update-scripts">
<h3>更新脚本 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2181">[2181]</a><a class="headerlink" href="#update-scripts" title="永久链接至标题"></a></h3>
<div class="section" id="ros-cli-arguments">
<h4>ROS CLI参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2182">[2182]</a><a class="headerlink" href="#ros-cli-arguments" title="永久链接至标题"></a></h4>
<p>自从 <a class="reference internal" href="../../Releases/Release-Eloquent-Elusor.html"><span class="doc">ROS Eloquent</span></a> 版本开始，ROS参数应使用 <code class="docutils literal notranslate"><span class="pre">--ros-args</span></code> 和尾随的 <code class="docutils literal notranslate"><span class="pre">--</span></code> 进行范围限定（如果后面没有参数，尾随的双破折号可以省略）。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2183">[2183]</a></p>
<p>重新映射名称与ROS 1类似，采用 <code class="docutils literal notranslate"><span class="pre">from:=to</span></code> 的形式，但必须在之前加上 <code class="docutils literal notranslate"><span class="pre">--remap``（或</span> <span class="pre">``-r</span></code>）标志。例如： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2184">[2184]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run some_package some_ros_executable --ros-args -r foo:<span class="o">=</span>bar
</pre></div>
</div>
<p>我们对参数使用类似的语法，使用 <code class="docutils literal notranslate"><span class="pre">--param``（或</span> <span class="pre">``-p</span></code>）标志： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2185">[2185]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run some_package some_ros_executable --ros-args -p my_param:<span class="o">=</span>value
</pre></div>
</div>
<p>注意，这与在ROS 1中使用前导下划线是不同的。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2186">[2186]</a></p>
<p>要更改节点名称，请使用``__node``（ROS 1的等效项为``__name``）： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2187">[2187]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run some_package some_ros_executable --ros-args -r __node:<span class="o">=</span>new_node_name
</pre></div>
</div>
<p>请注意使用``-r``标志。更改命名空间``__ns``也需要相同的重映射标志： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2188">[2188]</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2 run some_package some_ros_executable --ros-args -r __ns:<span class="o">=</span>/new/namespace
</pre></div>
</div>
<p>在ROS 2中没有以下ROS 1键的等效项： <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2189">[2189]</a></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__log``（但可以使用</span></code>--log-config-file``来提供日志记录器配置文件） <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2190">[2190]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__ip</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2191">[2191]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__hostname</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2192">[2192]</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__master</span></code> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2193">[2193]</a></p></li>
</ul>
<p>了解更多信息，请参阅 <a class="reference external" href="https://design.ros2.org/articles/ros_command_line_arguments.html">设计文档</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2194">[2194]</a></p>
<div class="section" id="quick-reference">
<h5>快速参考 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2195">[2195]</a><a class="headerlink" href="#quick-reference" title="永久链接至标题"></a></h5>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 32%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>特性 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2196">[2196]</a></p></th>
<th class="head"><p>ROS 1 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2197">[2197]</a></p></th>
<th class="head"><p>ROS 2 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2198">[2198]</a></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>重新映射 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2199">[2199]</a></p></td>
<td><p>foo := bar <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2200">[2200]</a></p></td>
<td><p>-r foo := bar <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2201">[2201]</a></p></td>
</tr>
<tr class="row-odd"><td><p>参数 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2202">[2202]</a></p></td>
<td><p>_foo := bar <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2203">[2203]</a></p></td>
<td><p>-p foo := bar <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2204">[2204]</a></p></td>
</tr>
<tr class="row-even"><td><p>节点名称 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2205">[2205]</a></p></td>
<td><p>__name := foo <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2206">[2206]</a></p></td>
<td><p>-r __node:=foo <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2207">[2207]</a></p></td>
</tr>
<tr class="row-odd"><td><p>namespace <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2208">[2208]</a></p></td>
<td><p>__ns:=foo <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2209">[2209]</a></p></td>
<td><p>-r __ns:=foo <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2210">[2210]</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="more-examples-and-tools">
<h3>更多示例和工具 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2211">[2211]</a><a class="headerlink" href="#more-examples-and-tools" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p>启动文件迁移器，用于将ROS 1的XML启动文件转换为ROS 2的Python启动文件：<a class="reference external" href="https://github.com/aws-robotics/ros2-launch-file-migrator">https://github.com/aws-robotics/ros2-launch-file-migrator</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2212">[2212]</a></p></li>
<li><p>亚马逊已经公开了用于将ROS 1机器人迁移到ROS 2的工具：<a class="reference external" href="https://github.com/awslabs/ros2-migration-tools/tree/master/porting_tools">https://github.com/awslabs/ros2-migration-tools/tree/master/porting_tools</a> <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2213">[2213]</a></p></li>
</ul>
</div>
</div>
<div class="section" id="licensing">
<h2>许可 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2214">[2214]</a><a class="headerlink" href="#licensing" title="永久链接至标题"></a></h2>
<p>在ROS 2中，我们推荐使用 <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>。在ROS 1中，我们推荐使用 <a class="reference external" href="https://opensource.org/licenses/BSD-3-Clause">3-Clause BSD License</a>。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2215">[2215]</a></p>
<p>对于任何新项目，我们建议无论是ROS 1还是ROS 2都使用Apache 2.0 License。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2216">[2216]</a></p>
<p>然而，当将代码从ROS 1迁移到ROS 2时，我们不能简单地更改许可证。必须保留现有许可证以供任何已有贡献使用。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2217">[2217]</a></p>
<p>为此，如果正在迁移某个软件包，我们建议保留现有许可证，并继续在现有的OSI许可证下为该软件包做出贡献，我们预计核心元素的许可证将是BSD许可证。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2218">[2218]</a></p>
<p>这将使事情清晰易懂。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2219">[2219]</a></p>
<div class="section" id="changing-the-license">
<h3>更改许可证 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2220">[2220]</a><a class="headerlink" href="#changing-the-license" title="永久链接至标题"></a></h3>
<p>更改许可证是可能的，但您需要联系所有贡献者并获得许可。对于大多数软件包来说，这可能是一个很大的工作量，并且不值得考虑。如果软件包只有一小部分贡献者，那么这可能是可行的。 <a class="reference external" href="http://fishros.org/page/calib/#/home?apihost=http://fishros.org:2023/ros2/calib&amp;msgid=2221">[2221]</a></p>
</div>
</div>
</div>

  <div id="footer">
    <p>欢迎帮助改进！</p>
  </div>
</body>
</html>